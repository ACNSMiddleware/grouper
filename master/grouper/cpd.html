<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.4 at 2014-07-22 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Grouper API - CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20140722" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                Grouper API
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                    
                <div class="xleft">
        <span id="publishDate">Last Published: 2014-07-22</span>
                  &nbsp;| <span id="projectVersion">Version: 2.2.0</span>
                      </div>
            <div class="xright">                    <a href="./" title="Grouper API">Grouper API</a>
              
                    
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                    
                                <h5>Parent Project</h5>
                  <ul>
                  <li class="none">
                          <a href="../grouper-parent/index.html" title="Grouper">Grouper</a>
            </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                              <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                                                <li class="expanded">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                    <ul>
                      <li class="none">
                          <a href="apidocs/index.html" title="JavaDocs">JavaDocs</a>
            </li>
                      <li class="none">
                          <a href="testapidocs/index.html" title="Test JavaDocs">Test JavaDocs</a>
            </li>
                      <li class="none">
                          <a href="xref-test/index.html" title="Test Source Xref">Test Source Xref</a>
            </li>
                      <li class="none">
                          <a href="xref/index.html" title="Source Xref">Source Xref</a>
            </li>
                      <li class="none">
                          <a href="pmd.html" title="PMD">PMD</a>
            </li>
                      <li class="none">
            <strong>CPD</strong>
          </li>
                      <li class="none">
                          <a href="dependency-updates-report.html" title="Dependency Updates Report">Dependency Updates Report</a>
            </li>
                      <li class="none">
                          <a href="plugin-updates-report.html" title="Plugin Updates Report">Plugin Updates Report</a>
            </li>
                      <li class="none">
                          <a href="property-updates-report.html" title="Property Updates Report">Property Updates Report</a>
            </li>
                      <li class="none">
                          <a href="taglist.html" title="Tag List">Tag List</a>
            </li>
              </ul>
        </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
                    
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section">
<h2>CPD Results<a name="CPD_Results"></a></h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="http://pmd.sourceforge.net/cpd.html">CPD</a> 5.0.5.</p></div>
<div class="section">
<h2>Duplications<a name="Duplications"></a></h2>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L7751">7751</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L3532">3532</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * null safe string compare
   * @param first
   * @param second
   * @return true if equal
   */
  public static boolean equals(String first, String second) {
    if (first == second) {
      return true;
    }
    if (first == null || second == null) {
      return false;
    }
    return first.equals(second);
  }

  /**
   * &lt;p&gt;Checks if a String is whitespace, empty (&quot;&quot;) or null.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * isBlank(null)      = true
   * isBlank(&quot;&quot;)        = true
   * isBlank(&quot; &quot;)       = true
   * isBlank(&quot;bob&quot;)     = false
   * isBlank(&quot;  bob  &quot;) = false
   * &lt;/pre&gt;
   *
   * @param str  the String to check, may be null
   * @return &lt;code&gt;true&lt;/code&gt; if the String is null, empty or whitespace
   * @since 2.0
   */
  public static boolean isBlank(String str) {
    int strLen;
    if (str == null || (strLen = str.length()) == 0) {
      return true;
    }
    for (int i = 0; i &lt; strLen; i++) {
      if ((Character.isWhitespace(str.charAt(i)) == false)) {
        return false;
      }
    }
    return true;
  }

  /**
   *
   * @param str
   * @return true if not blank
   */
  public static boolean isNotBlank(String str) {
    return !isBlank(str);
  }

  /**
   * trim whitespace from string
   * @param str
   * @return trimmed string
   */
  public static String trim(String str) {
    return str == null ? null : str.trim();
  }

  /**
   * equalsignorecase
   * @param str1
   * @param str2
   * @return true if the strings are equal ignore case
   */
  public static boolean equalsIgnoreCase(String str1, String str2) {
    return str1 == null ? str2 == null : str1.equalsIgnoreCase(str2);
  }

  /**
   * trim to empty, convert null to empty
   * @param str
   * @return trimmed
   */
  public static String trimToEmpty(String str) {
    return str == null ? &quot;&quot; : str.trim();
  }

  /**
   * &lt;p&gt;Abbreviates a String using ellipses. This will turn
   * &quot;Now is the time for all good men&quot; into &quot;Now is the time for...&quot;&lt;/p&gt;
   *
   * &lt;p&gt;Specifically:
   * &lt;ul&gt;
   *   &lt;li&gt;If &lt;code&gt;str&lt;/code&gt; is less than &lt;code&gt;maxWidth&lt;/code&gt; characters
   *       long, return it.&lt;/li&gt;
   *   &lt;li&gt;Else abbreviate it to &lt;code&gt;(substring(str, 0, max-3) + &quot;...&quot;)&lt;/code&gt;.&lt;/li&gt;
   *   &lt;li&gt;If &lt;code&gt;maxWidth&lt;/code&gt; is less than &lt;code&gt;4&lt;/code&gt;, throw an
   *       &lt;code&gt;IllegalArgumentException&lt;/code&gt;.&lt;/li&gt;
   *   &lt;li&gt;In no case will it return a String of length greater than
   *       &lt;code&gt;maxWidth&lt;/code&gt;.&lt;/li&gt;
   * &lt;/ul&gt;
   * &lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.abbreviate(null, *)      = null
   * StringUtils.abbreviate(&quot;&quot;, 4)        = &quot;&quot;
   * StringUtils.abbreviate(&quot;abcdefg&quot;, 6) = &quot;abc...&quot;
   * StringUtils.abbreviate(&quot;abcdefg&quot;, 7) = &quot;abcdefg&quot;
   * StringUtils.abbreviate(&quot;abcdefg&quot;, 8) = &quot;abcdefg&quot;
   * StringUtils.abbreviate(&quot;abcdefg&quot;, 4) = &quot;a...&quot;
   * StringUtils.abbreviate(&quot;abcdefg&quot;, 3) = IllegalArgumentException
   * &lt;/pre&gt;
   *
   * @param str  the String to check, may be null
   * @param maxWidth  maximum length of result String, must be at least 4
   * @return abbreviated String, &lt;code&gt;null&lt;/code&gt; if null String input
   * @throws IllegalArgumentException if the width is too small
   * @since 2.0
   */
  public static String abbreviate(String str, int maxWidth) {
    return abbreviate(str, 0, maxWidth);
  }

  /**
   * &lt;p&gt;Abbreviates a String using ellipses. This will turn
   * &quot;Now is the time for all good men&quot; into &quot;...is the time for...&quot;&lt;/p&gt;
   *
   * &lt;p&gt;Works like &lt;code&gt;abbreviate(String, int)&lt;/code&gt;, but allows you to specify
   * a &quot;left edge&quot; offset.  Note that this left edge is not necessarily going to
   * be the leftmost character in the result, or the first character following the
   * ellipses, but it will appear somewhere in the result.
   *
   * &lt;p&gt;In no case will it return a String of length greater than
   * &lt;code&gt;maxWidth&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.abbreviate(null, *, *)                = null
   * StringUtils.abbreviate(&quot;&quot;, 0, 4)                  = &quot;&quot;
   * StringUtils.abbreviate(&quot;abcdefghijklmno&quot;, -1, 10) = &quot;abcdefg...&quot;
   * StringUtils.abbreviate(&quot;abcdefghijklmno&quot;, 0, 10)  = &quot;abcdefg...&quot;
   * StringUtils.abbreviate(&quot;abcdefghijklmno&quot;, 1, 10)  = &quot;abcdefg...&quot;
   * StringUtils.abbreviate(&quot;abcdefghijklmno&quot;, 4, 10)  = &quot;abcdefg...&quot;
   * StringUtils.abbreviate(&quot;abcdefghijklmno&quot;, 5, 10)  = &quot;...fghi...&quot;
   * StringUtils.abbreviate(&quot;abcdefghijklmno&quot;, 6, 10)  = &quot;...ghij...&quot;
   * StringUtils.abbreviate(&quot;abcdefghijklmno&quot;, 8, 10)  = &quot;...ijklmno&quot;
   * StringUtils.abbreviate(&quot;abcdefghijklmno&quot;, 10, 10) = &quot;...ijklmno&quot;
   * StringUtils.abbreviate(&quot;abcdefghijklmno&quot;, 12, 10) = &quot;...ijklmno&quot;
   * StringUtils.abbreviate(&quot;abcdefghij&quot;, 0, 3)        = IllegalArgumentException
   * StringUtils.abbreviate(&quot;abcdefghij&quot;, 5, 6)        = IllegalArgumentException
   * &lt;/pre&gt;
   *
   * @param str  the String to check, may be null
   * @param offset  left edge of source String
   * @param maxWidth  maximum length of result String, must be at least 4
   * @return abbreviated String, &lt;code&gt;null&lt;/code&gt; if null String input
   * @throws IllegalArgumentException if the width is too small
   * @since 2.0
   */
  public static String abbreviate(String str, int offset, int maxWidth) {
    if (str == null) {
      return null;
    }
    if (maxWidth &lt; 4) {
      throw new IllegalArgumentException(&quot;Minimum abbreviation width is 4&quot;);
    }
    if (str.length() &lt;= maxWidth) {
      return str;
    }
    if (offset &gt; str.length()) {
      offset = str.length();
    }
    if ((str.length() - offset) &lt; (maxWidth - 3)) {
      offset = str.length() - (maxWidth - 3);
    }
    if (offset &lt;= 4) {
      return str.substring(0, maxWidth - 3) + &quot;...&quot;;
    }
    if (maxWidth &lt; 7) {
      throw new IllegalArgumentException(&quot;Minimum abbreviation width with offset is 7&quot;);
    }
    if ((offset + (maxWidth - 3)) &lt; str.length()) {
      return &quot;...&quot; + abbreviate(str.substring(offset), maxWidth - 3);
    }
    return &quot;...&quot; + str.substring(str.length() - (maxWidth - 3));
  }

  // Splitting
  //-----------------------------------------------------------------------
  /**
   * &lt;p&gt;Splits the provided text into an array, using whitespace as the
   * separator.
   * Whitespace is defined by {@link Character#isWhitespace(char)}.&lt;/p&gt;
   *
   * &lt;p&gt;The separator is not included in the returned String array.
   * Adjacent separators are treated as one separator.
   * For more control over the split use the StrTokenizer class.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.split(null)       = null
   * StringUtils.split(&quot;&quot;)         = []
   * StringUtils.split(&quot;abc def&quot;)  = [&quot;abc&quot;, &quot;def&quot;]
   * StringUtils.split(&quot;abc  def&quot;) = [&quot;abc&quot;, &quot;def&quot;]
   * StringUtils.split(&quot; abc &quot;)    = [&quot;abc&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be null
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String[] split(String str) {
    return split(str, null, -1);
  }

  /**
   * &lt;p&gt;Splits the provided text into an array, separator specified.
   * This is an alternative to using StringTokenizer.&lt;/p&gt;
   *
   * &lt;p&gt;The separator is not included in the returned String array.
   * Adjacent separators are treated as one separator.
   * For more control over the split use the StrTokenizer class.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.split(null, *)         = null
   * StringUtils.split(&quot;&quot;, *)           = []
   * StringUtils.split(&quot;a.b.c&quot;, '.')    = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
   * StringUtils.split(&quot;a..b.c&quot;, '.')   = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
   * StringUtils.split(&quot;a:b:c&quot;, '.')    = [&quot;a:b:c&quot;]
   * StringUtils.split(&quot;a\tb\nc&quot;, null) = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
   * StringUtils.split(&quot;a b c&quot;, ' ')    = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be null
   * @param separatorChar  the character used as the delimiter,
   *  &lt;code&gt;null&lt;/code&gt; splits on whitespace
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.0
   */
  public static String[] split(String str, char separatorChar) {
    return splitWorker(str, separatorChar, false);
  }

  /**
   * &lt;p&gt;Splits the provided text into an array, separators specified.
   * This is an alternative to using StringTokenizer.&lt;/p&gt;
   *
   * &lt;p&gt;The separator is not included in the returned String array.
   * Adjacent separators are treated as one separator.
   * For more control over the split use the StrTokenizer class.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.
   * A &lt;code&gt;null&lt;/code&gt; separatorChars splits on whitespace.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.split(null, *)         = null
   * StringUtils.split(&quot;&quot;, *)           = []
   * StringUtils.split(&quot;abc def&quot;, null) = [&quot;abc&quot;, &quot;def&quot;]
   * StringUtils.split(&quot;abc def&quot;, &quot; &quot;)  = [&quot;abc&quot;, &quot;def&quot;]
   * StringUtils.split(&quot;abc  def&quot;, &quot; &quot;) = [&quot;abc&quot;, &quot;def&quot;]
   * StringUtils.split(&quot;ab:cd:ef&quot;, &quot;:&quot;) = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be null
   * @param separatorChars  the characters used as the delimiters,
   *  &lt;code&gt;null&lt;/code&gt; splits on whitespace
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String[] split(String str, String separatorChars) {
    return splitWorker(str, separatorChars, -1, false);
  }

  /**
   * &lt;p&gt;Splits the provided text into an array with a maximum length,
   * separators specified.&lt;/p&gt;
   *
   * &lt;p&gt;The separator is not included in the returned String array.
   * Adjacent separators are treated as one separator.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.
   * A &lt;code&gt;null&lt;/code&gt; separatorChars splits on whitespace.&lt;/p&gt;
   *
   * &lt;p&gt;If more than &lt;code&gt;max&lt;/code&gt; delimited substrings are found, the last
   * returned string includes all characters after the first &lt;code&gt;max - 1&lt;/code&gt;
   * returned strings (including separator characters).&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.split(null, *, *)            = null
   * StringUtils.split(&quot;&quot;, *, *)              = []
   * StringUtils.split(&quot;ab de fg&quot;, null, 0)   = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;]
   * StringUtils.split(&quot;ab   de fg&quot;, null, 0) = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;]
   * StringUtils.split(&quot;ab:cd:ef&quot;, &quot;:&quot;, 0)    = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;]
   * StringUtils.split(&quot;ab:cd:ef&quot;, &quot;:&quot;, 2)    = [&quot;ab&quot;, &quot;cd:ef&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be null
   * @param separatorChars  the characters used as the delimiters,
   *  &lt;code&gt;null&lt;/code&gt; splits on whitespace
   * @param max  the maximum number of elements to include in the
   *  array. A zero or negative value implies no limit
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String[] split(String str, String separatorChars, int max) {
    return splitWorker(str, separatorChars, max, false);
  }

  /**
   * &lt;p&gt;Splits the provided text into an array, separator string specified.&lt;/p&gt;
   *
   * &lt;p&gt;The separator(s) will not be included in the returned String array.
   * Adjacent separators are treated as one separator.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.
   * A &lt;code&gt;null&lt;/code&gt; separator splits on whitespace.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.split(null, *)            = null
   * StringUtils.split(&quot;&quot;, *)              = []
   * StringUtils.split(&quot;ab de fg&quot;, null)   = [&quot;ab&quot;, &quot;de&quot;, &quot;fg&quot;]
   * StringUtils.split(&quot;ab   de fg&quot;, null) = [&quot;ab&quot;, &quot;de&quot;, &quot;fg&quot;]
   * StringUtils.split(&quot;ab:cd:ef&quot;, &quot;:&quot;)    = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;]
   * StringUtils.split(&quot;abstemiouslyaeiouyabstemiously&quot;, &quot;aeiouy&quot;)  = [&quot;bst&quot;, &quot;m&quot;, &quot;sl&quot;, &quot;bst&quot;, &quot;m&quot;, &quot;sl&quot;]
   * StringUtils.split(&quot;abstemiouslyaeiouyabstemiously&quot;, &quot;aeiouy&quot;)  = [&quot;abstemiously&quot;, &quot;abstemiously&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be null
   * @param separator  String containing the String to be used as a delimiter,
   *  &lt;code&gt;null&lt;/code&gt; splits on whitespace
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String was input
   */
  public static String[] splitByWholeSeparator(String str, String separator) {
    return splitByWholeSeparator(str, separator, -1);
  }

  /**
   * &lt;p&gt;Splits the provided text into an array, separator string specified.
   * Returns a maximum of &lt;code&gt;max&lt;/code&gt; substrings.&lt;/p&gt;
   *
   * &lt;p&gt;The separator(s) will not be included in the returned String array.
   * Adjacent separators are treated as one separator.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.
   * A &lt;code&gt;null&lt;/code&gt; separator splits on whitespace.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.splitByWholeSeparator(null, *, *)               = null
   * StringUtils.splitByWholeSeparator(&quot;&quot;, *, *)                 = []
   * StringUtils.splitByWholeSeparator(&quot;ab de fg&quot;, null, 0)      = [&quot;ab&quot;, &quot;de&quot;, &quot;fg&quot;]
   * StringUtils.splitByWholeSeparator(&quot;ab   de fg&quot;, null, 0)    = [&quot;ab&quot;, &quot;de&quot;, &quot;fg&quot;]
   * StringUtils.splitByWholeSeparator(&quot;ab:cd:ef&quot;, &quot;:&quot;, 2)       = [&quot;ab&quot;, &quot;cd&quot;]
   * StringUtils.splitByWholeSeparator(&quot;abstemiouslyaeiouyabstemiously&quot;, &quot;aeiouy&quot;, 2) = [&quot;bst&quot;, &quot;m&quot;]
   * StringUtils.splitByWholeSeparator(&quot;abstemiouslyaeiouyabstemiously&quot;, &quot;aeiouy&quot;, 2)  = [&quot;abstemiously&quot;, &quot;abstemiously&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be null
   * @param separator  String containing the String to be used as a delimiter,
   *  &lt;code&gt;null&lt;/code&gt; splits on whitespace
   * @param max  the maximum number of elements to include in the returned
   *  array. A zero or negative value implies no limit.
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String was input
   */
  public static String[] splitByWholeSeparator(String str, String separator, int max) {
    if (str == null) {
      return null;
    }

    int len = str.length();

    if (len == 0) {
      return EMPTY_STRING_ARRAY;
    }

    if ((separator == null) || (&quot;&quot;.equals(separator))) {
      // Split on whitespace.
      return split(str, null, max);
    }

    int separatorLength = separator.length();

    ArrayList substrings = new ArrayList();
    int numberOfSubstrings = 0;
    int beg = 0;
    int end = 0;
    while (end &lt; len) {
      end = str.indexOf(separator, beg);

      if (end &gt; -1) {
        if (end &gt; beg) {
          numberOfSubstrings += 1;

          if (numberOfSubstrings == max) {
            end = len;
            substrings.add(str.substring(beg));
          } else {
            // The following is OK, because String.substring( beg, end ) excludes
            // the character at the position 'end'.
            substrings.add(str.substring(beg, end));

            // Set the starting point for the next search.
            // The following is equivalent to beg = end + (separatorLength - 1) + 1,
            // which is the right calculation:
            beg = end + separatorLength;
          }
        } else {
          // We found a consecutive occurrence of the separator, so skip it.
          beg = end + separatorLength;
        }
      } else {
        // String.substring( beg ) goes from 'beg' to the end of the String.
        substrings.add(str.substring(beg));
        end = len;
      }
    }

    return (String[]) substrings.toArray(new String[substrings.size()]);
  }

  //-----------------------------------------------------------------------
  /**
   * &lt;p&gt;Splits the provided text into an array, using whitespace as the
   * separator, preserving all tokens, including empty tokens created by
   * adjacent separators. This is an alternative to using StringTokenizer.
   * Whitespace is defined by {@link Character#isWhitespace(char)}.&lt;/p&gt;
   *
   * &lt;p&gt;The separator is not included in the returned String array.
   * Adjacent separators are treated as separators for empty tokens.
   * For more control over the split use the StrTokenizer class.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.splitPreserveAllTokens(null)       = null
   * StringUtils.splitPreserveAllTokens(&quot;&quot;)         = []
   * StringUtils.splitPreserveAllTokens(&quot;abc def&quot;)  = [&quot;abc&quot;, &quot;def&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;abc  def&quot;) = [&quot;abc&quot;, &quot;&quot;, &quot;def&quot;]
   * StringUtils.splitPreserveAllTokens(&quot; abc &quot;)    = [&quot;&quot;, &quot;abc&quot;, &quot;&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be &lt;code&gt;null&lt;/code&gt;
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.1
   */
  public static String[] splitPreserveAllTokens(String str) {
    return splitWorker(str, null, -1, true);
  }

  /**
   * &lt;p&gt;Splits the provided text into an array, separator specified,
   * preserving all tokens, including empty tokens created by adjacent
   * separators. This is an alternative to using StringTokenizer.&lt;/p&gt;
   *
   * &lt;p&gt;The separator is not included in the returned String array.
   * Adjacent separators are treated as separators for empty tokens.
   * For more control over the split use the StrTokenizer class.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.splitPreserveAllTokens(null, *)         = null
   * StringUtils.splitPreserveAllTokens(&quot;&quot;, *)           = []
   * StringUtils.splitPreserveAllTokens(&quot;a.b.c&quot;, '.')    = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;a..b.c&quot;, '.')   = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;a:b:c&quot;, '.')    = [&quot;a:b:c&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;a\tb\nc&quot;, null) = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;a b c&quot;, ' ')    = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;a b c &quot;, ' ')   = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;a b c &quot;, ' ')   = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;&quot;, &quot;&quot;]
   * StringUtils.splitPreserveAllTokens(&quot; a b c&quot;, ' ')   = [&quot;&quot;, a&quot;, &quot;b&quot;, &quot;c&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;  a b c&quot;, ' ')  = [&quot;&quot;, &quot;&quot;, a&quot;, &quot;b&quot;, &quot;c&quot;]
   * StringUtils.splitPreserveAllTokens(&quot; a b c &quot;, ' ')  = [&quot;&quot;, a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be &lt;code&gt;null&lt;/code&gt;
   * @param separatorChar  the character used as the delimiter,
   *  &lt;code&gt;null&lt;/code&gt; splits on whitespace
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.1
   */
  public static String[] splitPreserveAllTokens(String str, char separatorChar) {
    return splitWorker(str, separatorChar, true);
  }

  /**
   * Performs the logic for the &lt;code&gt;split&lt;/code&gt; and
   * &lt;code&gt;splitPreserveAllTokens&lt;/code&gt; methods that do not return a
   * maximum array length.
   *
   * @param str  the String to parse, may be &lt;code&gt;null&lt;/code&gt;
   * @param separatorChar the separate character
   * @param preserveAllTokens if &lt;code&gt;true&lt;/code&gt;, adjacent separators are
   * treated as empty token separators; if &lt;code&gt;false&lt;/code&gt;, adjacent
   * separators are treated as one separator.
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   */
  private static String[] splitWorker(String str, char separatorChar,
      boolean preserveAllTokens) {
    // Performance tuned for 2.0 (JDK1.4)

    if (str == null) {
      return null;
    }
    int len = str.length();
    if (len == 0) {
      return EMPTY_STRING_ARRAY;
    }
    List list = new ArrayList();
    int i = 0, start = 0;
    boolean match = false;
    boolean lastMatch = false;
    while (i &lt; len) {
      if (str.charAt(i) == separatorChar) {
        if (match || preserveAllTokens) {
          list.add(str.substring(start, i));
          match = false;
          lastMatch = true;
        }
        start = ++i;
        continue;
      }
      lastMatch = false;
      match = true;
      i++;
    }
    if (match || (preserveAllTokens &amp;&amp; lastMatch)) {
      list.add(str.substring(start, i));
    }
    return (String[]) list.toArray(new String[list.size()]);
  }

  /**
   * &lt;p&gt;Splits the provided text into an array, separators specified,
   * preserving all tokens, including empty tokens created by adjacent
   * separators. This is an alternative to using StringTokenizer.&lt;/p&gt;
   *
   * &lt;p&gt;The separator is not included in the returned String array.
   * Adjacent separators are treated as separators for empty tokens.
   * For more control over the split use the StrTokenizer class.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.
   * A &lt;code&gt;null&lt;/code&gt; separatorChars splits on whitespace.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.splitPreserveAllTokens(null, *)           = null
   * StringUtils.splitPreserveAllTokens(&quot;&quot;, *)             = []
   * StringUtils.splitPreserveAllTokens(&quot;abc def&quot;, null)   = [&quot;abc&quot;, &quot;def&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;abc def&quot;, &quot; &quot;)    = [&quot;abc&quot;, &quot;def&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;abc  def&quot;, &quot; &quot;)   = [&quot;abc&quot;, &quot;&quot;, def&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab:cd:ef&quot;, &quot;:&quot;)   = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab:cd:ef:&quot;, &quot;:&quot;)  = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;, &quot;&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab:cd:ef::&quot;, &quot;:&quot;) = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;, &quot;&quot;, &quot;&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab::cd:ef&quot;, &quot;:&quot;)  = [&quot;ab&quot;, &quot;&quot;, cd&quot;, &quot;ef&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;:cd:ef&quot;, &quot;:&quot;)     = [&quot;&quot;, cd&quot;, &quot;ef&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;::cd:ef&quot;, &quot;:&quot;)    = [&quot;&quot;, &quot;&quot;, cd&quot;, &quot;ef&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;:cd:ef:&quot;, &quot;:&quot;)    = [&quot;&quot;, cd&quot;, &quot;ef&quot;, &quot;&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be &lt;code&gt;null&lt;/code&gt;
   * @param separatorChars  the characters used as the delimiters,
   *  &lt;code&gt;null&lt;/code&gt; splits on whitespace
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.1
   */
  public static String[] splitPreserveAllTokens(String str, String separatorChars) {
    return splitWorker(str, separatorChars, -1, true);
  }

  /**
   * &lt;p&gt;Splits the provided text into an array with a maximum length,
   * separators specified, preserving all tokens, including empty tokens
   * created by adjacent separators.&lt;/p&gt;
   *
   * &lt;p&gt;The separator is not included in the returned String array.
   * Adjacent separators are treated as separators for empty tokens.
   * Adjacent separators are treated as one separator.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.
   * A &lt;code&gt;null&lt;/code&gt; separatorChars splits on whitespace.&lt;/p&gt;
   *
   * &lt;p&gt;If more than &lt;code&gt;max&lt;/code&gt; delimited substrings are found, the last
   * returned string includes all characters after the first &lt;code&gt;max - 1&lt;/code&gt;
   * returned strings (including separator characters).&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.splitPreserveAllTokens(null, *, *)            = null
   * StringUtils.splitPreserveAllTokens(&quot;&quot;, *, *)              = []
   * StringUtils.splitPreserveAllTokens(&quot;ab de fg&quot;, null, 0)   = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab   de fg&quot;, null, 0) = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab:cd:ef&quot;, &quot;:&quot;, 0)    = [&quot;ab&quot;, &quot;cd&quot;, &quot;ef&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab:cd:ef&quot;, &quot;:&quot;, 2)    = [&quot;ab&quot;, &quot;cd:ef&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab   de fg&quot;, null, 2) = [&quot;ab&quot;, &quot;  de fg&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab   de fg&quot;, null, 3) = [&quot;ab&quot;, &quot;&quot;, &quot; de fg&quot;]
   * StringUtils.splitPreserveAllTokens(&quot;ab   de fg&quot;, null, 4) = [&quot;ab&quot;, &quot;&quot;, &quot;&quot;, &quot;de fg&quot;]
   * &lt;/pre&gt;
   *
   * @param str  the String to parse, may be &lt;code&gt;null&lt;/code&gt;
   * @param separatorChars  the characters used as the delimiters,
   *  &lt;code&gt;null&lt;/code&gt; splits on whitespace
   * @param max  the maximum number of elements to include in the
   *  array. A zero or negative value implies no limit
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.1
   */
  public static String[] splitPreserveAllTokens(String str, String separatorChars, int max) {
    return splitWorker(str, separatorChars, max, true);
  }

  /**
   * Performs the logic for the &lt;code&gt;split&lt;/code&gt; and
   * &lt;code&gt;splitPreserveAllTokens&lt;/code&gt; methods that return a maximum array
   * length.
   *
   * @param str  the String to parse, may be &lt;code&gt;null&lt;/code&gt;
   * @param separatorChars the separate character
   * @param max  the maximum number of elements to include in the
   *  array. A zero or negative value implies no limit.
   * @param preserveAllTokens if &lt;code&gt;true&lt;/code&gt;, adjacent separators are
   * treated as empty token separators; if &lt;code&gt;false&lt;/code&gt;, adjacent
   * separators are treated as one separator.
   * @return an array of parsed Strings, &lt;code&gt;null&lt;/code&gt; if null String input
   */
  private static String[] splitWorker(String str, String separatorChars, int max,
      boolean preserveAllTokens) {
    // Performance tuned for 2.0 (JDK1.4)
    // Direct code is quicker than StringTokenizer.
    // Also, StringTokenizer uses isSpace() not isWhitespace()

    if (str == null) {
      return null;
    }
    int len = str.length();
    if (len == 0) {
      return EMPTY_STRING_ARRAY;
    }
    List list = new ArrayList();
    int sizePlus1 = 1;
    int i = 0, start = 0;
    boolean match = false;
    boolean lastMatch = false;
    if (separatorChars == null) {
      // Null separator means use whitespace
      while (i &lt; len) {
        if (Character.isWhitespace(str.charAt(i))) {
          if (match || preserveAllTokens) {
            lastMatch = true;
            if (sizePlus1++ == max) {
              i = len;
              lastMatch = false;
            }
            list.add(str.substring(start, i));
            match = false;
          }
          start = ++i;
          continue;
        }
        lastMatch = false;
        match = true;
        i++;
      }
    } else if (separatorChars.length() == 1) {
      // Optimise 1 character case
      char sep = separatorChars.charAt(0);
      while (i &lt; len) {
        if (str.charAt(i) == sep) {
          if (match || preserveAllTokens) {
            lastMatch = true;
            if (sizePlus1++ == max) {
              i = len;
              lastMatch = false;
            }
            list.add(str.substring(start, i));
            match = false;
          }
          start = ++i;
          continue;
        }
        lastMatch = false;
        match = true;
        i++;
      }
    } else {
      // standard case
      while (i &lt; len) {
        if (separatorChars.indexOf(str.charAt(i)) &gt;= 0) {
          if (match || preserveAllTokens) {
            lastMatch = true;
            if (sizePlus1++ == max) {
              i = len;
              lastMatch = false;
            }
            list.add(str.substring(start, i));
            match = false;
          }
          start = ++i;
          continue;
        }
        lastMatch = false;
        match = true;
        i++;
      }
    }
    if (match || (preserveAllTokens &amp;&amp; lastMatch)) {
      list.add(str.substring(start, i));
    }
    return (String[]) list.toArray(new String[list.size()]);
  }

  /**
   * &lt;p&gt;Joins the elements of the provided array into a single String
   * containing the provided list of elements.&lt;/p&gt;
   *
   * &lt;p&gt;No separator is added to the joined String.
   * Null objects or empty strings within the array are represented by
   * empty strings.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.join(null)            = null
   * StringUtils.join([])              = &quot;&quot;
   * StringUtils.join([null])          = &quot;&quot;
   * StringUtils.join([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]) = &quot;abc&quot;
   * StringUtils.join([null, &quot;&quot;, &quot;a&quot;]) = &quot;a&quot;
   * &lt;/pre&gt;
   *
   * @param array  the array of values to join together, may be null
   * @return the joined String, &lt;code&gt;null&lt;/code&gt; if null array input
   * @since 2.0
   */
  public static String join(Object[] array) {
    return join(array, null);
  }

  /**
   * &lt;p&gt;Joins the elements of the provided array into a single String
   * containing the provided list of elements.&lt;/p&gt;
   *
   * &lt;p&gt;No delimiter is added before or after the list.
   * Null objects or empty strings within the array are represented by
   * empty strings.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.join(null, *)               = null
   * StringUtils.join([], *)                 = &quot;&quot;
   * StringUtils.join([null], *)             = &quot;&quot;
   * StringUtils.join([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], ';')  = &quot;a;b;c&quot;
   * StringUtils.join([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], null) = &quot;abc&quot;
   * StringUtils.join([null, &quot;&quot;, &quot;a&quot;], ';')  = &quot;;;a&quot;
   * &lt;/pre&gt;
   *
   * @param array  the array of values to join together, may be null
   * @param separator  the separator character to use
   * @return the joined String, &lt;code&gt;null&lt;/code&gt; if null array input
   * @since 2.0
   */
  public static String join(Object[] array, char separator) {
    if (array == null) {
      return null;
    }
    int arraySize = array.length;
    int bufSize = (arraySize == 0 ? 0 : ((array[0] == null ? 16 : array[0].toString()
        .length()) + 1)
        * arraySize);
    StringBuffer buf = new StringBuffer(bufSize);

    for (int i = 0; i &lt; arraySize; i++) {
      if (i &gt; 0) {
        buf.append(separator);
      }
      if (array[i] != null) {
        buf.append(array[i]);
      }
    }
    return buf.toString();
  }

  /**
   * &lt;p&gt;Joins the elements of the provided array into a single String
   * containing the provided list of elements.&lt;/p&gt;
   *
   * &lt;p&gt;No delimiter is added before or after the list.
   * A &lt;code&gt;null&lt;/code&gt; separator is the same as an empty String (&quot;&quot;).
   * Null objects or empty strings within the array are represented by
   * empty strings.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.join(null, *)                = null
   * StringUtils.join([], *)                  = &quot;&quot;
   * StringUtils.join([null], *)              = &quot;&quot;
   * StringUtils.join([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], &quot;--&quot;)  = &quot;a--b--c&quot;
   * StringUtils.join([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], null)  = &quot;abc&quot;
   * StringUtils.join([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], &quot;&quot;)    = &quot;abc&quot;
   * StringUtils.join([null, &quot;&quot;, &quot;a&quot;], ',')   = &quot;,,a&quot;
   * &lt;/pre&gt;
   *
   * @param array  the array of values to join together, may be null
   * @param separator  the separator character to use, null treated as &quot;&quot;
   * @return the joined String, &lt;code&gt;null&lt;/code&gt; if null array input
   */
  public static String join(Object[] array, String separator) {
    if (array == null) {
      return null;
    }
    if (separator == null) {
      separator = &quot;&quot;;
    }
    int arraySize = array.length;

    // ArraySize ==  0: Len = 0
    // ArraySize &gt; 0:   Len = NofStrings *(len(firstString) + len(separator))
    //           (Assuming that all Strings are roughly equally long)
    int bufSize = ((arraySize == 0) ? 0 : arraySize
        * ((array[0] == null ? 16 : array[0].toString().length()) + separator.length()));

    StringBuffer buf = new StringBuffer(bufSize);

    for (int i = 0; i &lt; arraySize; i++) {
      if (i &gt; 0) {
        buf.append(separator);
      }
      if (array[i] != null) {
        buf.append(array[i]);
      }
    }
    return buf.toString();
  }

  /**
   * &lt;p&gt;Joins the elements of the provided &lt;code&gt;Iterator&lt;/code&gt; into
   * a single String containing the provided elements.&lt;/p&gt;
   *
   * &lt;p&gt;No delimiter is added before or after the list. Null objects or empty
   * strings within the iteration are represented by empty strings.&lt;/p&gt;
   *
   * &lt;p&gt;See the examples here: {@link #join(Object[],char)}. &lt;/p&gt;
   *
   * @param iterator  the &lt;code&gt;Iterator&lt;/code&gt; of values to join together, may be null
   * @param separator  the separator character to use
   * @return the joined String, &lt;code&gt;null&lt;/code&gt; if null iterator input
   * @since 2.0
   */
  public static String join(Iterator iterator, char separator) {
    if (iterator == null) {
      return null;
    }
    StringBuffer buf = new StringBuffer(256); // Java default is 16, probably too small
    while (iterator.hasNext()) {
      Object obj = iterator.next();
      if (obj != null) {
        buf.append(obj);
      }
      if (iterator.hasNext()) {
        buf.append(separator);
      }
    }
    return buf.toString();
  }

  /**
   * &lt;p&gt;Joins the elements of the provided &lt;code&gt;Iterator&lt;/code&gt; into
   * a single String containing the provided elements.&lt;/p&gt;
   *
   * &lt;p&gt;No delimiter is added before or after the list.
   * A &lt;code&gt;null&lt;/code&gt; separator is the same as an empty String (&quot;&quot;).&lt;/p&gt;
   *
   * &lt;p&gt;See the examples here: {@link #join(Object[],String)}. &lt;/p&gt;
   *
   * @param iterator  the &lt;code&gt;Iterator&lt;/code&gt; of values to join together, may be null
   * @param separator  the separator character to use, null treated as &quot;&quot;
   * @return the joined String, &lt;code&gt;null&lt;/code&gt; if null iterator input
   */
  public static String join(Iterator iterator, String separator) {
    if (iterator == null) {
      return null;
    }
    StringBuffer buf = new StringBuffer(256); // Java default is 16, probably too small
    while (iterator.hasNext()) {
      Object obj = iterator.next();
      if (obj != null) {
        buf.append(obj);
      }
      if ((separator != null) &amp;&amp; iterator.hasNext()) {
        buf.append(separator);
      }
    }
    return buf.toString();
  }

  /**
   * &lt;p&gt;Returns either the passed in String,
   * or if the String is &lt;code&gt;null&lt;/code&gt;, an empty String (&quot;&quot;).&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.defaultString(null)  = &quot;&quot;
   * StringUtils.defaultString(&quot;&quot;)    = &quot;&quot;
   * StringUtils.defaultString(&quot;bat&quot;) = &quot;bat&quot;
   * &lt;/pre&gt;
   *
   * @see String#valueOf(Object)
   * @param str  the String to check, may be null
   * @return the passed in String, or the empty String if it
   *  was &lt;code&gt;null&lt;/code&gt;
   */
  public static String defaultString(String str) {
    return str == null ? &quot;&quot; : str;
  }

  /**
   * &lt;p&gt;Returns either the passed in String, or if the String is
   * &lt;code&gt;null&lt;/code&gt;, the value of &lt;code&gt;defaultStr&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.defaultString(null, &quot;NULL&quot;)  = &quot;NULL&quot;
   * StringUtils.defaultString(&quot;&quot;, &quot;NULL&quot;)    = &quot;&quot;
   * StringUtils.defaultString(&quot;bat&quot;, &quot;NULL&quot;) = &quot;bat&quot;
   * &lt;/pre&gt;
   *
   * @see String#valueOf(Object)
   * @param str  the String to check, may be null
   * @param defaultStr  the default String to return
   *  if the input is &lt;code&gt;null&lt;/code&gt;, may be null
   * @return the passed in String, or the default if it was &lt;code&gt;null&lt;/code&gt;
   */
  public static String defaultString(String str, String defaultStr) {
    return str == null ? defaultStr : str;
  }

  /**
   * &lt;p&gt;Returns either the passed in String, or if the String is
   * empty or &lt;code&gt;null&lt;/code&gt;, the value of &lt;code&gt;defaultStr&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.defaultIfEmpty(null, &quot;NULL&quot;)  = &quot;NULL&quot;
   * StringUtils.defaultIfEmpty(&quot;&quot;, &quot;NULL&quot;)    = &quot;NULL&quot;
   * StringUtils.defaultIfEmpty(&quot;bat&quot;, &quot;NULL&quot;) = &quot;bat&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to check, may be null
   * @param defaultStr  the default String to return
   *  if the input is empty (&quot;&quot;) or &lt;code&gt;null&lt;/code&gt;, may be null
   * @return the passed in String, or the default
   */
  public static String defaultIfEmpty(String str, String defaultStr) {
    return isEmpty(str) ? defaultStr : str;
  }

  /**
   * &lt;p&gt;Capitalizes a String changing the first letter to title case as
   * per {@link Character#toTitleCase(char)}. No other letters are changed.&lt;/p&gt;
   *
   * A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.capitalize(null)  = null
   * StringUtils.capitalize(&quot;&quot;)    = &quot;&quot;
   * StringUtils.capitalize(&quot;cat&quot;) = &quot;Cat&quot;
   * StringUtils.capitalize(&quot;cAt&quot;) = &quot;CAt&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to capitalize, may be null
   * @return the capitalized String, &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.0
   */
  public static String capitalize(String str) {
    int strLen;
    if (str == null || (strLen = str.length()) == 0) {
      return str;
    }
    return new StringBuffer(strLen).append(Character.toTitleCase(str.charAt(0))).append(
        str.substring(1)).toString();
  }

  /**
   * &lt;p&gt;Checks if String contains a search character, handling &lt;code&gt;null&lt;/code&gt;.
   * This method uses {@link String#indexOf(int)}.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; or empty (&quot;&quot;) String will return &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.contains(null, *)    = false
   * StringUtils.contains(&quot;&quot;, *)      = false
   * StringUtils.contains(&quot;abc&quot;, 'a') = true
   * StringUtils.contains(&quot;abc&quot;, 'z') = false
   * &lt;/pre&gt;
   *
   * @param str  the String to check, may be null
   * @param searchChar  the character to find
   * @return true if the String contains the search character,
   *  false if not or &lt;code&gt;null&lt;/code&gt; string input
   * @since 2.0
   */
  public static boolean contains(String str, char searchChar) {
    if (isEmpty(str)) {
      return false;
    }
    return str.indexOf(searchChar) &gt;= 0;
  }

  /**
   * &lt;p&gt;Checks if String contains a search String, handling &lt;code&gt;null&lt;/code&gt;.
   * This method uses {@link String#indexOf(int)}.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; String will return &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.contains(null, *)     = false
   * StringUtils.contains(*, null)     = false
   * StringUtils.contains(&quot;&quot;, &quot;&quot;)      = true
   * StringUtils.contains(&quot;abc&quot;, &quot;&quot;)   = true
   * StringUtils.contains(&quot;abc&quot;, &quot;a&quot;)  = true
   * StringUtils.contains(&quot;abc&quot;, &quot;z&quot;)  = false
   * &lt;/pre&gt;
   *
   * @param str  the String to check, may be null
   * @param searchStr  the String to find, may be null
   * @return true if the String contains the search String,
   *  false if not or &lt;code&gt;null&lt;/code&gt; string input
   * @since 2.0
   */
  public static boolean contains(String str, String searchStr) {
    if (str == null || searchStr == null) {
      return false;
    }
    return str.indexOf(searchStr) &gt;= 0;
  }

  /**
   * An empty immutable &lt;code&gt;String&lt;/code&gt; array.
   */
  public static final String[] EMPTY_STRING_ARRAY = new String[0];

  /**
   * &lt;p&gt;Compares two objects for equality, where either one or both
   * objects may be &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * ObjectUtils.equals(null, null)                  = true
   * ObjectUtils.equals(null, &quot;&quot;)                    = false
   * ObjectUtils.equals(&quot;&quot;, null)                    = false
   * ObjectUtils.equals(&quot;&quot;, &quot;&quot;)                      = true
   * ObjectUtils.equals(Boolean.TRUE, null)          = false
   * ObjectUtils.equals(Boolean.TRUE, &quot;true&quot;)        = false
   * ObjectUtils.equals(Boolean.TRUE, Boolean.TRUE)  = true
   * ObjectUtils.equals(Boolean.TRUE, Boolean.FALSE) = false
   * &lt;/pre&gt;
   *
   * @param object1  the first object, may be &lt;code&gt;null&lt;/code&gt;
   * @param object2  the second object, may be &lt;code&gt;null&lt;/code&gt;
   * @return &lt;code&gt;true&lt;/code&gt; if the values of both objects are the same
   */
  public static boolean equals(Object object1, Object object2) {
      if (object1 == object2) {
          return true;
      }
      if ((object1 == null) || (object2 == null)) {
          return false;
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L4087">4087</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L1523">1523</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        null, true, true);
  }

  /**
   * replace a string or strings from a string, and put the output in a string
   * buffer. This does not recurse
   *
   * @param text
   *            string to look in
   * @param searchFor
   *            string array to search for
   * @param replaceWith
   *            string array to replace with
   * @return the string
   */
  public static String replace(String text, Object searchFor,
      Object replaceWith) {
    return replace(null, null, text, searchFor, replaceWith, false, 0,
        false);
  }

  /**
   * replace a string or strings from a string, and put the output in a string
   * buffer
   *
   * @param text
   *            string to look in
   * @param searchFor
   *            string array to search for
   * @param replaceWith
   *            string array to replace with
   * @param recurse
   *            if true then do multiple replaces (on the replacements)
   * @return the string
   */
  public static String replace(String text, Object searchFor,
      Object replaceWith, boolean recurse) {
    return replace(null, null, text, searchFor, replaceWith, recurse,
        recurse ? length(searchFor) : 0, false);
  }

  /**
   * replace a string or strings from a string, and put the output in a string
   * buffer
   *
   * @param text
   *            string to look in
   * @param searchFor
   *            string array to search for
   * @param replaceWith
   *            string array to replace with
   * @param recurse
   *            if true then do multiple replaces (on the replacements)
   * @param removeIfFound
   *            true if removing from searchFor and replaceWith if found
   * @return the string
   */
  public static String replace(String text, Object searchFor,
      Object replaceWith, boolean recurse, boolean removeIfFound) {
    return replace(null, null, text, searchFor, replaceWith, recurse,
        recurse ? length(searchFor) : 0, removeIfFound);
  }

  /**
   * &lt;p&gt;
   * Replaces all occurrences of a String within another String.
   * &lt;/p&gt;
   *
   * &lt;p&gt;
   * A &lt;code&gt;null&lt;/code&gt; reference passed to this method is a no-op.
   * &lt;/p&gt;
   *
   * &lt;pre&gt;
   * replace(null, *, *)        = null
   * replace(&amp;quot;&amp;quot;, *, *)          = &amp;quot;&amp;quot;
   * replace(&amp;quot;any&amp;quot;, null, *)    = &amp;quot;any&amp;quot;
   * replace(&amp;quot;any&amp;quot;, *, null)    = &amp;quot;any&amp;quot;
   * replace(&amp;quot;any&amp;quot;, &amp;quot;&amp;quot;, *)      = &amp;quot;any&amp;quot;
   * replace(&amp;quot;aba&amp;quot;, &amp;quot;a&amp;quot;, null)  = &amp;quot;aba&amp;quot;
   * replace(&amp;quot;aba&amp;quot;, &amp;quot;a&amp;quot;, &amp;quot;&amp;quot;)    = &amp;quot;b&amp;quot;
   * replace(&amp;quot;aba&amp;quot;, &amp;quot;a&amp;quot;, &amp;quot;z&amp;quot;)   = &amp;quot;zbz&amp;quot;
   * &lt;/pre&gt;
   *
   * @see #replace(String text, String repl, String with, int max)
   * @param text
   *            text to search and replace in, may be null
   * @param repl
   *            the String to search for, may be null
   * @param with
   *            the String to replace with, may be null
   * @return the text with any replacements processed, &lt;code&gt;null&lt;/code&gt; if
   *         null String input
   */
  public static String replace(String text, String repl, String with) {
    return replace(text, repl, with, -1);
  }

  /**
   * &lt;p&gt;
   * Replaces a String with another String inside a larger String, for the
   * first &lt;code&gt;max&lt;/code&gt; values of the search String.
   * &lt;/p&gt;
   *
   * &lt;p&gt;
   * A &lt;code&gt;null&lt;/code&gt; reference passed to this method is a no-op.
   * &lt;/p&gt;
   *
   * &lt;pre&gt;
   * replace(null, *, *, *)         = null
   * replace(&amp;quot;&amp;quot;, *, *, *)           = &amp;quot;&amp;quot;
   * replace(&amp;quot;any&amp;quot;, null, *, *)     = &amp;quot;any&amp;quot;
   * replace(&amp;quot;any&amp;quot;, *, null, *)     = &amp;quot;any&amp;quot;
   * replace(&amp;quot;any&amp;quot;, &amp;quot;&amp;quot;, *, *)       = &amp;quot;any&amp;quot;
   * replace(&amp;quot;any&amp;quot;, *, *, 0)        = &amp;quot;any&amp;quot;
   * replace(&amp;quot;abaa&amp;quot;, &amp;quot;a&amp;quot;, null, -1) = &amp;quot;abaa&amp;quot;
   * replace(&amp;quot;abaa&amp;quot;, &amp;quot;a&amp;quot;, &amp;quot;&amp;quot;, -1)   = &amp;quot;b&amp;quot;
   * replace(&amp;quot;abaa&amp;quot;, &amp;quot;a&amp;quot;, &amp;quot;z&amp;quot;, 0)   = &amp;quot;abaa&amp;quot;
   * replace(&amp;quot;abaa&amp;quot;, &amp;quot;a&amp;quot;, &amp;quot;z&amp;quot;, 1)   = &amp;quot;zbaa&amp;quot;
   * replace(&amp;quot;abaa&amp;quot;, &amp;quot;a&amp;quot;, &amp;quot;z&amp;quot;, 2)   = &amp;quot;zbza&amp;quot;
   * replace(&amp;quot;abaa&amp;quot;, &amp;quot;a&amp;quot;, &amp;quot;z&amp;quot;, -1)  = &amp;quot;zbzz&amp;quot;
   * &lt;/pre&gt;
   *
   * @param text
   *            text to search and replace in, may be null
   * @param repl
   *            the String to search for, may be null
   * @param with
   *            the String to replace with, may be null
   * @param max
   *            maximum number of values to replace, or &lt;code&gt;-1&lt;/code&gt; if
   *            no maximum
   * @return the text with any replacements processed, &lt;code&gt;null&lt;/code&gt; if
   *         null String input
   */
  public static String replace(String text, String repl, String with, int max) {
    if (text == null || isEmpty(repl) || with == null || max == 0) {
      return text;
    }

    StringBuffer buf = new StringBuffer(text.length());
    int start = 0, end = 0;
    while ((end = text.indexOf(repl, start)) != -1) {
      buf.append(text.substring(start, end)).append(with);
      start = end + repl.length();

      if (--max == 0) {
        break;
      }
    }
    buf.append(text.substring(start));
    return buf.toString();
  }

  /**
   * &lt;p&gt;
   * Checks if a String is empty (&quot;&quot;) or null.
   * &lt;/p&gt;
   *
   * &lt;pre&gt;
   * isEmpty(null)      = true
   * isEmpty(&amp;quot;&amp;quot;)        = true
   * isEmpty(&amp;quot; &amp;quot;)       = false
   * isEmpty(&amp;quot;bob&amp;quot;)     = false
   * isEmpty(&amp;quot;  bob  &amp;quot;) = false
   * &lt;/pre&gt;
   *
   * &lt;p&gt;
   * NOTE: This method changed in Lang version 2.0. It no longer trims the
   * String. That functionality is available in isBlank().
   * &lt;/p&gt;
   *
   * @param str
   *            the String to check, may be null
   * @return &lt;code&gt;true&lt;/code&gt; if the String is empty or null
   */
  public static boolean isEmpty(String str) {
    return str == null || str.length() == 0;
  }

  /**
   * replace a string or strings from a string, and put the output in a string
   * buffer. This does not recurse
   *
   * @param outBuffer
   *            stringbuffer to write to
   * @param text
   *            string to look in
   * @param searchFor
   *            string array to search for
   * @param replaceWith
   *            string array to replace with
   */
  public static void replace(StringBuffer outBuffer, String text,
      Object searchFor, Object replaceWith) {
    replace(outBuffer, null, text, searchFor, replaceWith, false, 0, false);
  }

  /**
   * replace a string or strings from a string, and put the output in a string
   * buffer
   *
   * @param outBuffer
   *            stringbuffer to write to
   * @param text
   *            string to look in
   * @param searchFor
   *            string array to search for
   * @param replaceWith
   *            string array to replace with
   * @param recurse
   *            if true then do multiple replaces (on the replacements)
   */
  public static void replace(StringBuffer outBuffer, String text,
      Object searchFor, Object replaceWith, boolean recurse) {
    replace(outBuffer, null, text, searchFor, replaceWith, recurse,
        recurse ? length(searchFor) : 0, false);
  }

  /**
   * replace a string with other strings, and either write to outWriter, or
   * StringBuffer, and if StringBuffer potentially return a string. If
   * outBuffer and outWriter are null, then return the String
   *
   * @param outBuffer
   *            stringbuffer to write to, or null to not
   * @param outWriter
   *            Writer to write to, or null to not.
   * @param text
   *            string to look in
   * @param searchFor
   *            string array to search for, or string, or list
   * @param replaceWith
   *            string array to replace with, or string, or list
   * @param recurse
   *            if true then do multiple replaces (on the replacements)
   * @param timeToLive
   *            if recursing, prevent endless loops
   * @param removeIfFound
   *            true if removing from searchFor and replaceWith if found
   * @return the String if outBuffer and outWriter are null
   * @throws IndexOutOfBoundsException
   *             if the lengths of the arrays are not the same (null is ok,
   *             and/or size 0)
   * @throws IllegalArgumentException
   *             if the search is recursive and there is an endless loop due
   *             to outputs of one being inputs to another
   */
  private static String replace(StringBuffer outBuffer, Writer outWriter,
      String text, Object searchFor, Object replaceWith, boolean recurse,
      int timeToLive, boolean removeIfFound) {

    // if recursing, we need to get the string, then print to buffer (since
    // we need multiple passes)
    if (!recurse) {
      return replaceHelper(outBuffer, outWriter, text, searchFor,
          replaceWith, recurse, timeToLive, removeIfFound);
    }
    // get the string
    String result = replaceHelper(null, null, text, searchFor, replaceWith,
        recurse, timeToLive, removeIfFound);
    if (outBuffer != null) {
      outBuffer.append(result);
      return null;
    }

    if (outWriter != null) {
      try {
        outWriter.write(result);
      } catch (IOException ioe) {
        throw new RuntimeException(ioe);
      }
      return null;
    }

    return result;

  }

  /**
   * replace a string or strings from a string, and put the output in a string
   * buffer. This does not recurse
   *
   * @param outWriter
   *            writer to write to
   * @param text
   *            string to look in
   * @param searchFor
   *            string array to search for
   * @param replaceWith
   *            string array to replace with
   */
  public static void replace(Writer outWriter, String text, Object searchFor,
      Object replaceWith) {
    replace(null, outWriter, text, searchFor, replaceWith, false, 0, false);
  }

  /**
   * replace a string or strings from a string, and put the output in a string
   * buffer
   *
   * @param outWriter
   *            writer to write to
   * @param text
   *            string to look in
   * @param searchFor
   *            string array to search for
   * @param replaceWith
   *            string array to replace with
   * @param recurse
   *            if true then do multiple replaces (on the replacements)
   */
  public static void replace(Writer outWriter, String text, Object searchFor,
      Object replaceWith, boolean recurse) {
    replace(null, outWriter, text, searchFor, replaceWith, recurse,
        recurse ? length(searchFor) : 0, false);
  }

  /**
   * replace a string with other strings, and either write to outWriter, or
   * StringBuffer, and if StringBuffer potentially return a string. If
   * outBuffer and outWriter are null, then return the String
   *
   * @param outBuffer
   *            stringbuffer to write to, or null to not
   * @param outWriter
   *            Writer to write to, or null to not.
   * @param text
   *            string to look in
   * @param searchFor
   *            string array to search for, or string, or list
   * @param replaceWith
   *            string array to replace with, or string, or list
   * @param recurse
   *            if true then do multiple replaces (on the replacements)
   * @param timeToLive
   *            if recursing, prevent endless loops
   * @param removeIfFound
   *            true if removing from searchFor and replaceWith if found
   * @return the String if outBuffer and outWriter are null
   * @throws IllegalArgumentException
   *             if the search is recursive and there is an endless loop due
   *             to outputs of one being inputs to another
   * @throws IndexOutOfBoundsException
   *             if the lengths of the arrays are not the same (null is ok,
   *             and/or size 0)
   */
  private static String replaceHelper(StringBuffer outBuffer,
      Writer outWriter, String text, Object searchFor,
      Object replaceWith, boolean recurse, int timeToLive,
      boolean removeIfFound) {

    try {
      // if recursing, this shouldnt be less than 0
      if (timeToLive &lt; 0) {
        throw new IllegalArgumentException(&quot;TimeToLive under 0: &quot;
            + timeToLive + &quot;, &quot; + text);
      }

      int searchForLength = length(searchFor);
      boolean done = false;
      // no need to do anything
      if (isEmpty(text)) {
        return text;
      }
      // need to write the input to output, later
      if (searchForLength == 0) {
        done = true;
      }

      boolean[] noMoreMatchesForReplIndex = null;
      int inputIndex = -1;
      int replaceIndex = -1;
      long resultPacked = -1;

      if (!done) {
        // make sure lengths are ok, these need to be equal
        if (searchForLength != length(replaceWith)) {
          throw new IndexOutOfBoundsException(&quot;Lengths dont match: &quot;
              + searchForLength + &quot;, &quot; + length(replaceWith));
        }

        // keep track of which still have matches
        noMoreMatchesForReplIndex = new boolean[searchForLength];

        // index of replace array that will replace the search string
        // found


        resultPacked = findNextIndexHelper(searchForLength, searchFor,
            replaceWith,
            noMoreMatchesForReplIndex, text, 0);

        inputIndex = unpackInt(resultPacked, true);
        replaceIndex = unpackInt(resultPacked, false);
      }

      // get a good guess on the size of the result buffer so it doesnt
      // have to double if it
      // goes over a bit
      boolean writeToWriter = outWriter != null;

      // no search strings found, we are done
      if (done || inputIndex == -1) {
        if (writeToWriter) {
          outWriter.write(text, 0, text.length());
          return null;
        }
        if (outBuffer != null) {
          appendSubstring(outBuffer, text, 0, text.length());
          return null;
        }
        return text;
      }

      // no buffer if writing to writer
      StringBuffer bufferToWriteTo = outBuffer != null ? outBuffer
          : (writeToWriter ? null : new StringBuffer(text.length()
              + replaceStringsBufferIncrease(text, searchFor,
                  replaceWith)));

      String searchString = null;
      String replaceString = null;

      int start = 0;

      while (inputIndex != -1) {

        searchString = (String) get(searchFor, replaceIndex);
        replaceString = (String) get(replaceWith, replaceIndex);
        if (writeToWriter) {
          outWriter.write(text, start, inputIndex - start);
          outWriter.write(replaceString);
        } else {
          appendSubstring(bufferToWriteTo, text, start, inputIndex)
              .append(replaceString);
        }

        if (removeIfFound) {
          // better be an iterator based find replace
          searchFor = remove(searchFor, replaceIndex);
          replaceWith = remove(replaceWith, replaceIndex);
          noMoreMatchesForReplIndex = (boolean[])remove(noMoreMatchesForReplIndex, replaceIndex);
          // we now have a lesser size if we removed one
          searchForLength--;
        }

        start = inputIndex + searchString.length();

        resultPacked = findNextIndexHelper(searchForLength, searchFor,
            replaceWith,
            noMoreMatchesForReplIndex, text, start);
        inputIndex = unpackInt(resultPacked, true);
        replaceIndex = unpackInt(resultPacked, false);
      }
      if (writeToWriter) {
        outWriter.write(text, start, text.length() - start);

      } else {
        appendSubstring(bufferToWriteTo, text, start, text.length());
      }

      // no need to convert to string if incoming buffer or writer
      if (writeToWriter || outBuffer != null) {
        if (recurse) {
          throw new IllegalArgumentException(
              &quot;Cannot recurse and write to existing buffer or writer!&quot;);
        }
        return null;
      }
      String resultString = bufferToWriteTo.toString();

      if (recurse) {
        return replaceHelper(outBuffer, outWriter, resultString,
            searchFor, replaceWith, recurse, timeToLive - 1, false);
      }
      // this might be null for writer
      return resultString;
    } catch (IOException ioe) {
      throw new RuntimeException(ioe);
    }
  }

  /**
   * give a best guess on buffer increase for String[] replace get a good
   * guess on the size of the result buffer so it doesnt have to double if it
   * goes over a bit
   *
   * @param text
   * @param repl
   * @param with
   * @return the increase, with 20% cap
   */
  static int replaceStringsBufferIncrease(String text, Object repl,
      Object with) {
    // count the greaters
    int increase = 0;
    Iterator iteratorReplace = iterator(repl);
    Iterator iteratorWith = iterator(with);
    int replLength = length(repl);
    String currentRepl = null;
    String currentWith = null;
    for (int i = 0; i &lt; replLength; i++) {
      currentRepl = (String) next(repl, iteratorReplace, i);
      currentWith = (String) next(with, iteratorWith, i);
      if (currentRepl == null || currentWith == null) {
        throw new NullPointerException(&quot;Replace string is null: &quot;
            + text + &quot;, &quot; + currentRepl + &quot;, &quot; + currentWith);
      }
      int greater = currentWith.length() - currentRepl.length();
      increase += greater &gt; 0 ? 3 * greater : 0; // assume 3 matches
    }
    // have upper-bound at 20% increase, then let Java take over
    increase = Math.min(increase, text.length() / 5);
    return increase;
  }

  /**
   * Helper method to find the next match in an array of strings replace
   *
   * @param searchForLength
   * @param searchFor
   * @param replaceWith
   * @param noMoreMatchesForReplIndex
   * @param input
   * @param start
   *            is where to start looking
   * @return result packed into a long, inputIndex first, then replaceIndex
   */
  private static long findNextIndexHelper(int searchForLength,
      Object searchFor, Object replaceWith, boolean[] noMoreMatchesForReplIndex,
      String input, int start) {

    int inputIndex = -1;
    int replaceIndex = -1;

    Iterator iteratorSearchFor = iterator(searchFor);
    Iterator iteratorReplaceWith = iterator(replaceWith);

    String currentSearchFor = null;
    String currentReplaceWith = null;
    int tempIndex = -1;
    for (int i = 0; i &lt; searchForLength; i++) {
      currentSearchFor = (String) next(searchFor, iteratorSearchFor, i);
      currentReplaceWith = (String) next(replaceWith,
          iteratorReplaceWith, i);
      if (noMoreMatchesForReplIndex[i] || isEmpty(currentSearchFor)
          || currentReplaceWith == null) {
        continue;
      }
      tempIndex = input.indexOf(currentSearchFor, start);

      // see if we need to keep searching for this
      noMoreMatchesForReplIndex[i] = tempIndex == -1;

      if (tempIndex != -1 &amp;&amp; (inputIndex == -1 || tempIndex &lt; inputIndex)) {
        inputIndex = tempIndex;
        replaceIndex = i;
      }

    }
    // dont create an array, no more objects
    long resultPacked = packInts(inputIndex, replaceIndex);
    return resultPacked;
  }

  /**
   * pack two ints into a long. Note: the first is held in the left bits, the
   * second is held in the right bits
   *
   * @param first
   *            is first int
   * @param second
   *            is second int
   * @return the long which has two ints in there
   */
  public static long packInts(int first, int second) {
    long result = first;
    result &lt;&lt;= 32;
    result |= second;
    return result;
  }

  /**
   * take a long
   *
   * @param theLong
   *            to unpack
   * @param isFirst
   *            true for first, false for second
   * @return one of the packed ints, first or second
   */
  public static int unpackInt(long theLong, boolean isFirst) {

    int result = 0;
    // put this in the position of the second one
    if (isFirst) {
      theLong &gt;&gt;= 32;
    }
    // only look at right part
    result = (int) (theLong &amp; 0xffffffff);
    return result;
  }

  /**
   * append a substring to a stringbuffer. removes dependency on substring
   * which creates objects
   *
   * @param buf
   *            stringbuffer
   * @param string
   *            source string
   * @param start
   *            start index of source string
   * @param end
   *            end index of source string
   * @return the string buffer for chaining
   */
  private static StringBuffer appendSubstring(StringBuffer buf,
      String string, int start, int end) {
    for (int i = start; i &lt; end; i++) {
      buf.append(string.charAt(i));
    }
    return buf;
  }

  /**
   * Get a specific index of an array or collection (note for collections and
   * iterating, it is more efficient to get an iterator and iterate
   *
   * @param arrayOrCollection
   * @param index
   * @return the object at that index
   */
  public static Object get(Object arrayOrCollection, int index) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L9658">9658</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L4610">4610</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * &lt;p&gt;Strips any of a set of characters from the start of a String.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.
   * An empty string (&quot;&quot;) input returns the empty string.&lt;/p&gt;
   *
   * &lt;p&gt;If the stripChars String is &lt;code&gt;null&lt;/code&gt;, whitespace is
   * stripped as defined by {@link Character#isWhitespace(char)}.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.stripStart(null, *)          = null
   * StringUtils.stripStart(&quot;&quot;, *)            = &quot;&quot;
   * StringUtils.stripStart(&quot;abc&quot;, &quot;&quot;)        = &quot;abc&quot;
   * StringUtils.stripStart(&quot;abc&quot;, null)      = &quot;abc&quot;
   * StringUtils.stripStart(&quot;  abc&quot;, null)    = &quot;abc&quot;
   * StringUtils.stripStart(&quot;abc  &quot;, null)    = &quot;abc  &quot;
   * StringUtils.stripStart(&quot; abc &quot;, null)    = &quot;abc &quot;
   * StringUtils.stripStart(&quot;yxabc  &quot;, &quot;xyz&quot;) = &quot;abc  &quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to remove characters from, may be null
   * @param stripChars  the characters to remove, null treated as whitespace
   * @return the stripped String, &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String stripStart(String str, String stripChars) {
    int strLen;
    if (str == null || (strLen = str.length()) == 0) {
      return str;
    }
    int start = 0;
    if (stripChars == null) {
      while ((start != strLen) &amp;&amp; Character.isWhitespace(str.charAt(start))) {
        start++;
      }
    } else if (stripChars.length() == 0) {
      return str;
    } else {
      while ((start != strLen) &amp;&amp; (stripChars.indexOf(str.charAt(start)) != -1)) {
        start++;
      }
    }
    return str.substring(start);
  }

  /**
   * &lt;p&gt;Strips any of a set of characters from the end of a String.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; input String returns &lt;code&gt;null&lt;/code&gt;.
   * An empty string (&quot;&quot;) input returns the empty string.&lt;/p&gt;
   *
   * &lt;p&gt;If the stripChars String is &lt;code&gt;null&lt;/code&gt;, whitespace is
   * stripped as defined by {@link Character#isWhitespace(char)}.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.stripEnd(null, *)          = null
   * StringUtils.stripEnd(&quot;&quot;, *)            = &quot;&quot;
   * StringUtils.stripEnd(&quot;abc&quot;, &quot;&quot;)        = &quot;abc&quot;
   * StringUtils.stripEnd(&quot;abc&quot;, null)      = &quot;abc&quot;
   * StringUtils.stripEnd(&quot;  abc&quot;, null)    = &quot;  abc&quot;
   * StringUtils.stripEnd(&quot;abc  &quot;, null)    = &quot;abc&quot;
   * StringUtils.stripEnd(&quot; abc &quot;, null)    = &quot; abc&quot;
   * StringUtils.stripEnd(&quot;  abcyx&quot;, &quot;xyz&quot;) = &quot;  abc&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to remove characters from, may be null
   * @param stripChars  the characters to remove, null treated as whitespace
   * @return the stripped String, &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String stripEnd(String str, String stripChars) {
    int end;
    if (str == null || (end = str.length()) == 0) {
      return str;
    }

    if (stripChars == null) {
      while ((end != 0) &amp;&amp; Character.isWhitespace(str.charAt(end - 1))) {
        end--;
      }
    } else if (stripChars.length() == 0) {
      return str;
    } else {
      while ((end != 0) &amp;&amp; (stripChars.indexOf(str.charAt(end - 1)) != -1)) {
        end--;
      }
    }
    return str.substring(0, end);
  }

  /**
   * The empty String &lt;code&gt;&quot;&quot;&lt;/code&gt;.
   * @since 2.0
   */
  public static final String EMPTY = &quot;&quot;;

  /**
   * Represents a failed index search.
   * @since 2.1
   */
  public static final int INDEX_NOT_FOUND = -1;

  /**
   * &lt;p&gt;The maximum size to which the padding constant(s) can expand.&lt;/p&gt;
   */
  private static final int PAD_LIMIT = 8192;

  /**
   * &lt;p&gt;An array of &lt;code&gt;String&lt;/code&gt;s used for padding.&lt;/p&gt;
   *
   * &lt;p&gt;Used for efficient space padding. The length of each String expands as needed.&lt;/p&gt;
   */
  private static final String[] PADDING = new String[Character.MAX_VALUE];

  static {
    // space padding is most common, start with 64 chars
    PADDING[32] = &quot;                                                                &quot;;
  }

  /**
   * &lt;p&gt;Repeat a String &lt;code&gt;repeat&lt;/code&gt; times to form a
   * new String.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.repeat(null, 2) = null
   * StringUtils.repeat(&quot;&quot;, 0)   = &quot;&quot;
   * StringUtils.repeat(&quot;&quot;, 2)   = &quot;&quot;
   * StringUtils.repeat(&quot;a&quot;, 3)  = &quot;aaa&quot;
   * StringUtils.repeat(&quot;ab&quot;, 2) = &quot;abab&quot;
   * StringUtils.repeat(&quot;a&quot;, -2) = &quot;&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to repeat, may be null
   * @param repeat  number of times to repeat str, negative treated as zero
   * @return a new String consisting of the original String repeated,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String repeat(String str, int repeat) {
    // Performance tuned for 2.0 (JDK1.4)

    if (str == null) {
      return null;
    }
    if (repeat &lt;= 0) {
      return EMPTY;
    }
    int inputLength = str.length();
    if (repeat == 1 || inputLength == 0) {
      return str;
    }
    if (inputLength == 1 &amp;&amp; repeat &lt;= PAD_LIMIT) {
      return padding(repeat, str.charAt(0));
    }

    int outputLength = inputLength * repeat;
    switch (inputLength) {
      case 1:
        char ch = str.charAt(0);
        char[] output1 = new char[outputLength];
        for (int i = repeat - 1; i &gt;= 0; i--) {
          output1[i] = ch;
        }
        return new String(output1);
      case 2:
        char ch0 = str.charAt(0);
        char ch1 = str.charAt(1);
        char[] output2 = new char[outputLength];
        for (int i = repeat * 2 - 2; i &gt;= 0; i--, i--) {
          output2[i] = ch0;
          output2[i + 1] = ch1;
        }
        return new String(output2);
      default:
        StringBuffer buf = new StringBuffer(outputLength);
        for (int i = 0; i &lt; repeat; i++) {
          buf.append(str);
        }
        return buf.toString();
    }
  }

  /**
   * &lt;p&gt;Returns padding using the specified delimiter repeated
   * to a given length.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.padding(0, 'e')  = &quot;&quot;
   * StringUtils.padding(3, 'e')  = &quot;eee&quot;
   * StringUtils.padding(-2, 'e') = IndexOutOfBoundsException
   * &lt;/pre&gt;
   *
   * @param repeat  number of times to repeat delim
   * @param padChar  character to repeat
   * @return String with repeated character
   * @throws IndexOutOfBoundsException if &lt;code&gt;repeat &amp;lt; 0&lt;/code&gt;
   */
  private static String padding(int repeat, char padChar) {
    // be careful of synchronization in this method
    // we are assuming that get and set from an array index is atomic
    String pad = PADDING[padChar];
    if (pad == null) {
      pad = String.valueOf(padChar);
    }
    while (pad.length() &lt; repeat) {
      pad = pad.concat(pad);
    }
    PADDING[padChar] = pad;
    return pad.substring(0, repeat);
  }

  /**
   * &lt;p&gt;Right pad a String with spaces (' ').&lt;/p&gt;
   *
   * &lt;p&gt;The String is padded to the size of &lt;code&gt;size&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.rightPad(null, *)   = null
   * StringUtils.rightPad(&quot;&quot;, 3)     = &quot;   &quot;
   * StringUtils.rightPad(&quot;bat&quot;, 3)  = &quot;bat&quot;
   * StringUtils.rightPad(&quot;bat&quot;, 5)  = &quot;bat  &quot;
   * StringUtils.rightPad(&quot;bat&quot;, 1)  = &quot;bat&quot;
   * StringUtils.rightPad(&quot;bat&quot;, -1) = &quot;bat&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to pad out, may be null
   * @param size  the size to pad to
   * @return right padded String or original String if no padding is necessary,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String rightPad(String str, int size) {
    return rightPad(str, size, ' ');
  }

  /**
   * &lt;p&gt;Right pad a String with a specified character.&lt;/p&gt;
   *
   * &lt;p&gt;The String is padded to the size of &lt;code&gt;size&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.rightPad(null, *, *)     = null
   * StringUtils.rightPad(&quot;&quot;, 3, 'z')     = &quot;zzz&quot;
   * StringUtils.rightPad(&quot;bat&quot;, 3, 'z')  = &quot;bat&quot;
   * StringUtils.rightPad(&quot;bat&quot;, 5, 'z')  = &quot;batzz&quot;
   * StringUtils.rightPad(&quot;bat&quot;, 1, 'z')  = &quot;bat&quot;
   * StringUtils.rightPad(&quot;bat&quot;, -1, 'z') = &quot;bat&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to pad out, may be null
   * @param size  the size to pad to
   * @param padChar  the character to pad with
   * @return right padded String or original String if no padding is necessary,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.0
   */
  public static String rightPad(String str, int size, char padChar) {
    if (str == null) {
      return null;
    }
    int pads = size - str.length();
    if (pads &lt;= 0) {
      return str; // returns original String when possible
    }
    if (pads &gt; PAD_LIMIT) {
      return rightPad(str, size, String.valueOf(padChar));
    }
    return str.concat(padding(pads, padChar));
  }

  /**
   * &lt;p&gt;Right pad a String with a specified String.&lt;/p&gt;
   *
   * &lt;p&gt;The String is padded to the size of &lt;code&gt;size&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.rightPad(null, *, *)      = null
   * StringUtils.rightPad(&quot;&quot;, 3, &quot;z&quot;)      = &quot;zzz&quot;
   * StringUtils.rightPad(&quot;bat&quot;, 3, &quot;yz&quot;)  = &quot;bat&quot;
   * StringUtils.rightPad(&quot;bat&quot;, 5, &quot;yz&quot;)  = &quot;batyz&quot;
   * StringUtils.rightPad(&quot;bat&quot;, 8, &quot;yz&quot;)  = &quot;batyzyzy&quot;
   * StringUtils.rightPad(&quot;bat&quot;, 1, &quot;yz&quot;)  = &quot;bat&quot;
   * StringUtils.rightPad(&quot;bat&quot;, -1, &quot;yz&quot;) = &quot;bat&quot;
   * StringUtils.rightPad(&quot;bat&quot;, 5, null)  = &quot;bat  &quot;
   * StringUtils.rightPad(&quot;bat&quot;, 5, &quot;&quot;)    = &quot;bat  &quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to pad out, may be null
   * @param size  the size to pad to
   * @param padStr  the String to pad with, null or empty treated as single space
   * @return right padded String or original String if no padding is necessary,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String rightPad(String str, int size, String padStr) {
    if (str == null) {
      return null;
    }
    if (isEmpty(padStr)) {
      padStr = &quot; &quot;;
    }
    int padLen = padStr.length();
    int strLen = str.length();
    int pads = size - strLen;
    if (pads &lt;= 0) {
      return str; // returns original String when possible
    }
    if (padLen == 1 &amp;&amp; pads &lt;= PAD_LIMIT) {
      return rightPad(str, size, padStr.charAt(0));
    }

    if (pads == padLen) {
      return str.concat(padStr);
    } else if (pads &lt; padLen) {
      return str.concat(padStr.substring(0, pads));
    } else {
      char[] padding = new char[pads];
      char[] padChars = padStr.toCharArray();
      for (int i = 0; i &lt; pads; i++) {
        padding[i] = padChars[i % padLen];
      }
      return str.concat(new String(padding));
    }
  }

  /**
   * &lt;p&gt;Left pad a String with spaces (' ').&lt;/p&gt;
   *
   * &lt;p&gt;The String is padded to the size of &lt;code&gt;size&lt;code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.leftPad(null, *)   = null
   * StringUtils.leftPad(&quot;&quot;, 3)     = &quot;   &quot;
   * StringUtils.leftPad(&quot;bat&quot;, 3)  = &quot;bat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 5)  = &quot;  bat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 1)  = &quot;bat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, -1) = &quot;bat&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to pad out, may be null
   * @param size  the size to pad to
   * @return left padded String or original String if no padding is necessary,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String leftPad(String str, int size) {
    return leftPad(str, size, ' ');
  }

  /**
   * &lt;p&gt;Left pad a String with a specified character.&lt;/p&gt;
   *
   * &lt;p&gt;Pad to a size of &lt;code&gt;size&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.leftPad(null, *, *)     = null
   * StringUtils.leftPad(&quot;&quot;, 3, 'z')     = &quot;zzz&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 3, 'z')  = &quot;bat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 5, 'z')  = &quot;zzbat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 1, 'z')  = &quot;bat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, -1, 'z') = &quot;bat&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to pad out, may be null
   * @param size  the size to pad to
   * @param padChar  the character to pad with
   * @return left padded String or original String if no padding is necessary,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.0
   */
  public static String leftPad(String str, int size, char padChar) {
    if (str == null) {
      return null;
    }
    int pads = size - str.length();
    if (pads &lt;= 0) {
      return str; // returns original String when possible
    }
    if (pads &gt; PAD_LIMIT) {
      return leftPad(str, size, String.valueOf(padChar));
    }
    return padding(pads, padChar).concat(str);
  }

  /**
   * &lt;p&gt;Left pad a String with a specified String.&lt;/p&gt;
   *
   * &lt;p&gt;Pad to a size of &lt;code&gt;size&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.leftPad(null, *, *)      = null
   * StringUtils.leftPad(&quot;&quot;, 3, &quot;z&quot;)      = &quot;zzz&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 3, &quot;yz&quot;)  = &quot;bat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 5, &quot;yz&quot;)  = &quot;yzbat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 8, &quot;yz&quot;)  = &quot;yzyzybat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 1, &quot;yz&quot;)  = &quot;bat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, -1, &quot;yz&quot;) = &quot;bat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 5, null)  = &quot;  bat&quot;
   * StringUtils.leftPad(&quot;bat&quot;, 5, &quot;&quot;)    = &quot;  bat&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to pad out, may be null
   * @param size  the size to pad to
   * @param padStr  the String to pad with, null or empty treated as single space
   * @return left padded String or original String if no padding is necessary,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   */
  public static String leftPad(String str, int size, String padStr) {
    if (str == null) {
      return null;
    }
    if (isEmpty(padStr)) {
      padStr = &quot; &quot;;
    }
    int padLen = padStr.length();
    int strLen = str.length();
    int pads = size - strLen;
    if (pads &lt;= 0) {
      return str; // returns original String when possible
    }
    if (padLen == 1 &amp;&amp; pads &lt;= PAD_LIMIT) {
      return leftPad(str, size, padStr.charAt(0));
    }

    if (pads == padLen) {
      return padStr.concat(str);
    } else if (pads &lt; padLen) {
      return padStr.substring(0, pads).concat(str);
    } else {
      char[] padding = new char[pads];
      char[] padChars = padStr.toCharArray();
      for (int i = 0; i &lt; pads; i++) {
        padding[i] = padChars[i % padLen];
      }
      return new String(padding).concat(str);
    }
  }

  /**
   * &lt;p&gt;Gets the substring before the first occurrence of a separator.
   * The separator is not returned.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; string input will return &lt;code&gt;null&lt;/code&gt;.
   * An empty (&quot;&quot;) string input will return the empty string.
   * A &lt;code&gt;null&lt;/code&gt; separator will return the input string.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.substringBefore(null, *)      = null
   * StringUtils.substringBefore(&quot;&quot;, *)        = &quot;&quot;
   * StringUtils.substringBefore(&quot;abc&quot;, &quot;a&quot;)   = &quot;&quot;
   * StringUtils.substringBefore(&quot;abcba&quot;, &quot;b&quot;) = &quot;a&quot;
   * StringUtils.substringBefore(&quot;abc&quot;, &quot;c&quot;)   = &quot;ab&quot;
   * StringUtils.substringBefore(&quot;abc&quot;, &quot;d&quot;)   = &quot;abc&quot;
   * StringUtils.substringBefore(&quot;abc&quot;, &quot;&quot;)    = &quot;&quot;
   * StringUtils.substringBefore(&quot;abc&quot;, null)  = &quot;abc&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to get a substring from, may be null
   * @param separator  the String to search for, may be null
   * @return the substring before the first occurrence of the separator,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.0
   */
  public static String substringBefore(String str, String separator) {
    if (isEmpty(str) || separator == null) {
      return str;
    }
    if (separator.length() == 0) {
      return EMPTY;
    }
    int pos = str.indexOf(separator);
    if (pos == -1) {
      return str;
    }
    return str.substring(0, pos);
  }

  /**
   * &lt;p&gt;Gets the substring after the first occurrence of a separator.
   * The separator is not returned.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; string input will return &lt;code&gt;null&lt;/code&gt;.
   * An empty (&quot;&quot;) string input will return the empty string.
   * A &lt;code&gt;null&lt;/code&gt; separator will return the empty string if the
   * input string is not &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.substringAfter(null, *)      = null
   * StringUtils.substringAfter(&quot;&quot;, *)        = &quot;&quot;
   * StringUtils.substringAfter(*, null)      = &quot;&quot;
   * StringUtils.substringAfter(&quot;abc&quot;, &quot;a&quot;)   = &quot;bc&quot;
   * StringUtils.substringAfter(&quot;abcba&quot;, &quot;b&quot;) = &quot;cba&quot;
   * StringUtils.substringAfter(&quot;abc&quot;, &quot;c&quot;)   = &quot;&quot;
   * StringUtils.substringAfter(&quot;abc&quot;, &quot;d&quot;)   = &quot;&quot;
   * StringUtils.substringAfter(&quot;abc&quot;, &quot;&quot;)    = &quot;abc&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to get a substring from, may be null
   * @param separator  the String to search for, may be null
   * @return the substring after the first occurrence of the separator,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.0
   */
  public static String substringAfter(String str, String separator) {
    if (isEmpty(str)) {
      return str;
    }
    if (separator == null) {
      return EMPTY;
    }
    int pos = str.indexOf(separator);
    if (pos == -1) {
      return EMPTY;
    }
    return str.substring(pos + separator.length());
  }

  /**
   * &lt;p&gt;Gets the substring before the last occurrence of a separator.
   * The separator is not returned.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; string input will return &lt;code&gt;null&lt;/code&gt;.
   * An empty (&quot;&quot;) string input will return the empty string.
   * An empty or &lt;code&gt;null&lt;/code&gt; separator will return the input string.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.substringBeforeLast(null, *)      = null
   * StringUtils.substringBeforeLast(&quot;&quot;, *)        = &quot;&quot;
   * StringUtils.substringBeforeLast(&quot;abcba&quot;, &quot;b&quot;) = &quot;abc&quot;
   * StringUtils.substringBeforeLast(&quot;abc&quot;, &quot;c&quot;)   = &quot;ab&quot;
   * StringUtils.substringBeforeLast(&quot;a&quot;, &quot;a&quot;)     = &quot;&quot;
   * StringUtils.substringBeforeLast(&quot;a&quot;, &quot;z&quot;)     = &quot;a&quot;
   * StringUtils.substringBeforeLast(&quot;a&quot;, null)    = &quot;a&quot;
   * StringUtils.substringBeforeLast(&quot;a&quot;, &quot;&quot;)      = &quot;a&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to get a substring from, may be null
   * @param separator  the String to search for, may be null
   * @return the substring before the last occurrence of the separator,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.0
   */
  public static String substringBeforeLast(String str, String separator) {
    if (isEmpty(str) || isEmpty(separator)) {
      return str;
    }
    int pos = str.lastIndexOf(separator);
    if (pos == -1) {
      return str;
    }
    return str.substring(0, pos);
  }

  /**
   * &lt;p&gt;Gets the substring after the last occurrence of a separator.
   * The separator is not returned.&lt;/p&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; string input will return &lt;code&gt;null&lt;/code&gt;.
   * An empty (&quot;&quot;) string input will return the empty string.
   * An empty or &lt;code&gt;null&lt;/code&gt; separator will return the empty string if
   * the input string is not &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;
   *
   * &lt;pre&gt;
   * StringUtils.substringAfterLast(null, *)      = null
   * StringUtils.substringAfterLast(&quot;&quot;, *)        = &quot;&quot;
   * StringUtils.substringAfterLast(*, &quot;&quot;)        = &quot;&quot;
   * StringUtils.substringAfterLast(*, null)      = &quot;&quot;
   * StringUtils.substringAfterLast(&quot;abc&quot;, &quot;a&quot;)   = &quot;bc&quot;
   * StringUtils.substringAfterLast(&quot;abcba&quot;, &quot;b&quot;) = &quot;a&quot;
   * StringUtils.substringAfterLast(&quot;abc&quot;, &quot;c&quot;)   = &quot;&quot;
   * StringUtils.substringAfterLast(&quot;a&quot;, &quot;a&quot;)     = &quot;&quot;
   * StringUtils.substringAfterLast(&quot;a&quot;, &quot;z&quot;)     = &quot;&quot;
   * &lt;/pre&gt;
   *
   * @param str  the String to get a substring from, may be null
   * @param separator  the String to search for, may be null
   * @return the substring after the last occurrence of the separator,
   *  &lt;code&gt;null&lt;/code&gt; if null String input
   * @since 2.0
   */
  public static String substringAfterLast(String str, String separator) {
    if (isEmpty(str)) {
      return str;
    }
    if (isEmpty(separator)) {
      return EMPTY;
    }
    int pos = str.lastIndexOf(separator);
    if (pos == -1 || pos == (str.length() - separator.length())) {
      return EMPTY;
    }
    return str.substring(pos + separator.length());
  }

  /**
   * wait for input
   */
  public static void waitForInput() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L5486">5486</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L2282">2282</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * convert a string date into a long date (e.g. for xml export)
   * @param date
   * @return the long or null if the date was null or blank
   */
  public static Long dateLongValue(String date) {
    if (isBlank(date)) {
      return null;
    }
    Date dateObject = dateValue(date);
    return dateObject.getTime();
  }

  /**
   * web service format string
   */
  private static final String TIMESTAMP_XML_FORMAT = &quot;yyyy/MM/dd HH:mm:ss.SSS&quot;;

  /**
   * date object to a string:
   * @param date
   * @return the long or null if the date was null or blank
   */
  public static String dateStringValue(Date date) {
    if (date == null) {
      return null;
    }
    SimpleDateFormat simpleDateFormat = new SimpleDateFormat(TIMESTAMP_XML_FORMAT);
    return simpleDateFormat.format(date);
  }

  /**
   * date object to a string:
   * @param theDate
   * @return the long or null if the date was null or blank
   */
  public static String dateStringValue(Long theDate) {
    if (theDate == null) {
      return null;
    }
    return dateStringValue(new Date(theDate));
  }

  /**
   * &lt;pre&gt;
   * Convert an object to a java.util.Date.  allows, dates, null, blank,
   * yyyymmdd or yyyymmdd hh24:mm:ss
   * or yyyy/MM/dd HH:mm:ss.SSS
   * &lt;/pre&gt;
   * @param inputObject
   *          is the String or Date to convert
   *
   * @return the Date
   */
  public static Date dateValue(Object inputObject) {
    if (inputObject == null) {
      return null;
    }

    if (inputObject instanceof java.util.Date) {
      return (Date)inputObject;
    }

    if (inputObject instanceof String) {
      String input = (String)inputObject;
      //trim and handle null and empty
      if (isBlank(input)) {
        return null;
      }

      try {
        if (input.length() == 8) {

          return dateFormat().parse(input);
        }
        if (!contains(input, '.')) {
          if (contains(input, '/')) {
            return dateMinutesSecondsFormat.parse(input);
          }
          //else no slash
          return dateMinutesSecondsNoSlashFormat.parse(input);
        }
        if (contains(input, '/')) {
          //see if the period is 6 back
          int lastDotIndex = input.lastIndexOf('.');
          if (lastDotIndex == input.length() - 7) {
            String nonNanoInput = input.substring(0,input.length()-3);
            Date date = timestampFormat.parse(nonNanoInput);
            //get the last 3
            String lastThree = input.substring(input.length()-3,input.length());
            int lastThreeInt = Integer.parseInt(lastThree);
            Timestamp timestamp = new Timestamp(date.getTime());
            timestamp.setNanos(timestamp.getNanos() + (lastThreeInt * 1000));
            return timestamp;
          }
          return timestampFormat.parse(input);
        }
        //else no slash
        return timestampNoSlashFormat.parse(input);
      } catch (ParseException pe) {
        throw new RuntimeException(errorStart + toStringForLog(input));
      }
    }

    throw new RuntimeException(&quot;Cannot convert Object to date : &quot; + toStringForLog(inputObject));
  }

  /**
   * match regex pattern yyyy-mm-dd or yyyy/mm/dd
   */
  private static Pattern datePattern_yyyy_mm_dd = Pattern.compile(&quot;^(\\d{4})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})$&quot;);

  /**
   * match regex pattern dd-mon-yyyy or dd/mon/yyyy
   */
  private static Pattern datePattern_dd_mon_yyyy = Pattern.compile(&quot;^(\\d{1,2})[^\\d]+([a-zA-Z]{3,15})[^\\d]+(\\d{4})$&quot;);

  /**
   * match regex pattern yyyy-mm-dd hh:mm:ss or yyyy/mm/dd hh:mm:ss
   */
  private static Pattern datePattern_yyyy_mm_dd_hhmmss = Pattern.compile(&quot;^(\\d{4})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})$&quot;);

  /**
   * match regex pattern dd-mon-yyyy hh:mm:ss or dd/mon/yyyy hh:mm:ss
   */
  private static Pattern datePattern_dd_mon_yyyy_hhmmss = Pattern.compile(&quot;^(\\d{1,2})[^\\d]+([a-zA-Z]{3,15})[^\\d]+(\\d{4})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})$&quot;);

  /**
   * match regex pattern yyyy-mm-dd hh:mm:ss.SSS or yyyy/mm/dd hh:mm:ss.SSS
   */
  private static Pattern datePattern_yyyy_mm_dd_hhmmss_SSS = Pattern.compile(&quot;^(\\d{4})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,3})$&quot;);

  /**
   * match regex pattern dd-mon-yyyy hh:mm:ss.SSS or dd/mon/yyyy hh:mm:ss.SSS
   */
  private static Pattern datePattern_dd_mon_yyyy_hhmmss_SSS = Pattern.compile(&quot;^(\\d{1,2})[^\\d]+([a-zA-Z]{3,15})[^\\d]+(\\d{4})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,2})[^\\d]+(\\d{1,3})$&quot;);

  /**
   * take as input:
   * yyyy/mm/dd
   * yyyy-mm-dd
   * dd-mon-yyyy
   * yyyy/mm/dd hh:mm:ss
   * dd-mon-yyyy hh:mm:ss
   * yyyy/mm/dd hh:mm:ss.SSS
   * dd-mon-yyyy hh:mm:ss.SSS
   * @param input
   * @return the date
   */
  public static Date stringToDate2(String input) {

    if (isBlank(input)) {
      return null;
    }
    input = input.trim();
    Matcher matcher = null;

    int month = 0;
    int day = 0;
    int year = 0;
    int hour = 0;
    int minute = 0;
    int second = 0;
    int milli = 0;

    boolean foundMatch = false;

    //yyyy/mm/dd
    if (!foundMatch) {
      matcher = datePattern_yyyy_mm_dd.matcher(input);
      if (matcher.matches()) {
        year = intValue(matcher.group(1));
        month =  intValue(matcher.group(2));
        day = intValue(matcher.group(3));
        foundMatch = true;
      }
    }

    //dd-mon-yyyy
    if (!foundMatch) {
      matcher = datePattern_dd_mon_yyyy.matcher(input);
      if (matcher.matches()) {
        day = intValue(matcher.group(1));
        month =  monthInt(matcher.group(2));
        year = intValue(matcher.group(3));
        foundMatch = true;
      }
    }

    //yyyy/mm/dd hh:mm:ss
    if (!foundMatch) {
      matcher = datePattern_yyyy_mm_dd_hhmmss.matcher(input);
      if (matcher.matches()) {
        year = intValue(matcher.group(1));
        month =  intValue(matcher.group(2));
        day = intValue(matcher.group(3));
        hour = intValue(matcher.group(4));
        minute = intValue(matcher.group(5));
        second = intValue(matcher.group(6));
        foundMatch = true;
      }
    }

    //dd-mon-yyyy hh:mm:ss
    if (!foundMatch) {
      matcher = datePattern_dd_mon_yyyy_hhmmss.matcher(input);
      if (matcher.matches()) {
        day = intValue(matcher.group(1));
        month =  monthInt(matcher.group(2));
        year = intValue(matcher.group(3));
        hour = intValue(matcher.group(4));
        minute = intValue(matcher.group(5));
        second = intValue(matcher.group(6));
        foundMatch = true;
      }
    }

    //yyyy/mm/dd hh:mm:ss.SSS
    if (!foundMatch) {
      matcher = datePattern_yyyy_mm_dd_hhmmss_SSS.matcher(input);
      if (matcher.matches()) {
        year = intValue(matcher.group(1));
        month =  intValue(matcher.group(2));
        day = intValue(matcher.group(3));
        hour = intValue(matcher.group(4));
        minute = intValue(matcher.group(5));
        second = intValue(matcher.group(6));
        milli = intValue(matcher.group(7));
        foundMatch = true;
      }
    }

    //dd-mon-yyyy hh:mm:ss.SSS
    if (!foundMatch) {
      matcher = datePattern_dd_mon_yyyy_hhmmss_SSS.matcher(input);
      if (matcher.matches()) {
        day = intValue(matcher.group(1));
        month =  monthInt(matcher.group(2));
        year = intValue(matcher.group(3));
        hour = intValue(matcher.group(4));
        minute = intValue(matcher.group(5));
        second = intValue(matcher.group(6));
        milli = intValue(matcher.group(7));
        foundMatch = true;
      }
    }

    Calendar calendar = Calendar.getInstance();
    calendar.set(Calendar.YEAR, year);
    calendar.set(Calendar.MONTH, month-1);
    calendar.set(Calendar.DAY_OF_MONTH, day);
    calendar.set(Calendar.HOUR_OF_DAY, hour);
    calendar.set(Calendar.MINUTE, minute);
    calendar.set(Calendar.SECOND, second);
    calendar.set(Calendar.MILLISECOND, milli);
    return calendar.getTime();
  }

  /**
   * convert a month string to an int (1 indexed).
   * e.g. if input is feb or Feb or february or February return 2
   * @param mon
   * @return the month
   */
  public static int monthInt(String mon) {

    if (!isBlank(mon)) {
      mon = mon.toLowerCase();

      if (equals(mon, &quot;jan&quot;) || equals(mon, &quot;january&quot;)) {
        return 1;
      }

      if (equals(mon, &quot;feb&quot;) || equals(mon, &quot;february&quot;)) {
        return 2;
      }

      if (equals(mon, &quot;mar&quot;) || equals(mon, &quot;march&quot;)) {
        return 3;
      }

      if (equals(mon, &quot;apr&quot;) || equals(mon, &quot;april&quot;)) {
        return 4;
      }

      if (equals(mon, &quot;may&quot;)) {
        return 5;
      }

      if (equals(mon, &quot;jun&quot;) || equals(mon, &quot;june&quot;)) {
        return 6;
      }

      if (equals(mon, &quot;jul&quot;) || equals(mon, &quot;july&quot;)) {
        return 7;
      }

      if (equals(mon, &quot;aug&quot;) || equals(mon, &quot;august&quot;)) {
        return 8;
      }

      if (equals(mon, &quot;sep&quot;) || equals(mon, &quot;september&quot;)) {
        return 9;
      }

      if (equals(mon, &quot;oct&quot;) || equals(mon, &quot;october&quot;)) {
        return 10;
      }

      if (equals(mon, &quot;nov&quot;) || equals(mon, &quot;november&quot;)) {
        return 11;
      }

      if (equals(mon, &quot;dec&quot;) || equals(mon, &quot;december&quot;)) {
        return 12;
      }

    }

    throw new RuntimeException(&quot;Invalid month: &quot; + mon);
  }

  /**
   * See if the input is null or if string, if it is empty or blank (whitespace)
   * @param input
   * @return true if blank
   */
  public static boolean isBlank(Object input) {
    if (null == input) {
      return true;
    }
    return (input instanceof String &amp;&amp; isBlank((String)input));
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L10538">10538</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L5314">5314</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    return stringFieldNames.get(theClass);
  }

    /**
   * if theString is not blank, apppend it to the result, and if appending,
   * @param result to append to
   * add a prefix and suffix (if not null)
   * @param theStringOrArrayOrList is a string, array, list, or set of strings
   * @return true if something appended, false if not
   */
  public static boolean appendIfNotBlank(StringBuilder result,
      Object theStringOrArrayOrList) {
    return appendIfNotBlank(result, null, theStringOrArrayOrList, null);
  }

  /**
   * &lt;pre&gt;
   * append a string to another string if both not blank, with separator.  trim to empty everything
   * &lt;/pre&gt;
   * @param string
   * @param separator
   * @param suffix
   * @return the resulting string or blank if nothing
   */
  public static String appendIfNotBlankString(String string, String separator, String suffix) {

    string = StringUtils.trimToEmpty(string);
    suffix = StringUtils.trimToEmpty(suffix);

    boolean stringIsBlank = StringUtils.isBlank(string);
    boolean suffixIsBlank = StringUtils.isBlank(suffix);

    if (stringIsBlank &amp;&amp; suffixIsBlank) {
      return &quot;&quot;;
    }

    if (stringIsBlank) {
      return suffix;
    }

    if (suffixIsBlank) {
      return string;
    }

    return string + separator + suffix;

  }

  /**
   * &lt;pre&gt;
   * append a prefix to another string if both not blank.  trim to empty everything
   * i.e. appendPrefixIfStringNotBlank(&quot;[]&quot;, &quot; - &quot;, &quot;a&quot;)   returns [] - a
   * i.e. appendPrefixIfStringNotBlank(&quot;&quot;, &quot; - &quot;, &quot;a&quot;)   returns a
   * i.e. appendPrefixIfStringNotBlank(&quot;[]&quot;, &quot; - &quot;, &quot;&quot;)   returns &quot;&quot;
   * i.e. appendPrefixIfStringNotBlank(&quot;&quot;, &quot; - &quot;, &quot;&quot;)   returns &quot;&quot;
   * &lt;/pre&gt;
   * @param prefix
   * @param separator
   * @param string
   * @return the resulting string or blank if nothing
   */
  public static String appendPrefixIfStringNotBlank(String prefix, String separator, String string) {
    
    string = StringUtils.trimToEmpty(string);
    prefix = StringUtils.trimToEmpty(prefix);
    
    boolean stringIsBlank = StringUtils.isBlank(string);
    boolean prefixIsBlank = StringUtils.isBlank(prefix);

    if (stringIsBlank) {
      return &quot;&quot;;
    }

    if (prefixIsBlank) {
      return string;
    }
    
    return prefix + separator + string;
    
  }

  /**
   * if theString is not Blank, apppend it to the result, and if appending,
   * add a prefix (if not null)
   * @param result to append to
   * @param prefix
   * @param theStringOrArrayOrList is a string, array, list, or set of strings
   * @return true if something appended, false if not
   */
  public static boolean appendIfNotBlank(StringBuilder result,
      String prefix, Object theStringOrArrayOrList) {
    return appendIfNotBlank(result, prefix, theStringOrArrayOrList, null);
  }

  /**
   * if theString is not Blank, apppend it to the result, and if appending,
   * add a prefix and suffix (if not null)
   * @param result to append to, assumed to be not null
   * @param prefix
   * @param theStringOrArrayOrList is a string, array, list, or set of strings
   * @param suffix
   * @return true if anything appended, false if not
   */
  public static boolean appendIfNotBlank(StringBuilder result,
      String prefix, Object theStringOrArrayOrList, String suffix) {
    return appendIfNotBlank(result, prefix, null, theStringOrArrayOrList, suffix);
  }

  /**
   * if theString is not Blank, apppend it to the result, and if appending,
   * add a prefix and suffix (if not null)
   * @param result to append to, assumed to be not null
   * @param prefix prepend this prefix always (when a result not empty).  Will be after the other prefix
   * @param prefixIfNotBlank prepend this prefix if the result is not empty
   * @param theStringOrArrayOrList is a string, array, list, or set of strings
   * @param suffix
   * @return true if anything appended, false if not
   */
  public static boolean appendIfNotBlank(StringBuilder result,
      String prefix, String prefixIfNotBlank, Object theStringOrArrayOrList, String suffix) {
    int length = length(theStringOrArrayOrList);
    Iterator iterator = iterator(theStringOrArrayOrList);
    boolean appendedAnything = false;

    //these could be appending spaces, so only check to see if they are empty
    boolean hasPrefix = !StringUtils.isEmpty(prefix);
    boolean hasPrefixIfNotBlank = !StringUtils.isEmpty(prefixIfNotBlank);
    boolean hasSuffix = !StringUtils.isEmpty(suffix);
    for (int i=0;i&lt;length;i++) {
      String  current = (String) next(theStringOrArrayOrList, iterator, i);

      //only append if not empty
      if (!StringUtils.isBlank(current)) {

        //keeping track if anything changed
        appendedAnything = true;
        if (hasPrefix) {
          result.append(prefix);
        }
        if (hasPrefixIfNotBlank &amp;&amp; result.length() &gt; 0) {
          result.append(prefixIfNotBlank);
        }
        result.append(current);
        if (hasSuffix) {
          result.append(suffix);
        }
      }
    }
    return appendedAnything;
  }

  /**
     * if theString is not empty, apppend it to the result, and if appending,
     * @param result to append to
     * add a prefix and suffix (if not null)
     * @param theStringOrArrayOrList is a string, array, list, or set of strings
     * @return true if something appended, false if not
     */
    public static boolean appendIfNotEmpty(StringBuilder result,
        Object theStringOrArrayOrList) {
      return appendIfNotEmpty(result, null, theStringOrArrayOrList, null);
  }

  /**
   * if theString is not empty, apppend it to the result, and if appending,
   * add a prefix (if not null)
   * @param result to append to
   * @param prefix
   * @param theStringOrArrayOrList is a string, array, list, or set of strings
   * @return true if something appended, false if not
   */
  public static boolean appendIfNotEmpty(StringBuilder result,
      String prefix, Object theStringOrArrayOrList) {
    return appendIfNotEmpty(result, prefix, theStringOrArrayOrList, null);
  }

  /**
   * if theString is not empty, apppend it to the result, and if appending,
   * add a prefix and suffix (if not null)
   * @param result to append to, assumed to be not null
   * @param prefix
   * @param theStringOrArrayOrList is a string, array, list, or set of strings
   * @param suffix
   * @return true if anything appended, false if not
   */
  public static boolean appendIfNotEmpty(StringBuilder result,
      String prefix, Object theStringOrArrayOrList, String suffix) {
    return appendIfNotEmpty(result, prefix, null, theStringOrArrayOrList, suffix);
  }

  /**
   * if theString is not empty, apppend it to the result, and if appending,
   * add a prefix and suffix (if not null)
   * @param result to append to, assumed to be not null
   * @param prefix prepend this prefix always (when a result not empty).  Will be after the other prefix
   * @param prefixIfNotEmpty prepend this prefix if the result is not empty
   * @param theStringOrArrayOrList is a string, array, list, or set of strings
   * @param suffix
   * @return true if anything appended, false if not
   */
  public static boolean appendIfNotEmpty(StringBuilder result,
      String prefix, String prefixIfNotEmpty, Object theStringOrArrayOrList, String suffix) {
    int length = length(theStringOrArrayOrList);
    Iterator iterator = iterator(theStringOrArrayOrList);
    boolean appendedAnything = false;
    boolean hasPrefix = !StringUtils.isEmpty(prefix);
    boolean hasPrefixIfNotEmpty = !StringUtils.isEmpty(prefixIfNotEmpty);
    boolean hasSuffix = !StringUtils.isEmpty(suffix);
    for (int i=0;i&lt;length;i++) {
      String  current = (String) next(theStringOrArrayOrList, iterator, i);

      //only append if not empty
      if (!StringUtils.isEmpty(current)) {

        //keeping track if anything changed
        appendedAnything = true;
        if (hasPrefix) {
          result.append(prefix);
        }
        if (hasPrefixIfNotEmpty &amp;&amp; result.length() &gt; 0) {
          result.append(prefixIfNotEmpty);
        }
        result.append(current);
        if (hasSuffix) {
          result.append(suffix);
        }
      }
    }
    return appendedAnything;
  }

  /**
   * &lt;p&gt;Find the index of the given object in the array.&lt;/p&gt;
   *
   * &lt;p&gt;This method returns &lt;code&gt;-1&lt;/code&gt; if &lt;code&gt;null&lt;/code&gt; array input.&lt;/p&gt;
   *
   * @param array  the array to search through for the object, may be &lt;code&gt;null&lt;/code&gt;
   * @param objectToFind  the object to find, may be &lt;code&gt;null&lt;/code&gt;
   * @return the index of the object within the array,
   *  &lt;code&gt;-1&lt;/code&gt; if not found or &lt;code&gt;null&lt;/code&gt; array input
   */
  public static int indexOf(Object[] array, Object objectToFind) {
    return indexOf(array, objectToFind, 0);
  }

  /**
   * &lt;p&gt;Checks if the object is in the given array.&lt;/p&gt;
   *
   * &lt;p&gt;The method returns &lt;code&gt;false&lt;/code&gt; if a &lt;code&gt;null&lt;/code&gt; array is passed in.&lt;/p&gt;
   *
   * @param array  the array to search through
   * @param objectToFind  the object to find
   * @return &lt;code&gt;true&lt;/code&gt; if the array contains the object
   */
  public static boolean contains(Object[] array, Object objectToFind) {
    return indexOf(array, objectToFind) != -1;
  }

  /**
   * &lt;p&gt;Find the index of the given object in the array starting at the given index.&lt;/p&gt;
   *
   * &lt;p&gt;This method returns &lt;code&gt;-1&lt;/code&gt; if &lt;code&gt;null&lt;/code&gt; array input.&lt;/p&gt;
   *
   * &lt;p&gt;A negative startIndex is treated as zero. A startIndex larger than the array
   * length will return &lt;code&gt;-1&lt;/code&gt;.&lt;/p&gt;
   *
   * @param array  the array to search through for the object, may be &lt;code&gt;null&lt;/code&gt;
   * @param objectToFind  the object to find, may be &lt;code&gt;null&lt;/code&gt;
   * @param startIndex  the index to start searching at
   * @return the index of the object within the array starting at the index,
   *  &lt;code&gt;-1&lt;/code&gt; if not found or &lt;code&gt;null&lt;/code&gt; array input
   */
  public static int indexOf(Object[] array, Object objectToFind, int startIndex) {
    if (array == null) {
      return -1;
    }
    if (startIndex &lt; 0) {
      startIndex = 0;
    }
    if (objectToFind == null) {
      for (int i = startIndex; i &lt; array.length; i++) {
        if (array[i] == null) {
          return i;
        }
      }
    } else {
      for (int i = startIndex; i &lt; array.length; i++) {
        if (objectToFind.equals(array[i])) {
          return i;
        }
      }
    }
    return -1;
  }

  /**
   * Return the zero element of the array, if it exists, null if the array is empty.
   * If there is more than one element in the list, an exception is thrown.
   * @param &lt;T&gt;
   * @param array is the container of objects to get the first of.
   * @return the first object, null, or exception.
   */
  public static &lt;T&gt; T arrayPopOne(T[] array) {
    int size = length(array);
    if (size == 1) {
      return array[0];
    } else if (size == 0) {
      return null;
    }
    throw new RuntimeException(&quot;More than one object of type &quot; + className(array[0])
        + &quot; was returned when only one was expected. (size:&quot; + size +&quot;)&quot; );
  }

  /**
   * Note, this is
   * web service format string
   */
  private static final String WS_DATE_FORMAT = &quot;yyyy/MM/dd HH:mm:ss.SSS&quot;;

  /**
   * Note, this is
   * web service format string
   */
  private static final String WS_DATE_FORMAT2 = &quot;yyyy/MM/dd_HH:mm:ss.SSS&quot;;

  /**
   * convert a date to a string using the standard web service pattern
   * yyyy/MM/dd HH:mm:ss.SSS Note that HH is 0-23
   *
   * @param date
   * @return the string, or null if the date is null
   */
  public static String dateToString(Date date) {
    if (date == null) {
      return null;
    }
    SimpleDateFormat simpleDateFormat = new SimpleDateFormat(WS_DATE_FORMAT);
    return simpleDateFormat.format(date);
  }

  /**
   * convert a string to a date using the standard web service pattern Note
   * that HH is 0-23
   *
   * @param dateString
   * @return the string, or null if the date was null
   */
  public static Date stringToDate(String dateString) {
    if (isBlank(dateString)) {
      return null;
    }
    SimpleDateFormat simpleDateFormat = new SimpleDateFormat(WS_DATE_FORMAT);
    try {
      return simpleDateFormat.parse(dateString);
    } catch (ParseException e) {
      SimpleDateFormat simpleDateFormat2 = new SimpleDateFormat(WS_DATE_FORMAT2);
      try {
        return simpleDateFormat2.parse(dateString);
      } catch (ParseException e2) {
        throw new RuntimeException(&quot;Cannot convert '&quot; + dateString
            + &quot;' to a date based on format: &quot; + WS_DATE_FORMAT, e);
      }
    }
  }

  /**
   * @param values
   * @return the max long in the list of args
   */
  public static Long getMaxLongValue(Long... values) {
    if (values == null || values.length == 0) {
      return null;
    }

    Long maxValue = null;
    for (int i = 0; i &lt; values.length; i++) {
      if (values[i] != null) {
        if (maxValue == null || maxValue.compareTo(values[i]) &lt; 0) {
          maxValue = new Long(values[i]);
        }
      }
    }

    return maxValue;
  }

  /**
   * @param values
   * @return the min long in the list of args
   */
  public static Long getMinLongValue(Long... values) {
    if (values == null || values.length == 0) {
      return null;
    }

    Long minValue = null;
    for (int i = 0; i &lt; values.length; i++) {
      if (values[i] != null) {
        if (minValue == null || minValue.compareTo(values[i]) &gt; 0) {
          minValue = new Long(values[i]);
        }
      }
    }

    return minValue;
  }

  /**
   * override map for properties in thread local to be used in a web server or the like, based on property file name
   * @param propertiesFileName
   * @return the override map
   */
  public static Map&lt;String, String&gt; propertiesThreadLocalOverrideMap(String propertiesFileName) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L6073">6073</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L2775">2775</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    synchronized (GrouperUtil.class) {
      if (date == null) {
        return null;
      }

      String theString = dateFormat().format(date);

      return theString;
    }
  }

  /**
   * &lt;pre&gt;convert a string to timestamp based on the following formats:
   * yyyyMMdd
   * yyyy/MM/dd
   * yyyy/MM/dd HH:mm:ss
   * yyyy/MM/dd HH:mm:ss.SSS
   * yyyy/MM/dd HH:mm:ss.SSSSSS
   * &lt;/pre&gt;
   * @param input
   * @return the timestamp object
   */
  public static Timestamp stringToTimestamp(String input) {
    Date date = stringToTimestampHelper(input);
    if (date == null) {
      return null;
    }
    //maybe already a timestamp
    if (date instanceof Timestamp) {
      return (Timestamp)date;
    }
    return new Timestamp(date.getTime());
  }

  /**
   * return a date based on input, null safe.  Allow any of the three
   * formats:
   * yyyyMMdd
   * yyyy/MM/dd
   * yyyy/MM/dd HH:mm:ss
   * yyyy/MM/dd HH:mm:ss.SSS
   * yyyy/MM/dd HH:mm:ss.SSSSSS
   *
   * @param input
   * @return the millis, -1 for null
   */
  synchronized static Date stringToTimestampHelper(String input) {
    //trim and handle null and empty
    if (isBlank(input)) {
      return null;
    }
    input = input.trim();
    try {
      //convert mainframe
      if (equals(&quot;99999999&quot;, input)
          || equals(&quot;999999&quot;, input)) {
        input = &quot;20991231&quot;;
      }
      if (input.length() == 8) {

        return dateFormat().parse(input);
      }
      if (input.length() == 10) {

        return dateFormat2().parse(input);
      }
      if (!contains(input, '.')) {
        if (contains(input, '/')) {
          return dateMinutesSecondsFormat.parse(input);
        }
        //else no slash
        return dateMinutesSecondsNoSlashFormat.parse(input);
      }
      if (contains(input, '/')) {
        //see if the period is 6 back
        int lastDotIndex = input.lastIndexOf('.');
        if (lastDotIndex == input.length() - 7) {
          String nonNanoInput = input.substring(0,input.length()-3);
          Date date = timestampFormat.parse(nonNanoInput);
          //get the last 3
          String lastThree = input.substring(input.length()-3,input.length());
          int lastThreeInt = Integer.parseInt(lastThree);
          Timestamp timestamp = new Timestamp(date.getTime());
          timestamp.setNanos(timestamp.getNanos() + (lastThreeInt * 1000));
          return timestamp;
        }
        return timestampFormat.parse(input);
      }
      //else no slash
      return timestampNoSlashFormat.parse(input);
    } catch (ParseException pe) {
      throw new RuntimeException(errorStart + input);
    }
  }

  /**
   * start of error parsing messages
   */
  private static final String errorStart = &quot;Invalid timestamp, please use any of the formats: &quot;
    + DATE_FORMAT + &quot;, &quot; + TIMESTAMP_FORMAT
    + &quot;, &quot; + DATE_MINUTES_SECONDS_FORMAT + &quot;: &quot;;

  /**
   * Convert an object to a byte, allow nulls
   * @param input
   * @return the boolean object value
   */
  public static BigDecimal bigDecimalObjectValue(Object input) {
    if (input instanceof BigDecimal) {
      return (BigDecimal)input;
    }
    if (isBlank(input)) {
      return null;
    }
    return BigDecimal.valueOf(doubleValue(input));
  }

  /**
   * Convert an object to a byte, allow nulls
   * @param input
   * @return the boolean object value
   */
  public static Byte byteObjectValue(Object input) {
    if (input instanceof Byte) {
      return (Byte)input;
    }
    if (isBlank(input)) {
      return null;
    }
    return Byte.valueOf(byteValue(input));
  }

  /**
   * convert an object to a byte
   * @param input
   * @return the byte
   */
  public static byte byteValue(Object input) {
    if (input instanceof String) {
      String string = (String)input;
      return Byte.parseByte(string);
    }
    if (input instanceof Number) {
      return ((Number)input).byteValue();
    }
    throw new RuntimeException(&quot;Cannot convert to byte: &quot; + className(input));
  }

  /**
   * get the Double value of an object
   *
   * @param input
   *          is a number or String
   * @param allowNullBlank used to default to false, if true, return null if nul inputted
   *
   * @return the Double equivalent
   */
  public static Double doubleObjectValue(Object input, boolean allowNullBlank) {

    if (input instanceof Double) {
      return (Double) input;
    }

    if (allowNullBlank &amp;&amp; isBlank(input)) {
      return null;
    }

    return Double.valueOf(doubleValue(input));
  }

  /**
   * get the double value of an object
   *
   * @param input
   *          is a number or String
   *
   * @return the double equivalent
   */
  public static double doubleValue(Object input) {
    if (input instanceof String) {
      String string = (String)input;
      return Double.parseDouble(string);
    }
    if (input instanceof Number) {
      return ((Number)input).doubleValue();
    }
    throw new RuntimeException(&quot;Cannot convert to double: &quot;  + className(input));
  }

  /**
   * get the double value of an object, do not throw an
   * exception if there is an
   * error
   *
   * @param input
   *          is a number or String
   *
   * @return the double equivalent
   */
  public static double doubleValueNoError(Object input) {
    if (input == null || (input instanceof String
        &amp;&amp; isBlank((String)input))) {
      return NOT_FOUND;
    }

    try {
      return doubleValue(input);
    } catch (Exception e) {
      //no need to log here
    }

    return NOT_FOUND;
  }

  /**
   * get the Float value of an object
   *
   * @param input
   *          is a number or String
   * @param allowNullBlank true if allow null or blank
   *
   * @return the Float equivalent
   */
  public static Float floatObjectValue(Object input, boolean allowNullBlank) {

    if (input instanceof Float) {
      return (Float) input;
    }

    if (allowNullBlank &amp;&amp; isBlank(input)) {
      return null;
    }
    return Float.valueOf(floatValue(input));
  }

  /**
   * get the float value of an object
   *
   * @param input
   *          is a number or String
   *
   * @return the float equivalent
   */
  public static float floatValue(Object input) {
    if (input instanceof String) {
      String string = (String)input;
      return Float.parseFloat(string);
    }
    if (input instanceof Number) {
      return ((Number)input).floatValue();
    }
    throw new RuntimeException(&quot;Cannot convert to float: &quot; + className(input));
  }

  /**
   * get the float value of an object, do not throw an exception if there is an
   * error
   *
   * @param input
   *          is a number or String
   *
   * @return the float equivalent
   */
  public static float floatValueNoError(Object input) {
    if (input == null || (input instanceof String
        &amp;&amp; isBlank((String)input))) {
      return NOT_FOUND;
    }
    try {
      return floatValue(input);
    } catch (Exception e) {
      LOG.error(e);
    }

    return NOT_FOUND;
  }

  /**
   * get the Integer value of an object
   *
   * @param input
   *          is a number or String
   * @param allowNullBlank true if convert null or blank to null
   *
   * @return the Integer equivalent
   */
  public static Integer intObjectValue(Object input, boolean allowNullBlank) {

    if (input instanceof Integer) {
      return (Integer) input;
    }

    if (allowNullBlank &amp;&amp; isBlank(input)) {
      return null;
    }

    return Integer.valueOf(intValue(input));
  }

  /**
   * convert an object to a int
   * @param input
   * @return the number
   */
  public static int intValue(Object input) {
    if (input instanceof String) {
      String string = (String)input;
      return Integer.parseInt(string);
    }
    if (input instanceof Number) {
      return ((Number)input).intValue();
    }
    throw new RuntimeException(&quot;Cannot convert to int: &quot; + className(input));
  }

  /**
   * convert an object to a int
   * @param input
   * @param valueIfNull is if the input is null or empty, return this value
   * @return the number
   */
  public static int intValue(Object input, int valueIfNull) {
    if (input == null || &quot;&quot;.equals(input)) {
      return valueIfNull;
    }
    return intObjectValue(input, false);
  }

  /**
   * get the int value of an object, do not throw an exception if there is an
   * error
   *
   * @param input
   *          is a number or String
   *
   * @return the int equivalent
   */
  public static int intValueNoError(Object input) {
    if (input == null || (input instanceof String
        &amp;&amp; isBlank((String)input))) {
      return NOT_FOUND;
    }
    try {
      return intValue(input);
    } catch (Exception e) {
      //no need to log here
    }

    return NOT_FOUND;
  }

  /** special number when a number is not found */
  public static final int NOT_FOUND = -999999999;

  /**
   * logger
   */
  private static final Log LOG = getLog(GrouperUtil.class);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\audit\AuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditEntry.html#L424">424</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditEntry.html#L181">181</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  private String id;
  
  /** foreign key to the type of audit entry this is */
  private String auditTypeId;

  /** env label from grouper.properties */
  private String envName;
  
  /** WS, UI, loader, GSH, etc */
  private String grouperEngine;
  
  /** version of the grouper API, e.g. 1.4.0 */
  private String grouperVersion;
  
  /**
   * member uuid of the user being acted as. 
   */
  private String actAsMemberId;

  /**
   * context id ties multiple db changes  
   */
  private String contextId;

  /**
   * member uuid of the user logged in to grouper ui or ws etc
   */
  private String loggedInMemberId;

  /**
   * host of the server that executed the transaction
   */
  private String serverHost;

  /**
   * ip address of user (from WS or UI etc)
   */
  private String userIpAddress;

  /**
   * Username of the OS user running the API.  This might identify who ran a GSH call
   */
  private String serverUserName;
  
  /**
   * number of microseconds that the duration of the context took
   */
  private long durationMicroseconds;
  
  /**
   * number of queries (count be db or otherwise)
   */
  private int queryCount;
  
  /**
   * description of what happened in paragraph form
   */
  private String description;
  
  /**
   * misc field 1
   */
  private String string01;
  
  /**
   * misc field 2
   */
  private String string02;
  
  /**
   * misc field 3
   */
  private String string03;
  
  /**
   * misc field 4
   */
  private String string04;
  
  /**
   * misc field 5
   */
  private String string05;
  
  /**
   * misc field 6
   */
  private String string06;
  
  /**
   * misc field 7
   */
  private String string07;
  
  /**
   * misc field 8
   */
  private String string08;

  /**
   * misc int field 1
   */
  private Long int01;
  
  /**
   * misc int field 2
   */
  private Long int02;
  
  /**
   * misc int field 3
   */
  private Long int03;
  
  /**
   * misc int field 4
   */
  private Long int04;
  
  /**
   * misc int field 5
   */
  private Long int05;

  /**
   * when this record was created 
   */
  private Long createdOnDb;

  /**
   * when this record was last updated 
   */
  private Long lastUpdatedDb;
  
  /**
   * foreign key to the type of audit entry this is
   * @return the audit type id
   */
  public String getAuditTypeId() {
    return this.auditTypeId;
  }

  /**
   * foreign key to the type of audit entry this is
   * @param auditTypeId1
   */
  public void setAuditTypeId(String auditTypeId1) {
    this.auditTypeId = auditTypeId1;
  }

  /**
   * primary key uuid of this record
   * @return the id
   */
  public String getId() {
    return this.id;
  }

  /**
   * primary key uuid of this record
   * @param id1
   */
  public void setId(String id1) {
    this.id = id1;
  }

  /**
   * member uuid of the user being acted as
   * @return uuid
   */
  public String getActAsMemberId() {
    return this.actAsMemberId;
  }

  /**
   * context id ties multiple db changes
   * @return id
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * member uuid of the user logged in to grouper ui or ws etc
   * @return uuid
   */
  public String getLoggedInMemberId() {
    return this.loggedInMemberId;
  }

  /**
   * host of the server that executed the transaction
   * @return host
   */
  public String getServerHost() {
    return this.serverHost;
  }

  /**
   * ip address of user (from WS or UI etc)
   * @return user ip address
   */
  public String getUserIpAddress() {
    return this.userIpAddress;
  }

  /**
   * member uuid of the user being acted as
   * @param actAsMemberUuid1
   */
  public void setActAsMemberId(String actAsMemberUuid1) {
    this.actAsMemberId = actAsMemberUuid1;
  }

  /**
   * context id ties multiple db changes
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }

  /**
   * member uuid of the user logged in to grouper ui or ws etc
   * @param loggedInMemberUuid
   */
  public void setLoggedInMemberId(String loggedInMemberUuid) {
    this.loggedInMemberId = loggedInMemberUuid;
  }

  /**
   * host of the server that executed the transaction
   * @param serverHost1
   */
  public void setServerHost(String serverHost1) {
    this.serverHost = serverHost1;
  }

  /**
   * ip address of user (from WS or UI etc)
   * @param userIpAddress1
   */
  public void setUserIpAddress(String userIpAddress1) {
    this.userIpAddress = userIpAddress1;
  }

  /**
   * env label from grouper.properties
   * @return env label
   */
  public String getEnvName() {
    return this.envName;
  }

  /**
   * env label from grouper.properties
   * @param envLabel1
   */
  public void setEnvName(String envLabel1) {
    this.envName = envLabel1;
  }

  /**
   * WS, UI, loader, GSH, etc
   * @return grouper system
   */
  public String getGrouperEngine() {
    return this.grouperEngine;
  }

  /**
   * WS, UI, loader, GSH, etc
   * @param grouperSystem1
   */
  public void setGrouperEngine(String grouperSystem1) {
    this.grouperEngine = grouperSystem1;
  }

  /**
   * misc field 1
   * @return field
   */
  public String getString01() {
    return this.string01;
  }

  /**
   * misc field 1
   * @param string01a
   */
  public void setString01(String string01a) {
    this.string01 = string01a;
  }

  /**
   * misc field 2
   * @return field
   */
  public String getString02() {
    return this.string02;
  }

  /**
   * misc field 2
   * @param string02a
   */
  public void setString02(String string02a) {
    this.string02 = string02a;
  }

  /**
   * misc field 3
   * @return field
   */
  public String getString03() {
    return this.string03;
  }

  /**
   * misc field 3
   * @param string03a
   */
  public void setString03(String string03a) {
    this.string03 = string03a;
  }

  /**
   * misc field 4
   * @return field
   */
  public String getString04() {
    return this.string04;
  }

  /**
   * misc field 4
   * @param string04a
   */
  public void setString04(String string04a) {
    this.string04 = string04a;
  }

  /**
   * misc field 5
   * @return field
   */
  public String getString05() {
    return this.string05;
  }

  /**
   * misc field 5
   * @param string05a
   */
  public void setString05(String string05a) {
    this.string05 = string05a;
  }

  /**
   * misc field 6
   * @return field
   */
  public String getString06() {
    return this.string06;
  }

  /**
   * misc field 6
   * @param string06a
   */
  public void setString06(String string06a) {
    this.string06 = string06a;
  }

  /**
   * misc field 7
   * @return field
   */
  public String getString07() {
    return this.string07;
  }

  /**
   * misc field 7
   * @param string07a
   */
  public void setString07(String string07a) {
    this.string07 = string07a;
  }

  /**
   * misc field 8
   * @return field
   */
  public String getString08() {
    return this.string08;
  }

  /**
   * misc field 8
   * @param string08a
   */
  public void setString08(String string08a) {
    this.string08 = string08a;
  }

  /**
   * misc integer field 1
   * @return field
   */
  public Long getInt01() {
    return this.int01;
  }

  /**
   * misc integer field 1
   * @param int01a
   */
  public void setInt01(Long int01a) {
    this.int01 = int01a;
  }

  /**
   * misc integer field 2
   * @return field
   */
  public Long getInt02() {
    return this.int02;
  }

  /**
   * misc integer field 2
   * @param int02a
   */
  public void setInt02(Long int02a) {
    this.int02 = int02a;
  }

  /**
   * misc integer field 3
   * @return field
   */
  public Long getInt03() {
    return this.int03;
  }

  /**
   * misc integer field 3
   * @param int03a
   */
  public void setInt03(Long int03a) {
    this.int03 = int03a;
  }

  /**
   * misc integer field 4
   * @return field
   */
  public Long getInt04() {
    return this.int04;
  }

  /**
   * misc integer field 4
   * @param int04a
   */
  public void setInt04(Long int04a) {
    this.int04 = int04a;
  }

  /**
   * misc integer field 5
   * @return field
   */
  public Long getInt05() {
    return this.int05;
  }

  /**
   * misc integer field 5
   * @param int05a
   */
  public void setInt05(Long int05a) {
    this.int05 = int05a;
  }

  /**
   * description of what happened in paragraph form
   * @return description
   */
  public String getDescription() {
    return this.description;
  }

  /**
   * description of what happened in paragraph form
   * @param description1
   */
  public void setDescription(String description1) {
    this.description = description1;
  }

  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * make sure this object will fit in the DB
   */
  public void truncate() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L2620">2620</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L1301">1301</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public static Iterator iterator(Object collection) {
    if (collection == null) {
      return null;
    }
    // array list doesnt need an iterator
    if (collection instanceof Collection
        &amp;&amp; !(collection instanceof ArrayList)) {
      return ((Collection) collection).iterator();
    }
    return null;
  }

  /**
   * Null safe array length or map
   *
   * @param arrayOrCollection
   * @return the length of the array (0 for null)
   */
  public static int length(Object arrayOrCollection) {
    if (arrayOrCollection == null) {
      return 0;
    }
    if (arrayOrCollection.getClass().isArray()) {
      return Array.getLength(arrayOrCollection);
    }
    if (arrayOrCollection instanceof Collection) {
      return ((Collection) arrayOrCollection).size();
    }
    if (arrayOrCollection instanceof Map) {
      return ((Map) arrayOrCollection).size();
    }
    // simple non array non collection object
    return 1;
  }

  /**
   * If array, get the element based on index, if Collection, get it based on
   * iterator.
   *
   * @param arrayOrCollection
   * @param iterator
   * @param index
   * @return the object
   */
  public static Object next(Object arrayOrCollection, Iterator iterator,
      int index) {
    if (arrayOrCollection.getClass().isArray()) {
      return Array.get(arrayOrCollection, index);
    }
    if (arrayOrCollection instanceof ArrayList) {
      return ((ArrayList) arrayOrCollection).get(index);
    }
    if (arrayOrCollection instanceof Collection) {
      return iterator.next();
    }
    // simple object
    if (0 == index) {
      return arrayOrCollection;
    }
    throw new RuntimeException(&quot;Invalid class type: &quot;
        + arrayOrCollection.getClass().getName());
  }

  /**
   * Remove the iterator or index
   *
   * @param arrayOrCollection
   * @param index
   * @return the object list or new array
   */
  public static Object remove(Object arrayOrCollection,
      int index) {
    return remove(arrayOrCollection, null, index);
  }

  /**
   * Remove the iterator or index
   *
   * @param arrayOrCollection
   * @param iterator
   * @param index
   * @return the object list or new array
   */
  public static Object remove(Object arrayOrCollection, Iterator iterator,
      int index) {

    //if theres an iterator, just use that
    if (iterator != null) {
      iterator.remove();
      return arrayOrCollection;
    }
    if (arrayOrCollection.getClass().isArray()) {
      int newLength = Array.getLength(arrayOrCollection) - 1;
      Object newArray = Array.newInstance(arrayOrCollection.getClass().getComponentType(), newLength);
      if (newLength == 0) {
        return newArray;
      }
      if (index &gt; 0) {
        System.arraycopy(arrayOrCollection, 0, newArray, 0, index);
      }
      if (index &lt; newLength) {
        System.arraycopy(arrayOrCollection, index+1, newArray, index, newLength - index);
      }
      return newArray;
    }
    if (arrayOrCollection instanceof List) {
      ((List)arrayOrCollection).remove(index);
      return arrayOrCollection;
    } else if (arrayOrCollection instanceof Collection) {
      //this should work unless there are duplicates or something weird
      ((Collection)arrayOrCollection).remove(get(arrayOrCollection, index));
      return arrayOrCollection;
    }
    throw new RuntimeException(&quot;Invalid class type: &quot;
        + arrayOrCollection.getClass().getName());
  }

  /**
   * print the simple names of a list of classes
   * @param object
   * @return the simple names
   */
  public static String classesString(Object object) {
    StringBuilder result = new StringBuilder();
    if (object.getClass().isArray()) {
      int length = Array.getLength(object);
      for (int i=0;i&lt;length;i++) {
        result.append(((Class)Array.get(object, i)).getSimpleName());
        if (i &lt; length-1) {
          result.append(&quot;, &quot;);
        }
      }
      return result.toString();
    }

    throw new RuntimeException(&quot;Not implemented: &quot; + className(object));
  }

  /**
   * null safe classname method, max out at 20
   *
   * @param object
   * @return the classname
   */
  public static String classNameCollection(Object object) {
    if (object == null) {
      return null;
    }
    StringBuffer result = new StringBuffer();

    Iterator iterator = iterator(object);
    int length = length(object);
    for (int i = 0; i &lt; length &amp;&amp; i &lt; 20; i++) {
      result.append(className(next(object, iterator, i)));
      if (i != length - 1) {
        result.append(&quot;, &quot;);
      }
    }
    return result.toString();
  }

  /**
   * null safe classname method, gets the unenhanced name
   *
   * @param object
   * @return the classname
   */
  public static String className(Object object) {
    return object == null ? null : unenhanceClass(object.getClass())
        .getName();
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L1290">1290</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L469">469</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    return GrouperUtil.class.getClassLoader();
  }

  /**
   * make sure a array is non null.  If null, then return an empty array.
   * @param &lt;T&gt;
   * @param array
   * @param theClass to make array from
   * @return the list or empty list if null
   */
  @SuppressWarnings({ &quot;unchecked&quot;, &quot;cast&quot; })
  public static &lt;T&gt; T[] nonNull(T[] array, Class&lt;?&gt; theClass) {
    if (int.class.equals(theClass)) {
      return (T[])(Object)new int[0];
    }
    if (float.class.equals(theClass)) {
      return (T[])(Object)new float[0];
    }
    if (double.class.equals(theClass)) {
      return (T[])(Object)new double[0];
    }
    if (short.class.equals(theClass)) {
      return (T[])(Object)new short[0];
    }
    if (long.class.equals(theClass)) {
      return (T[])(Object)new long[0];
    }
    if (byte.class.equals(theClass)) {
      return (T[])(Object)new byte[0];
    }
    if (boolean.class.equals(theClass)) {
      return (T[])(Object)new boolean[0];
    }
    if (char.class.equals(theClass)) {
      return (T[])(Object)new char[0];
    }
    return array == null ? ((T[])Array.newInstance(theClass, 0)) : array;
  }

  /**
   * strip the suffix off
   * @param string
   * @param suffix
   * @return the string without the suffix
   */
  public static String stripSuffix(String string, String suffix) {
    if (string == null || suffix == null) {
      return string;
    }
    if (string.endsWith(suffix)) {
      return string.substring(0, string.length() - suffix.length());
    }
    return string;
  }

  /**
   * get the prefix or suffix of a string based on a separator
   *
   * @param startString
   *          is the string to start with
   * @param separator
   *          is the separator to split on
   * @param isPrefix
   *          if thre prefix or suffix should be returned
   *
   * @return the prefix or suffix, if the separator isnt there, return the
   *         original string
   */
  public static String prefixOrSuffix(String startString, String separator,
      boolean isPrefix) {
    String prefixOrSuffix = null;

    //no nulls
    if (startString == null) {
      return startString;
    }

    //where is the separator
    int separatorIndex = startString.indexOf(separator);

    //if none exists, dont proceed
    if (separatorIndex == -1) {
      return startString;
    }

    //maybe the separator isnt on character
    int separatorLength = separator.length();

    if (isPrefix) {
      prefixOrSuffix = startString.substring(0, separatorIndex);
    } else {
      prefixOrSuffix = startString.substring(separatorIndex + separatorLength,
          startString.length());
    }

    return prefixOrSuffix;
  }

  /**
   * &lt;pre&gt;
   * this method will indent xml or json.
   * this is for logging or documentations purposes only and should
   * not be used for a production use (since it is not 100% tested
   * or compliant with all constructs like xml CDATA
   *
   * For xml, assumes elements either have text or sub elements, not both.
   * No cdata, nothing fancy.
   *
   * If the input is &amp;lt;a&amp;gt;&amp;lt;b&amp;gt;&amp;lt;c&amp;gt;hey&amp;lt;/c&amp;gt;&amp;lt;d&amp;gt;&amp;lt;e&amp;gt;there&amp;lt;/e&amp;gt;&amp;lt;/d&amp;gt;&amp;lt;/b&amp;gt;&amp;lt;/a&amp;gt;
   * It would output:
   * &amp;lt;a&amp;gt;
   *   &amp;lt;b&amp;gt;
   *     &amp;lt;c&amp;gt;hey&amp;lt;/c&amp;gt;
   *     &amp;lt;d&amp;gt;
   *       &amp;lt;e&amp;gt;there&amp;lt;/e&amp;gt;
   *     &amp;lt;/d&amp;gt;
   *   &amp;lt;/b&amp;gt;
   * &amp;lt;/a&amp;gt;
   *
   * For , if the input is: {&quot;a&quot;:{&quot;b\&quot;b&quot;:{&quot;c\\&quot;:&quot;d&quot;},&quot;e&quot;:&quot;f&quot;,&quot;g&quot;:[&quot;h&quot;:&quot;i&quot;]}}
   * It would output:
   * {
   *   &quot;a&quot;:{
   *     &quot;b\&quot;b&quot;:{
   *       &quot;c\\&quot;:&quot;d&quot;
   *     },
   *     &quot;e&quot;:&quot;f&quot;,
   *     &quot;g&quot;:[
   *       &quot;h&quot;:&quot;i&quot;
   *     ]
   *   }
   * }
   *
   *
   * &lt;pre&gt;
   * @param string
   * @param failIfTypeNotFound
   * @return the indented string, 2 spaces per line
   */
  public static String indent(String string, boolean failIfTypeNotFound) {
    if (string == null) {
      return null;
    }
    string = trim(string);
    if (string.startsWith(&quot;&lt;&quot;)) {
      //this is xml
      return new XmlIndenter(string).result();
    }
    if (string.startsWith(&quot;{&quot;)) {
      return new JsonIndenter(string).result();
    }
    if (!failIfTypeNotFound) {
      //just return if cant indent
      return string;
    }
    throw new RuntimeException(&quot;Cant find type of string: &quot; + string);
  }

  /**
   * convert an object to json.
   * @param object
   * @return the string of json
   */
  public static String jsonConvertTo(Object object) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignActionSet.html#L270">270</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefNameSet.html#L268">268</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITRoleSet.html#L269">269</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    GrouperDAOFactory.getFactory().getPITAttributeAssignActionSet().delete(this);
  }
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPreUpdate(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPreUpdate(HibernateSession hibernateSession) {
    super.onPreUpdate(hibernateSession);
    
    // add change log entry for permissions
    if (!this.isActive() &amp;&amp; this.dbVersion().isActive() &amp;&amp; this.getDepth() == 1 &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }
  }
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPostSave(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPostSave(HibernateSession hibernateSession) {
    
    // add change log entry for permissions
    if (this.isActive() &amp;&amp; this.getDepth() == 1 &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }
    
    super.onPostSave(hibernateSession);
  }

  
  /**
   * save the state when retrieving from DB
   * @return the dbVersion
   */
  @Override
  public PITAttributeAssignActionSet dbVersion() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1844">1844</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3353">3353</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public Set&lt;AttributeAssign&gt; findAssignmentsOnAssignmentsByIds(Collection&lt;String&gt; attributeAssignIds, 
      AttributeAssignType attributeAssignType, AttributeDefType attributeDefType, Boolean enabled) {

    int attributeAssignsSize = GrouperUtil.length(attributeAssignIds);

    Set&lt;AttributeAssign&gt; results = new LinkedHashSet&lt;AttributeAssign&gt;();
    
    if (attributeAssignsSize == 0) {
      return results;
    }
    
    //remove dupes
    Set&lt;String&gt; attributeAssignIdsSet = attributeAssignIds instanceof Set ? (Set)attributeAssignIds : new LinkedHashSet&lt;String&gt;(attributeAssignIds);
    
    //get in ordered list
    List&lt;String&gt; attributeAssignIdsList = new ArrayList&lt;String&gt;(attributeAssignIdsSet);
    
    attributeAssignsSize = GrouperUtil.length(attributeAssignIdsList);
    
    int numberOfBatches = GrouperUtil.batchNumberOfBatches(attributeAssignsSize, 100);

    int maxAssignments = GrouperConfig.retrieveConfig().propertyValueInt(&quot;ws.findAttrAssignments.maxResultSize&quot;, 30000);
    

    for (int i=0;i&lt;numberOfBatches; i++) {
      
      List&lt;String&gt; currentBatch = GrouperUtil.batchList(attributeAssignIdsList, 100, i);
      
      int currentBatchSize = GrouperUtil.length(currentBatch);
      
      ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic();

      String selectPrefix = &quot;select distinct aa &quot;;
      
      StringBuilder sqlTables = new StringBuilder(&quot; from AttributeAssign aa, AttributeDefName adn, AttributeDef ad &quot;);
      
      StringBuilder sqlWhereClause = new StringBuilder(
          &quot; aa.attributeDefNameId = adn.id and adn.attributeDefId = ad.id &quot;);
      
      if (attributeAssignType != null) {
        sqlWhereClause.append(&quot; and aa.attributeAssignTypeDb = '&quot; + attributeAssignType.name() + &quot;' &quot;);
      }
      
      GrouperSession grouperSession = GrouperSession.staticGrouperSession();
      
      Subject grouperSessionSubject = grouperSession.getSubject();
      
      grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
        grouperSessionSubject, byHqlStatic, 
        sqlTables, sqlWhereClause, &quot;adn.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
      
      StringBuilder sql;
      sql = sqlTables.append(&quot; where &quot;).append(sqlWhereClause);
      
      if (attributeDefType != null) {
        sql.append(&quot; and ad.attributeDefTypeDb = :theAttributeDefType &quot;);
        byHqlStatic.setString(&quot;theAttributeDefType&quot;, attributeDefType.name());
      }
      if (enabled != null &amp;&amp; enabled) {
        sql.append(&quot; and aa.enabledDb = 'T' &quot;);
      }
      if (enabled != null &amp;&amp; !enabled) {
        sql.append(&quot; and aa.enabledDb = 'F' &quot;);
      }
      if (currentBatchSize &gt; 0) {
        
        sql.append(&quot; and aa.ownerAttributeAssignId in (&quot;);
        sql.append(HibUtils.convertToInClause(currentBatch, byHqlStatic));
        sql.append(&quot;) &quot;);
      }
      
      byHqlStatic
        .setCacheable(false)
        .setCacheRegion(KLASS + &quot;.FindAssignmentsOnAssignments&quot;);

      //if -1, lets not check
      Set&lt;AttributeAssign&gt; tempResults = byHqlStatic.createQuery(selectPrefix + sql.toString()).listSet(AttributeAssign.class);

      //nothing to filter
      if (GrouperUtil.length(tempResults) &gt; 0) {
        //if the hql didnt filter, we need to do that here
        tempResults = grouperSession.getAttributeDefResolver().postHqlFilterAttributeAssigns(grouperSessionSubject, tempResults);
      }
      
      results.addAll(tempResults);
      
      if (maxAssignments &gt;= 0) {

        //see if too many
        if (results.size() &gt; maxAssignments) {
          throw new RuntimeException(&quot;Too many results: &quot; + results.size());
        }
        
      }
    }
    
    
    //we should be down to the secure list
    return results;

    
  }

  /**
   * @see edu.internet2.middleware.grouper.internal.dao.AttributeAssignDAO#findAttributeDefsByAttributeDefNameId(java.lang.String)
   */
  public Set&lt;AttributeDef&gt; findAttributeDefsByAttributeDefNameId(</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L6430">6430</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L3132">3132</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  private static final Log LOG = getLog(GrouperUtil.class);

  /**
   * The name says it all.
   */
  public static final int DEFAULT_BUFFER_SIZE = 1024 * 4;

  /**
   * get the Long value of an object
   *
   * @param input
   *          is a number or String
   * @param allowNullBlank true if null or blank converts to null
   *
   * @return the Long equivalent
   */
  public static Long longObjectValue(Object input, boolean allowNullBlank) {

    if (input instanceof Long) {
      return (Long) input;
    }

    if (allowNullBlank &amp;&amp; isBlank(input)) {
      return null;
    }

    return Long.valueOf(longValue(input));
  }

  /**
   * convert an object to a long
   * @param input
   * @return the number
   */
  public static long longValue(Object input) {
    if (input instanceof String) {
      String string = (String)input;
      return Long.parseLong(string);
    }
    if (input instanceof Number) {
      return ((Number)input).longValue();
    }
    throw new RuntimeException(&quot;Cannot convert to long: &quot; + className(input));
  }

  /**
   * convert an object to a long
   * @param input
   * @param valueIfNull is if the input is null or empty, return this value
   * @return the number
   */
  public static long longValue(Object input, long valueIfNull) {
    if (input == null || &quot;&quot;.equals(input)) {
      return valueIfNull;
    }
    return longObjectValue(input, false);
  }

  /**
   * get the long value of an object, do not throw an exception if there is an
   * error
   *
   * @param input
   *          is a number or String
   *
   * @return the long equivalent
   */
  public static long longValueNoError(Object input) {
    if (input == null || (input instanceof String
        &amp;&amp; isBlank((String)input))) {
      return NOT_FOUND;
    }
    try {
      return longValue(input);
    } catch (Exception e) {
      //no need to log here
    }

    return NOT_FOUND;
  }

  /**
   * get the Short value of an object.  converts null or blank to null
   *
   * @param input
   *          is a number or String
   *
   * @return the Long equivalent
   */
  public static Short shortObjectValue(Object input) {

    if (input instanceof Short) {
      return (Short) input;
    }

    if (isBlank(input)) {
      return null;
    }

    return Short.valueOf(shortValue(input));
  }

  /**
   * convert an object to a short
   * @param input
   * @return the number
   */
  public static short shortValue(Object input) {
    if (input instanceof String) {
      String string = (String)input;
      return Short.parseShort(string);
    }
    if (input instanceof Number) {
      return ((Number)input).shortValue();
    }
    throw new RuntimeException(&quot;Cannot convert to short: &quot; + className(input));
  }

  /**
   * get the Character wrapper value for the input
   * @param input allow null, return null
   * @return the Character object wrapper
   */
  public static Character charObjectValue(Object input) {
    if (input instanceof Character) {
      return (Character) input;
    }
    if (isBlank(input)) {
      return null;
    }
    return new Character(charValue(input));
  }

  /**
   * convert an object to a char
   * @param input
   * @return the number
   */
  public static char charValue(Object input) {
    if (input instanceof Character) {
      return ((Character) input).charValue();
    }
    //if string length 1, thats ok
    if (input instanceof String) {
      String inputString = (String) input;
      if (inputString.length() == 1) {
        return inputString.charAt(0);
      }
    }
    throw new RuntimeException(&quot;Cannot convert to char: &quot;
        + (input == null ? null : (input.getClass() + &quot;, &quot; + input)));
  }

  /**
   * Create the parent directories for a file if they do not already exist
   * @param file
   */
  public static void createParentDirectories(File file) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L6881">6881</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L3295">3295</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * this method takes a long (less than 62) and converts it to a 1 character
   * string (a-z, A-Z, 0-9)
   *
   * @param theLong
   *          is the long (less than 62) to convert to a 1 character string
   *
   * @return a one character string
   */
  public static String convertLongToChar(long theLong) {
    if ((theLong &lt; 0) || (theLong &gt;= 62)) {
      throw new RuntimeException(&quot;convertLongToChar() &quot;
          + &quot; invalid input (not &gt;=0 &amp;&amp; &lt;62: &quot; + theLong);
    } else if (theLong &lt; 26) {
      return &quot;&quot; + (char) ('a' + theLong);
    } else if (theLong &lt; 52) {
      return &quot;&quot; + (char) ('A' + (theLong - 26));
    } else {
      return &quot;&quot; + (char) ('0' + (theLong - 52));
    }
  }

  /**
   * this method takes a long (less than 36) and converts it to a 1 character
   * string (A-Z, 0-9)
   *
   * @param theLong
   *          is the long (less than 36) to convert to a 1 character string
   *
   * @return a one character string
   */
  public static String convertLongToCharSmall(long theLong) {
    if ((theLong &lt; 0) || (theLong &gt;= 36)) {
      throw new RuntimeException(&quot;convertLongToCharSmall() &quot;
          + &quot; invalid input (not &gt;=0 &amp;&amp; &lt;36: &quot; + theLong);
    } else if (theLong &lt; 26) {
      return &quot;&quot; + (char) ('A' + theLong);
    } else {
      return &quot;&quot; + (char) ('0' + (theLong - 26));
    }
  }

  /**
   * convert a long to a string by converting it to base 62 (26 lower, 26 upper,
   * 10 digits)
   *
   * @param theLong
   *          is the long to convert
   *
   * @return the String conversion of this
   */
  public static String convertLongToString(long theLong) {
    long quotient = theLong / 62;
    long remainder = theLong % 62;

    if (quotient == 0) {
      return convertLongToChar(remainder);
    }
    StringBuffer result = new StringBuffer();
    result.append(convertLongToString(quotient));
    result.append(convertLongToChar(remainder));

    return result.toString();
  }

  /**
   * convert a long to a string by converting it to base 36 (26 upper, 10
   * digits)
   *
   * @param theLong
   *          is the long to convert
   *
   * @return the String conversion of this
   */
  public static String convertLongToStringSmall(long theLong) {
    long quotient = theLong / 36;
    long remainder = theLong % 36;

    if (quotient == 0) {
      return convertLongToCharSmall(remainder);
    }
    StringBuffer result = new StringBuffer();
    result.append(convertLongToStringSmall(quotient));
    result.append(convertLongToCharSmall(remainder));

    return result.toString();
  }

  /**
   * increment a character (A-Z then 0-9)
   *
   * @param theChar
   *
   * @return the value
   */
  public static char incrementChar(char theChar) {
    if (theChar == 'Z') {
      return '0';
    }

    if (theChar == '9') {
      return 'A';
    }

    return ++theChar;
  }

  /**
   * Increment a string with A-Z and 0-9 (no lower case so case insensitive apps
   * like windows IE will still work)
   *
   * @param string
   *
   * @return the value
   */
  public static char[] incrementStringInt(char[] string) {
    if (string == null) {
      return string;
    }

    //loop through the string backwards
    int i = 0;

    for (i = string.length - 1; i &gt;= 0; i--) {
      char inc = string[i];
      inc = incrementChar(inc);
      string[i] = inc;

      if (inc != 'A') {
        break;
      }
    }

    //if we are at 0, then it means we hit AAAAAAA (or more)
    if (i &lt; 0) {
      return (&quot;A&quot; + new String(string)).toCharArray();
    }

    return string;
  }

  /**
   * read properties from a resource, dont modify the properties returned since they are cached
   * @param resourceName
   * @return the properties
   */
  public synchronized static Properties propertiesFromResourceName(String resourceName) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L11027">11027</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L5719">5719</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * see if an ip address is on a network
   *
   * @param ipString
   *          is the ip address to check
   * @param networkIpString
   *          is the ip address of the network
   * @param mask
   *          is the length of the mask (0-32)
   * @return boolean
   */
  public static boolean ipOnNetwork(String ipString, String networkIpString, int mask) {

    //this allows all
    if (mask == 0) {
      return true;
    }
    int ip = ipInt(ipString);
    int networkIp = ipInt(networkIpString);

    ip = ipReadyForAnd(ip, mask);
    networkIp = ipReadyForAnd(networkIp, mask);

    return ip == networkIp;
  }

  /**
   * see if an ip address is on a network
   *
   * @param ipString
   *          is the ip address to check
   * @param networkIpStrings
   *          are the ip addresses of the networks, e.g. 1.2.3.4/12, 2.3.4.5/24
   * @return boolean
   */
  public static boolean ipOnNetworks(String ipString, String networkIpStrings) {

    String[] networkIpStringsArray = splitTrim(networkIpStrings, &quot;,&quot;);

    //check each one
    for (String networkIpString : networkIpStringsArray) {

      if (!contains(networkIpString, &quot;/&quot;)) {
        throw new RuntimeException(&quot;String must contain slash and CIDR network bits, e.g. 1.2.3.4/14&quot;);
      }
      //get network part:
      String network = prefixOrSuffix(networkIpString, &quot;/&quot;, true);
      network = trim(network);

      String mask = prefixOrSuffix(networkIpString, &quot;/&quot;, false);
      mask = trim(mask);
      int maskInt = -1;

      maskInt = Integer.parseInt(mask);

      //if on the network, then all good
      if (ipOnNetwork(ipString, network, maskInt)) {
        return true;
      }


    }
    return false;
  }

  /**
   * get the ip address after putting 1's where the subnet mask is not
   * @param ip int
   * @param maskLength int
   * @return int
   */
  public static int ipReadyForAnd(int ip, int maskLength) {
    int mask = -1 + (int) Math.pow(2, 32 - maskLength);

    return ip | mask;
  }

  /**
   * get the ip addres integer from a string ip address
   * @param ip String
   * @return int
   */
  public static int ipInt(String ip) {
    int block1;
    int block2;
    int block3;
    int block4;

    try {
      int periodIndex = ip.indexOf('.');
      String blockString = ip.substring(0, periodIndex);
      block1 = Integer.parseInt(blockString);

      //split it up for 2^24 since it does the math wrong if you dont
      int mathPow = (int) Math.pow(2, 24);
      block1 *= mathPow;

      int oldPeriodIndex = periodIndex;

      periodIndex = ip.indexOf('.', periodIndex + 1);
      blockString = ip.substring(oldPeriodIndex + 1, periodIndex);
      block2 = Integer.parseInt(blockString);
      block2 *= Math.pow(2, 16);
      oldPeriodIndex = periodIndex;

      periodIndex = ip.indexOf('.', periodIndex + 1);
      blockString = ip.substring(oldPeriodIndex + 1, periodIndex);
      block3 = Integer.parseInt(blockString);
      block3 *= Math.pow(2, 8);

      blockString = ip.substring(periodIndex + 1, ip.length());
      block4 = Integer.parseInt(blockString);
    } catch (NumberFormatException nfe) {
      throw new RuntimeException(&quot;Could not parse the ipaddress: &quot; + ip);
    }

    return block1 + block2 + block3 + block4;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L362">362</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L203">203</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    return HibUtils.convertSourcesToSqlInString(sources);
  }

  /**
   * turn some strings into a map
   * @param strings
   * @return the map (never null)
   */
  public static Map&lt;String, String&gt; toMap(String... strings) {
    Map&lt;String, String&gt; map = new LinkedHashMap&lt;String, String&gt;();
    if (strings != null) {
      if (strings.length % 2 != 0) {
        throw new RuntimeException(&quot;Must pass in an even number of strings: &quot; + strings.length);
      }
      for (int i=0;i&lt;strings.length;i+=2) {
        map.put(strings[i], strings[i+1]);
      }
    }
    return map;
  }

  /**
   * turn some strings into a map
   * @param stringObjects is an array of String,Object,String,Object etc where the
   * Strings are the key, and the Object is the value
   * @return the map (never null)
   */
  public static Map&lt;String, Object&gt; toStringObjectMap(Object... stringObjects) {
    Map&lt;String, Object&gt; map = new LinkedHashMap&lt;String, Object&gt;();
    if (stringObjects != null) {
      if (stringObjects.length % 2 != 0) {
        throw new RuntimeException(&quot;Must pass in an even number of strings: &quot; + stringObjects.length);
      }
      for (int i=0;i&lt;stringObjects.length;i+=2) {
        String key = (String)stringObjects[i];
        map.put(key, stringObjects[i+1]);
      }
    }
    return map;
  }

  /**
   * convert millis to friendly string
   * @param duration
   * @return the friendly string
   */
  public static String convertMillisToFriendlyString(Integer duration) {
    if (duration == null) {
      return convertMillisToFriendlyString((Long)null);
    }
    return convertMillisToFriendlyString(new Long(duration.intValue()));
  }

  /**
   * convert millis to friendly string
   * @param duration
   * @return the friendly string
   */
  public static String convertMillisToFriendlyString(Long duration) {

    if (duration == null) {
      return &quot;&quot;;
    }

    if (duration &lt; 1000) {
      return duration + &quot;ms&quot;;
    }

    long ms = duration % 1000;
    duration = duration / 1000;
    long s = duration % 60;
    duration = duration / 60;

    if (duration == 0) {
      return s + &quot;s, &quot; + ms + &quot;ms&quot;;
    }

    long m = duration % 60;
    duration = duration / 60;

    if (duration == 0) {
      return m + &quot;m, &quot; + s + &quot;s, &quot; + ms + &quot;ms&quot;;
    }

    long h = duration % 24;
    duration = duration / 24;

    if (duration == 0) {
      return h + &quot;h, &quot; + m + &quot;m, &quot; + s + &quot;s, &quot; + ms + &quot;ms&quot;;
    }

    long d = duration;

    return d + &quot;d, &quot; + h + &quot;h, &quot; + m + &quot;m, &quot; + s + &quot;s, &quot; + ms + &quot;ms&quot;;
  }

  /**
   * Delete a file, throw exception if cannot
   * @param file
   */
  public static void deleteFile(File file) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L443">443</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogType.html#L496">496</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * action within the audit category
   * @return the action name
   */
  public String getActionName() {
    return this.actionName;
  }

  /**
   * action within the audit category
   * @param actionName
   */
  public void setActionName(String actionName) {
    this.actionName = actionName;
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }

  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }

  /**
   * 
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPreSave(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPreSave(HibernateSession hibernateSession) {
    super.onPreSave(hibernateSession);
    if (this.createdOnDb == null) {
      this.createdOnDb = System.currentTimeMillis();
    }
    if (this.lastUpdatedDb == null) {
      this.lastUpdatedDb = System.currentTimeMillis();
    }
  }

  /**
   * 
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPreUpdate(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPreUpdate(HibernateSession hibernateSession) {
    super.onPreUpdate(hibernateSession);
    this.lastUpdatedDb = System.currentTimeMillis();
  }

  /**
   * label for string01
   * @return label
   */
  public String getLabelString01() {
    return this.labelString01;
  }

  /**
   * label for string01
   * @param labelString01a
   */
  public void setLabelString01(String labelString01a) {
    this.labelString01 = labelString01a;
  }

  /**
   * label for string02
   * @return label
   */
  public String getLabelString02() {
    return this.labelString02;
  }

  /**
   * label for string02
   * @param labelString02a
   */
  public void setLabelString02(String labelString02a) {
    this.labelString02 = labelString02a;
  }

  /**
   * label for string03
   * @return label
   */
  public String getLabelString03() {
    return this.labelString03;
  }

  /**
   * label for string03
   * @param labelString03a
   */
  public void setLabelString03(String labelString03a) {
    this.labelString03 = labelString03a;
  }

  /**
   * label for string04
   * @return label
   */
  public String getLabelString04() {
    return this.labelString04;
  }

  /**
   * label for string04
   * @param labelString04a
   */
  public void setLabelString04(String labelString04a) {
    this.labelString04 = labelString04a;
  }

  /**
   * label for string05
   * @return label
   */
  public String getLabelString05() {
    return this.labelString05;
  }

  /**
   * label for string05
   * @param labelString05a
   */
  public void setLabelString05(String labelString05a) {
    this.labelString05 = labelString05a;
  }

  /**
   * context id ties multiple db changes
   * @return id
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * context id ties multiple db changes
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }

  /**
   * label for int01
   * @return label
   */
  public String getLabelInt01() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\SyncPITTables.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/SyncPITTables.html#L723">723</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\SyncPITTables.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/SyncPITTables.html#L827">827</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          pitGroupSet.setParentId(groupSet.getDepth() == 0 ? pitGroupSet.getId() : pitParent.getId());
          pitGroupSet.setFieldId(pitField.getId());
          pitGroupSet.setMemberFieldId(pitMemberField.getId());
          pitGroupSet.setActiveDb(&quot;T&quot;);
          pitGroupSet.setStartTimeDb(System.currentTimeMillis() * 1000);

          if (groupSet.getOwnerGroupId() != null) {
            PITGroup pitOwner = GrouperDAOFactory.getFactory().getPITGroup().findBySourceIdActive(groupSet.getOwnerId(), true);
            pitGroupSet.setOwnerGroupId(pitOwner.getId());
          } else if (groupSet.getOwnerStemId() != null) {
            PITStem pitOwner = GrouperDAOFactory.getFactory().getPITStem().findBySourceIdActive(groupSet.getOwnerId(), true);
            pitGroupSet.setOwnerStemId(pitOwner.getId());
          } else if (groupSet.getOwnerAttrDefId() != null) {
            PITAttributeDef pitOwner = GrouperDAOFactory.getFactory().getPITAttributeDef().findBySourceIdActive(groupSet.getOwnerId(), true);
            pitGroupSet.setOwnerAttrDefId(pitOwner.getId());
          } else {
            throw new RuntimeException(&quot;Unexpected -- GroupSet with id &quot; + groupSet.getId() + &quot; does not have an ownerGroupId, ownerStemId, or ownerAttrDefId.&quot;);
          }
        
          if (groupSet.getMemberGroupId() != null) {
            PITGroup pitMember = GrouperDAOFactory.getFactory().getPITGroup().findBySourceIdActive(groupSet.getMemberId(), true);
            pitGroupSet.setMemberGroupId(pitMember.getId());
          } else if (groupSet.getMemberStemId() != null) {
            PITStem pitMember = GrouperDAOFactory.getFactory().getPITStem().findBySourceIdActive(groupSet.getMemberId(), true);
            pitGroupSet.setMemberStemId(pitMember.getId());
          } else if (groupSet.getMemberAttrDefId() != null) {
            PITAttributeDef pitMember = GrouperDAOFactory.getFactory().getPITAttributeDef().findBySourceIdActive(groupSet.getMemberId(), true);
            pitGroupSet.setMemberAttrDefId(pitMember.getId());
          } else {
            throw new RuntimeException(&quot;Unexpected -- GroupSet with id &quot; + groupSet.getId() + &quot; does not have an memberGroupId, memberStemId, or memberAttrDefId.&quot;);
          }
        
          if (!GrouperUtil.isEmpty(groupSet.getContextId())) {
            pitGroupSet.setContextId(groupSet.getContextId());
          }
        
          if (sendFlattenedNotifications) {
            pitGroupSet.setFlatMembershipNotificationsOnSaveOrUpdate(includeFlattenedMemberships);
            pitGroupSet.setFlatPrivilegeNotificationsOnSaveOrUpdate(includeFlattenedPrivileges);
          }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L2010">2010</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L914">914</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public static &lt;T&gt; List&lt;T&gt; batchList(List&lt;T&gt; collection, int batchSize,
      int batchIndex) {

    int numberOfBatches = batchNumberOfBatches(collection, batchSize);
    int arraySize = length(collection);

    // short circuit
    if (arraySize == 0) {
      return new ArrayList&lt;T&gt;();
    }

    List&lt;T&gt; theBatchObjects = new ArrayList&lt;T&gt;();

    // lets get the type of the first element if possible
//    Object first = get(arrayOrCollection, 0);
//
//    Class theType = first == null ? Object.class : first.getClass();

    // if last batch
    if (batchIndex == numberOfBatches - 1) {

      // needs to work to 1-n
      //int thisBatchSize = 1 + ((arraySize - 1) % batchSize);

      int collectionIndex = 0;
      for (T t : collection) {
        if (collectionIndex++ &lt; batchIndex * batchSize) {
          continue;
        }
        //just copy the rest
        //if (collectionIndex &gt;= (batchIndex * batchSize) + arraySize) {
        //  break;
        //}
        //we are in the copy mode
        theBatchObjects.add(t);
      }

    } else {
      // if non-last batch
      //int newIndex = 0;
      int collectionIndex = 0;
      for (T t : collection) {
        if (collectionIndex &lt; batchIndex * batchSize) {
          collectionIndex++;
          continue;
        }
        //done with batch
        if (collectionIndex &gt;= (batchIndex + 1) * batchSize) {
          break;
        }
        theBatchObjects.add(t);
        collectionIndex++;
      }
    }
    return theBatchObjects;
  }
  /**
   * split a string based on a separator into an array, and trim each entry (see
   * the Commons Util trim() for more details)
   *
   * @param input
   *          is the delimited input to split and trim
   * @param separator
   *          is what to split on
   *
   * @return the array of items after split and trimmed, or null if input is null.  will be trimmed to empty
   */
  public static String[] splitTrim(String input, String separator) {
    return splitTrim(input, separator, true);
  }

  /**
   * split a string based on a separator into an array, and trim each entry (see
   * the Commons Util trim() for more details)
   *
   * @param input
   *          is the delimited input to split and trim
   * @param separator
   *          is what to split on
   *
   * @return the list of items after split and trimmed, or null if input is null.  will be trimmed to empty
   */
  public static List&lt;String&gt; splitTrimToList(String input, String separator) {
    if (isBlank(input)) {
      return null;
    }
    String[] array =  splitTrim(input, separator);
    return toList(array);
  }

  /**
   * split a string based on a separator into an array, and trim each entry (see
   * the Commons Util trim() for more details)
   *
   * @param input
   *          is the delimited input to split and trim
   * @param separator
   *          is what to split on
   *
   * @return the set of items after split and trimmed, or null if input is null.  will be trimmed to empty
   */
  public static Set&lt;String&gt; splitTrimToSet(String input, String separator) {
    if (isBlank(input)) {
      return null;
    }
    String[] array =  splitTrim(input, separator);
    return toSet(array);
  }

  /**
   * split a string based on a separator into an array, and trim each entry (see
   * the Commons Util trim() for more details)
   *
   * @param input
   *          is the delimited input to split and trim
   * @param separator
   *          is what to split on
   * @param treatAdjacentSeparatorsAsOne
   * @return the array of items after split and trimmed, or null if input is null.  will be trimmed to empty
   */
  public static String[] splitTrim(String input, String separator, boolean treatAdjacentSeparatorsAsOne) {
    if (isBlank(input)) {
      return null;
    }

    //first split
    String[] items = treatAdjacentSeparatorsAsOne ? splitByWholeSeparator(input, separator) :
      split(input, separator);

    //then trim
    for (int i = 0; (items != null) &amp;&amp; (i &lt; items.length); i++) {
      items[i] = trim(items[i]);
    }

    //return the array
    return items;
  }

  /**
   * escape url chars (e.g. a # is %23)
   * @param string input
   * @return the encoded string
   */
  public static String escapeUrlEncode(String string) {
    String result = null;
    try {
      result = URLEncoder.encode(string, &quot;UTF-8&quot;);
    } catch (UnsupportedEncodingException ex) {
      throw new RuntimeException(&quot;UTF-8 not supported&quot;, ex);
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L435">435</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L579">579</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      Set&lt;PITGroupSet&gt; pitGroupSets = GrouperDAOFactory.getFactory().getPITMembershipView().findPITGroupSetsJoinedWithNewPITMembership(this);
      Iterator&lt;PITGroupSet&gt; iter = pitGroupSets.iterator();
      while (iter.hasNext()) {
        PITGroupSet pitGroupSet = iter.next();
        PITField pitField = GrouperDAOFactory.getFactory().getPITField().findById(pitGroupSet.getFieldId(), true);
        String ownerId = null;
        String ownerName = null;
        String privilegeName = null;
        String privilegeType = null;
        String ownerType = null;
        boolean isMembership = false;
        
        if (pitGroupSet.getOwnerGroupId() != null) {
          PITGroup pitGroup = GrouperDAOFactory.getFactory().getPITGroup().findById(pitGroupSet.getOwnerId(), true);
          ownerId = pitGroup.getSourceId();
          ownerName = pitGroup.getName();
          if (pitField.getType().equals(FieldType.LIST.getType())) {
            isMembership = true;
          } else {
            privilegeType = FieldType.ACCESS.getType();
            privilegeName = AccessPrivilege.listToPriv(pitField.getName()).getName();
            ownerType = Membership.OWNER_TYPE_GROUP;
          }
        } else if (pitGroupSet.getOwnerStemId() != null) {
          PITStem pitStem = GrouperDAOFactory.getFactory().getPITStem().findById(pitGroupSet.getOwnerId(), true);
          ownerId = pitStem.getSourceId();
          ownerName = pitStem.getName();
          privilegeType = FieldType.NAMING.getType();
          privilegeName = NamingPrivilege.listToPriv(pitField.getName()).getName();
          ownerType = Membership.OWNER_TYPE_STEM;
        } else if (pitGroupSet.getOwnerAttrDefId() != null) {
          PITAttributeDef pitAttributeDef = GrouperDAOFactory.getFactory().getPITAttributeDef().findById(pitGroupSet.getOwnerId(), true);
          ownerId = pitAttributeDef.getSourceId();
          ownerName = pitAttributeDef.getName();
          privilegeType = FieldType.ATTRIBUTE_DEF.getType();
          privilegeName = AttributeDefPrivilege.listToPriv(pitField.getName()).getName();
          ownerType = Membership.OWNER_TYPE_ATTRIBUTE_DEF;
        } else {
          throw new RuntimeException(&quot;Unable to determine owner of PIT Group Set: &quot; + pitGroupSet.getId());
        }
        
        ChangeLogEntry changeLogEntry = null;
        if (isMembership &amp;&amp; this.getFlatMembershipNotificationsOnSaveOrUpdate()) {
          changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.MEMBERSHIP_ADD,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L1829">1829</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L775">775</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * convert a set to a string (comma separate)
   * @param collection
   * @return the String
   */
  public static String collectionToString(Collection collection) {
    if (collection == null) {
      return &quot;null&quot;;
    }
    if (collection.size() == 0) {
      return &quot;empty&quot;;
    }
    StringBuilder result = new StringBuilder();
    boolean first = true;
    for (Object object : collection) {
      if (!first) {
        result.append(&quot;, &quot;);
      }
      first = false;
      result.append(object);
    }
    return result.toString();

  }
  /**
   * convert a set to a string (comma separate)
   * @param set
   * @return the String
   */
  public static String setToString(Set set) {
    return collectionToString(set);
  }

  /**
   * convert a set to a string (comma separate)
   * @param map
   * @return the String
   * @deprecated use mapToString(map)
   */
  @Deprecated
  public static String MapToString(Map map) {
    return mapToString(map);
  }

  /**
   * convert a set to a string (comma separate)
   * @param map
   * @return the String
   */
  public static String mapToString(Map map) {
    if (map == null) {
      return &quot;null&quot;;
    }
    if (map.size() == 0) {
      return &quot;empty&quot;;
    }
    StringBuilder result = new StringBuilder();
    boolean first = true;
    for (Object object : map.keySet()) {
      if (!first) {
        result.append(&quot;, &quot;);
      }
      first = false;
      result.append(object).append(&quot;: &quot;).append(map.get(object));
    }
    return result.toString();
  }

  /**
   * print out various types of objects
   *
   * @param object
   * @return the string value
   */
  public static String toStringForLog(Object object) {
    StringBuilder result = new StringBuilder();
    toStringForLogHelper(object, -1, result);
    return result.toString();
  }

  /**
   * print out various types of objects
   *
   * @param object
   * @param maxChars is the max chars that should be returned (abbreviate if longer), or -1 for any amount
   * @return the string value
   */
  public static String toStringForLog(Object object, int maxChars) {
    StringBuilder result = new StringBuilder();
    toStringForLogHelper(object, -1, result);
    String resultString = result.toString();
    if (maxChars != -1) {
      return abbreviate(resultString, maxChars);
    }
    return resultString;
  }

  /**
   * If batching this is the number of batches
   * @param count is size of set
   * @param batchSize
   * @return the number of batches
   */
  public static int batchNumberOfBatches(int count, int batchSize) {
    //not sure why this would be 0...
    if (batchSize == 0) {
      return 0;
    }
    int batches = 1 + ((count - 1) / batchSize);
    return batches;

  }

  /**
   * If batching this is the number of batches
   * @param collection
   * @param batchSize
   * @return the number of batches
   */
  public static int batchNumberOfBatches(Collection&lt;?&gt; collection, int batchSize) {
    int arrraySize = length(collection);
    return batchNumberOfBatches(arrraySize, batchSize);

  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITGroupSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroupSet.html#L523">523</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITGroupSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroupSet.html#L631">631</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      Set&lt;PITMembership&gt; pitMemberships = GrouperDAOFactory.getFactory().getPITMembershipView().findPITMembershipsJoinedWithNewPITGroupSet(this);
      
      if (pitMemberships.size() &gt; 0) {
        pitField = GrouperDAOFactory.getFactory().getPITField().findById(this.getFieldId(), true);
        if (this.getOwnerGroupId() != null) {
          PITGroup pitGroup = GrouperDAOFactory.getFactory().getPITGroup().findById(this.getOwnerId(), true);
          ownerId = pitGroup.getSourceId();
          ownerName = pitGroup.getName();
          if (pitField.getType().equals(FieldType.LIST.getType())) {
            isMembership = true;
          } else {
            privilegeType = FieldType.ACCESS.getType();
            privilegeName = AccessPrivilege.listToPriv(pitField.getName()).getName();
            ownerType = Membership.OWNER_TYPE_GROUP;
          }
        } else if (this.getOwnerStemId() != null) {
          PITStem pitStem = GrouperDAOFactory.getFactory().getPITStem().findById(this.getOwnerId(), true);
          ownerId = pitStem.getSourceId();
          ownerName = pitStem.getName();
          privilegeType = FieldType.NAMING.getType();
          privilegeName = NamingPrivilege.listToPriv(pitField.getName()).getName();
          ownerType = Membership.OWNER_TYPE_STEM;
        } else if (this.getOwnerAttrDefId() != null) {
          PITAttributeDef pitAttributeDef = GrouperDAOFactory.getFactory().getPITAttributeDef().findById(this.getOwnerId(), true);
          ownerId = pitAttributeDef.getSourceId();
          ownerName = pitAttributeDef.getName();
          privilegeType = FieldType.ATTRIBUTE_DEF.getType();
          privilegeName = AttributeDefPrivilege.listToPriv(pitField.getName()).getName();
          ownerType = Membership.OWNER_TYPE_ATTRIBUTE_DEF;
        } else {
          throw new RuntimeException(&quot;Unable to determine owner of PIT Group Set: &quot; + this.getId());
        }
      }
      
      Iterator&lt;PITMembership&gt; iter = pitMemberships.iterator();
      while (iter.hasNext()) {
        PITMembership pitMembership = iter.next();
        
        ChangeLogEntry changeLogEntry = null;
        
        if (isMembership &amp;&amp; this.getFlatMembershipNotificationsOnSaveOrUpdate()) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\MigrateLegacyAttributes.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/MigrateLegacyAttributes.html#L444">444</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\SyncStemSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/SyncStemSets.html#L285">285</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      GrouperSession.stopQuietly(grouperSession);
    }
  }
  
  private void showStatus(String message) {
    if (showResults) {
      System.out.println(message);
    }
  }
  
  private void logDetail(String detail) {
    if (logDetails) {
      LOG.info(detail);
    }
  }
  
  private void reset() {
    processedCount = 0;
    donePhase = false;
    startTime = System.currentTimeMillis();
    
    // status thread
    statusThread = new Thread(new Runnable() {
      
      public void run() {
        SimpleDateFormat estFormat = new SimpleDateFormat(&quot;HH:mm&quot;);
        SimpleDateFormat format = new SimpleDateFormat(&quot;HH:mm:ss&quot;);
        
        while (true) {

          // sleep 30 seconds between status messages
          for (int i = 0; i &lt; 30; i++) {
            
            if (donePhase) {
              return;
            }
            
            try {
              Thread.sleep(1000);
            } catch (InterruptedException ie) {
              // ignore this
            }
          }
          if (donePhase) {
            return;
          }
          
          if (showResults) {
            
            // print results
            long currentTotalCount = totalCount;              
            long currentProcessedCount = processedCount;
            
            if (currentTotalCount != 0) {
              long now = System.currentTimeMillis();
              long endTime = 0;
              double percent = 0;
              
              if (currentProcessedCount &gt; 0) {
                percent = ((double)currentProcessedCount * 100D) / currentTotalCount;
                
                if (percent &gt; 1) {
                  endTime = startTime + (long)((now - startTime) * (100D / percent));
                }
              }
              
              System.out.print(format.format(new Date(now)) + &quot;: Processed &quot; + currentProcessedCount + &quot; of &quot; + currentTotalCount + &quot; (&quot; + Math.round(percent) + &quot;%) of current phase.  &quot;);
              
              if (endTime != 0) {
                System.out.print(&quot;Estimated completion time: &quot; + estFormat.format(new Date(endTime)) + &quot;.&quot;);
              }
              
              System.out.print(&quot;\n&quot;);
            }
          }
        }          
      }
    });
    
    statusThread.start();
  }
  
  private void stopStatusThread() {
    donePhase = true;
    if (statusThread != null) {
      try {
        statusThread.join(2000);
      } catch (InterruptedException ie) {
        // ignore this
      }
      
      statusThread = null;
    }
  }
}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAuditType.html#L226">226</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditType.html#L311">311</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    this.createdOn = createdOn1;
  }

  /**
   * label for string01
   * @return label
   */
  public String getLabelString01() {
    return this.labelString01;
  }

  /**
   * label for string01
   * @param labelString01a
   */
  public void setLabelString01(String labelString01a) {
    this.labelString01 = labelString01a;
  }

  /**
   * label for string02
   * @return label
   */
  public String getLabelString02() {
    return this.labelString02;
  }

  /**
   * label for string02
   * @param labelString02a
   */
  public void setLabelString02(String labelString02a) {
    this.labelString02 = labelString02a;
  }

  /**
   * label for string03
   * @return label
   */
  public String getLabelString03() {
    return this.labelString03;
  }

  /**
   * label for string03
   * @param labelString03a
   */
  public void setLabelString03(String labelString03a) {
    this.labelString03 = labelString03a;
  }

  /**
   * label for string04
   * @return label
   */
  public String getLabelString04() {
    return this.labelString04;
  }

  /**
   * label for string04
   * @param labelString04a
   */
  public void setLabelString04(String labelString04a) {
    this.labelString04 = labelString04a;
  }

  /**
   * label for string05
   * @return label
   */
  public String getLabelString05() {
    return this.labelString05;
  }

  /**
   * label for string05
   * @param labelString05a
   */
  public void setLabelString05(String labelString05a) {
    this.labelString05 = labelString05a;
  }

  /**
   * context id ties multiple db changes
   * @return id
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * context id ties multiple db changes
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }

  /**
   * label for int01
   * @return label
   */
  public String getLabelInt01() {
    return this.labelInt01;
  }

  /**
   * label for int01
   * @param labelInt01a
   */
  public void setLabelInt01(String labelInt01a) {
    this.labelInt01 = labelInt01a;
  }

  /**
   * label for int02
   * @return label
   */
  public String getLabelInt02() {
    return this.labelInt02;
  }

  /**
   * label for int02
   * @param labelInt02a
   */
  public void setLabelInt02(String labelInt02a) {
    this.labelInt02 = labelInt02a;
  }
  
  /**
   * label for int03
   * @return label
   */
  public String getLabelInt03() {
    return this.labelInt03;
  }

  /**
   * label for int03
   * @param labelInt03a
   */
  public void setLabelInt03(String labelInt03a) {
    this.labelInt03 = labelInt03a;
  }

  /**
   * label for int04
   * @return label
   */
  public String getLabelInt04() {
    return this.labelInt04;
  }

  /**
   * label for int04
   * @param labelInt04a
   */
  public void setLabelInt04(String labelInt04a) {
    this.labelInt04 = labelInt04a;
  }

  /**
   * label for int05
   * @return label
   */
  public String getLabelInt05() {
    return this.labelInt05;
  }

  /**
   * label for int05
   * @param labelInt05
   */
  public void setLabelInt05(String labelInt05) {
    this.labelInt05 = labelInt05;
  }
  
  /**
   * label for the string06 field
   * @return label
   */
  public String getLabelString06() {
    return this.labelString06;
  }

  /**
   * label for the string06 field
   * @param labelString06a
   */
  public void setLabelString06(String labelString06a) {
    this.labelString06 = labelString06a;
  }

  /**
   * label for the string07 field
   * @return label
   */
  public String getLabelString07() {
    return this.labelString07;
  }

  /**
   * label for the string07 field
   * @param labelString07a
   */
  public void setLabelString07(String labelString07a) {
    this.labelString07 = labelString07a;
  }

  /**
   * label for the string08 field
   * @return label
   */
  public String getLabelString08() {
    return this.labelString08;
  }

  /**
   * label for the string08 field
   * @param labelString08a
   */
  public void setLabelString08(String labelString08a) {
    this.labelString08 = labelString08a;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditEntry.html#L700">700</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAuditEntry.html#L362">362</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditEntry.html#L457">457</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * misc field 1
   * @return field
   */
  public String getString01() {
    return this.string01;
  }

  /**
   * misc field 1
   * @param string01a
   */
  public void setString01(String string01a) {
    this.string01 = string01a;
  }

  /**
   * misc field 2
   * @return field
   */
  public String getString02() {
    return this.string02;
  }

  /**
   * misc field 2
   * @param string02a
   */
  public void setString02(String string02a) {
    this.string02 = string02a;
  }

  /**
   * misc field 3
   * @return field
   */
  public String getString03() {
    return this.string03;
  }

  /**
   * misc field 3
   * @param string03a
   */
  public void setString03(String string03a) {
    this.string03 = string03a;
  }

  /**
   * misc field 4
   * @return field
   */
  public String getString04() {
    return this.string04;
  }

  /**
   * misc field 4
   * @param string04a
   */
  public void setString04(String string04a) {
    this.string04 = string04a;
  }

  /**
   * misc field 5
   * @return field
   */
  public String getString05() {
    return this.string05;
  }

  /**
   * misc field 5
   * @param string05a
   */
  public void setString05(String string05a) {
    this.string05 = string05a;
  }

  /**
   * misc field 6
   * @return field
   */
  public String getString06() {
    return this.string06;
  }

  /**
   * misc field 6
   * @param string06a
   */
  public void setString06(String string06a) {
    this.string06 = string06a;
  }

  /**
   * misc field 7
   * @return field
   */
  public String getString07() {
    return this.string07;
  }

  /**
   * misc field 7
   * @param string07a
   */
  public void setString07(String string07a) {
    this.string07 = string07a;
  }

  /**
   * misc field 8
   * @return field
   */
  public String getString08() {
    return this.string08;
  }

  /**
   * misc field 8
   * @param string08a
   */
  public void setString08(String string08a) {
    this.string08 = string08a;
  }

  /**
   * misc integer field 1
   * @return field
   */
  public Long getInt01() {
    return this.int01;
  }

  /**
   * misc integer field 1
   * @param int01a
   */
  public void setInt01(Long int01a) {
    this.int01 = int01a;
  }

  /**
   * misc integer field 2
   * @return field
   */
  public Long getInt02() {
    return this.int02;
  }

  /**
   * misc integer field 2
   * @param int02a
   */
  public void setInt02(Long int02a) {
    this.int02 = int02a;
  }

  /**
   * misc integer field 3
   * @return field
   */
  public Long getInt03() {
    return this.int03;
  }

  /**
   * misc integer field 3
   * @param int03a
   */
  public void setInt03(Long int03a) {
    this.int03 = int03a;
  }

  /**
   * misc integer field 4
   * @return field
   */
  public Long getInt04() {
    return this.int04;
  }

  /**
   * misc integer field 4
   * @param int04a
   */
  public void setInt04(Long int04a) {
    this.int04 = int04a;
  }

  /**
   * misc integer field 5
   * @return field
   */
  public Long getInt05() {
    return this.int05;
  }

  /**
   * misc integer field 5
   * @param int05a
   */
  public void setInt05(Long int05a) {
    this.int05 = int05a;
  }

  /**
   * description of what happened in paragraph form
   * @return description
   */
  public String getDescription() {
    return this.description;
  }

  /**
   * description of what happened in paragraph form
   * @param description1
   */
  public void setDescription(String description1) {
    this.description = description1;
  }

  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L553">553</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\MigrateLegacyAttributes.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/MigrateLegacyAttributes.html#L446">446</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\SyncStemSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/SyncStemSets.html#L287">287</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  private void showStatus(String message) {
    if (showResults) {
      System.out.println(message);
    }
  }
  
  private void logDetail(String detail) {
    if (logDetails) {
      LOG.info(detail);
    }
  }
  
  private void reset() {
    processedCount = 0;
    donePhase = false;
    startTime = System.currentTimeMillis();
    
    // status thread
    statusThread = new Thread(new Runnable() {
      
      public void run() {
        SimpleDateFormat estFormat = new SimpleDateFormat(&quot;HH:mm&quot;);
        SimpleDateFormat format = new SimpleDateFormat(&quot;HH:mm:ss&quot;);
        
        while (true) {

          // sleep 30 seconds between status messages
          for (int i = 0; i &lt; 30; i++) {
            
            if (donePhase) {
              return;
            }
            
            try {
              Thread.sleep(1000);
            } catch (InterruptedException ie) {
              // ignore this
            }
          }
          if (donePhase) {
            return;
          }
          
          if (showResults) {
            
            // print results
            long currentTotalCount = totalCount;              
            long currentProcessedCount = processedCount;
            
            if (currentTotalCount != 0) {
              long now = System.currentTimeMillis();
              long endTime = 0;
              double percent = 0;
              
              if (currentProcessedCount &gt; 0) {
                percent = ((double)currentProcessedCount * 100D) / currentTotalCount;
                
                if (percent &gt; 1) {
                  endTime = startTime + (long)((now - startTime) * (100D / percent));
                }
              }
              
              System.out.print(format.format(new Date(now)) + &quot;: Processed &quot; + currentProcessedCount + &quot; of &quot; + currentTotalCount + &quot; (&quot; + Math.round(percent) + &quot;%) of current phase.  &quot;);
              
              if (endTime != 0) {
                System.out.print(&quot;Estimated completion time: &quot; + estFormat.format(new Date(endTime)) + &quot;.&quot;);
              }
              
              System.out.print(&quot;\n&quot;);
            }
          }
        }          
      }
    });
    
    statusThread.start();
  }
  
  private void stopStatusThread() {
    donePhase = true;
    if (statusThread != null) {
      try {
        statusThread.join(2000);
      } catch (InterruptedException ie) {
        // ignore this
      }
      
      statusThread = null;
    }
  }
}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L376">376</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L309">309</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      copiedMembership.setOwnerGroupId(g2.getUuid());
      copiedMembership.setCreatorUuid(s.getMemberUuid());
      copiedMembership.setCreateTimeLong(new Date().getTime());
      copiedMembership.setImmediateMembershipId(GrouperUuid.getUuid());
      copiedMembership.setHibernateVersionNumber(-1L);
      
      try {
        GrouperDAOFactory.getFactory().getMembership().save(copiedMembership);
      } catch (MembershipAlreadyExistsException e) {
        // this is okay
      }
    }
  }


  /**
   * Copies privileges of type priv on any subject for the given Subject subj1 to the given Subject subj2.
   * For instance, if subj1 has ADMIN privilege to Group x, this method will result with subj2
   * having ADMIN privilege to Group x.
   * @param s 
   * @param subj1
   * @param subj2
   * @param priv 
   * @throws InsufficientPrivilegeException 
   * @throws GrantPrivilegeException 
   * @throws SchemaException 
   */
  public void privilegeCopy(GrouperSession s, Subject subj1, Subject subj2, Privilege priv)
      throws InsufficientPrivilegeException, GrantPrivilegeException, SchemaException {
    GrouperSession.validate(s);
    
    Field f = priv.getField();

    Set&lt;Membership&gt; memberships = GrouperDAOFactory.getFactory().getMembership()
        .findAllImmediateByMemberAndField(MemberFinder.findBySubject(s, subj1, true).getUuid(), f, false);
    
    if (memberships.size() == 0) {
      return;
    }
        
    Member member = MemberFinder.findBySubject(s, subj2, true);
  
    Iterator&lt;Membership&gt; membershipsIter = memberships.iterator();
    while (membershipsIter.hasNext()) {
      Membership existingMembership = membershipsIter.next();
      Group g;
      try {
        g = existingMembership.getOwnerGroup();
      } catch (GroupNotFoundException e1) {
        throw new GrouperException(e1.getMessage(), e1);
      }
      PrivilegeHelper.dispatch(s, g, s.getSubject(), f.getWritePriv());
      
      Membership copiedMembership = existingMembership.clone();
      copiedMembership.setMemberUuid(member.getUuid());
      copiedMembership.setMember(member);
      copiedMembership.setCreatorUuid(s.getMemberUuid());
      copiedMembership.setCreateTimeLong(new Date().getTime());
      copiedMembership.setImmediateMembershipId(GrouperUuid.getUuid());
      copiedMembership.setHibernateVersionNumber(-1L);
      GrouperDAOFactory.getFactory().getMembership().save(copiedMembership);
    }
    
  }


  // public boolean hasPriv(s, g, subj, priv)
  
  /**
   * Revoke this privilege from everyone on this group.
   * &lt;pre class=&quot;eg&quot;&gt;
   * try {
   *   ap.revokePriv(s, g, AccessPrivilege.ADMIN);
   * }
   * catch (InsufficientPrivilegeException eIP) {
   *   // Not privileged to revoke the privilege
   * }
   * catch (RevokePrivilegeException eRP) {
   *   // Unable to revoke the privilege
   * }
   * &lt;/pre&gt;
   * @param   s     Revoke privilege in this session context.
   * @param   g     Revoke privilege on this group.
   * @param   priv  Revoke this privilege.   
   * @throws  InsufficientPrivilegeException
   * @throws  RevokePrivilegeException
   * @throws  SchemaException
   */
  public void revokePriv(GrouperSession s, Group g, Privilege priv)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L2163">2163</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L1064">1064</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    return result;
  }

  /**
   * unescape url chars (e.g. a space is %20)
   * @param string input
   * @return the encoded string
   */
  public static String escapeUrlDecode(String string) {
    String result = null;
    try {
      result = URLDecoder.decode(string, &quot;UTF-8&quot;);
    } catch (UnsupportedEncodingException ex) {
      throw new RuntimeException(&quot;UTF-8 not supported&quot;, ex);
    }
    return result;
  }

  /**
   * make sure a list is non null.  If null, then return an empty list
   * @param &lt;T&gt;
   * @param list
   * @return the list or empty list if null
   */
  public static &lt;T&gt; List&lt;T&gt; nonNull(List&lt;T&gt; list) {
    return list == null ? new ArrayList&lt;T&gt;() : list;
  }

  /**
   * make sure a collection is non null.  If null, then return an empty list
   * @param &lt;T&gt;
   * @param list
   * @return the list or empty list if null
   */
  public static &lt;T&gt; Collection&lt;T&gt; nonNull(Collection&lt;T&gt; list) {
    return list == null ? new ArrayList&lt;T&gt;() : list;
  }

  /**
   * make sure a list is non null.  If null, then return an empty set
   * @param &lt;T&gt;
   * @param set
   * @return the set or empty set if null
   */
  public static &lt;T&gt; Set&lt;T&gt; nonNull(Set&lt;T&gt; set) {
    return set == null ? new HashSet&lt;T&gt;() : set;
  }

  /**
   * make sure it is non null, if null, then give new map
   *
   * @param &lt;K&gt; key of map
   * @param &lt;V&gt; value of map
   * @param map is map
   * @return set non null
   */
  public static &lt;K,V&gt; Map&lt;K,V&gt; nonNull(Map&lt;K,V&gt; map) {
    return map == null ? new HashMap&lt;K,V&gt;() : map;
  }

  /**
   * return a list of objects from varargs.  Though if there is one
   * object, and it is a list, return it.
   *
   * @param &lt;T&gt;
   *            template type of the objects
   * @param objects
   * @return the list or null if objects is null
   */
  public static &lt;T&gt; List&lt;T&gt; toList(T... objects) {
    if (objects == null) {
      return null;
    }
    if (objects.length == 1 &amp;&amp; objects[0] instanceof List) {
      return (List&lt;T&gt;)objects[0];
    }

    List&lt;T&gt; result = new ArrayList&lt;T&gt;();
    for (T object : objects) {
      result.add(object);
    }
    return result;
  }

  /**
   * return a list of objects from varargs.  Though if there is one
   * object, and it is a list, return it.
   *
   *            template type of the objects
   * @param objects
   * @return the list or null if objects is null
   */
  public static List&lt;Object&gt; toListObject(Object... objects) {
    if (objects == null) {
      return null;
    }
    List&lt;Object&gt; result = new ArrayList&lt;Object&gt;();
    for (Object object : objects) {
      result.add(object);
    }
    return result;
  }


  /**
   * convert classes to a list
   * @param classes
   * @return list of classes
   */
  public static List&lt;Class&lt;?&gt;&gt; toListClasses(Class&lt;?&gt;... classes) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3GroupDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3GroupDAO.html#L901">901</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3GroupDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3GroupDAO.html#L1462">1462</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    Group result = (Group)HibernateSession.callbackHibernateSession(
        GrouperTransactionType.READONLY_OR_USE_EXISTING, AuditControl.WILL_NOT_AUDIT,
        new HibernateHandler() {

          public Object callback(HibernateHandlerBean hibernateHandlerBean)
              throws GrouperDAOException {

            ByHqlStatic byHql = HibernateSession.byHqlStatic();
            
            
            StringBuilder hql = new StringBuilder(&quot;select distinct theGroup from Group as theGroup &quot;);
            if (!Group._internal_fieldAttribute(attr)) {
              hql.append(&quot;, AttributeAssignValue value, AttributeAssign assign, AttributeAssign assign2, AttributeDefName name, AttributeDefName name2 &quot;);
            }
          
            GrouperSession grouperSession = GrouperSession.staticGrouperSession();
            
            //see if we are adding more to the query
            boolean changedQuery = false;
            StringBuilder sqlWhereClause = new StringBuilder();
    
            if (secureQuery) {
              if (Group._internal_fieldAttribute(attr)) {
                changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, &quot;theGroup.uuid&quot;, AccessPrivilege.VIEW_PRIVILEGES);
              } else {
                grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, sqlWhereClause, &quot;name.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
                
                grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, sqlWhereClause, &quot;name2.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
                
                changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, &quot;theGroup.uuid&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);
              }
            }
            
            if (!changedQuery) {
              hql.append(&quot; where &quot;);
            } else {
              hql.append(&quot; and &quot;);
            }
            
            if (sqlWhereClause.toString().trim().length() &gt; 0) {
              hql.append(sqlWhereClause).append(&quot; and &quot;);
            }
    
            if (Group._internal_fieldAttribute(attr)) {
              hql.append(&quot; theGroup.&quot; + attr + &quot;Db = :value &quot;);
            } else {
              String legacyAttributeStemName = GrouperConfig.retrieveConfig().propertyValueStringRequired(&quot;legacyAttribute.baseStem&quot;);
              String legacyAttributePrefix = GrouperConfig.retrieveConfig().propertyValueStringRequired(&quot;legacyAttribute.attribute.prefix&quot;);

              hql.append(&quot; assign.ownerGroupId = theGroup.uuid and assign.id = assign2.ownerAttributeAssignId and assign2.id = value.attributeAssignId and assign2.attributeDefNameId = name2.id and assign.attributeDefNameId = name.id and &quot; +</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L5911">5911</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L2616">2616</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * see if a class is a scalar (not bean, not array or list, etc)
   * @param type
   * @return true if scalar
   */
  public static boolean isScalar(Class&lt;?&gt; type) {

    if (type.isArray()) {
      return false;
    }

    //definitely all primitives
    if (type.isPrimitive()) {
      return true;
    }
    //Integer, Float, etc
    if (Number.class.isAssignableFrom(type)) {
      return true;
    }
    //Date, Timestamp
    if (Date.class.isAssignableFrom(type)) {
      return true;
    }
    if (Character.class.equals(type)) {
      return true;
    }
    //handles strings and string builders
    if (CharSequence.class.equals(type) || CharSequence.class.isAssignableFrom(type)) {
      return true;
    }
    if (Class.class == type || Boolean.class == type || type.isEnum()) {
      return true;
    }
    //appears not to be a scalar
    return false;
  }


  /**
   * &lt;pre&gt;
   * Convert a string or object to a timestamp (could be string, date, timestamp, etc)
   * yyyymmdd
   * or
   * yyyy/MM/dd
   * or
   * yyyy/MM/dd HH:mm:ss
   * or
   * yyyy/MM/dd HH:mm:ss.SSS
   * or
   * yyyy/MM/dd HH:mm:ss.SSSSSS
   *
   * &lt;/pre&gt;
   *
   * @param input
   * @return the timestamp
   * @throws RuntimeException if invalid format
   */
  public static Timestamp toTimestamp(Object input) {

    if (null == input) {
      return null;
    } else if (input instanceof java.sql.Timestamp) {
      return (Timestamp) input;
    } else if (input instanceof String) {
      return stringToTimestamp((String) input);
    } else if (input instanceof Date) {
      return new Timestamp(((Date)input).getTime());
    } else if (input instanceof java.sql.Date) {
      return new Timestamp(((java.sql.Date)input).getTime());
    } else {
      throw new RuntimeException(&quot;Cannot convert Object to timestamp : &quot; + input);
    }

  }

  /**
   * convert an object to a string
   *
   * @param input
   *          is the object to convert
   *
   * @return the String conversion of the object
   */
  public static String stringValue(Object input) {
    //this isnt needed
    if (input == null) {
      return (String) input;
    }

    if (input instanceof Timestamp) {
      //convert to yyyy/MM/dd HH:mm:ss.SSS
      return timestampToString((Timestamp) input);
    }

    if (input instanceof Date) {
      //convert to yyyymmdd
      return stringValue((Date) input);
    }

    if (input instanceof Integer || input instanceof Long) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L853">853</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L990">990</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>              groupNameToDescription, groupNames);
          
          
          String groupNameOverall = hib3GrouploaderLogOverall.getGroupNameFromJobName();
  
          GrouperContext.createNewDefaultContext(GrouperEngineBuiltin.LOADER, false, true);
  
          long startTime = loaderJobBean.getStartTime();
          
          List&lt;Group&gt; andGroups = loaderJobBean.getAndGroups();
          List&lt;GroupType&gt; groupTypes = GrouperUtil.nonNull(loaderJobBean.getGroupTypes());
          String groupLikeString = loaderJobBean.getGroupLikeString();

          Map&lt;String, Subject&gt; subjectCache = new HashMap&lt;String, Subject&gt;();
          Map&lt;String, Map&lt;Privilege, List&lt;Subject&gt;&gt;&gt; privsToAdd = new LinkedHashMap&lt;String, Map&lt;Privilege, List&lt;Subject&gt;&gt;&gt;();
          
          initPrivilegesForGroup(grouperLoaderResultsetOverall, privsToAdd, subjectCache, AccessPrivilege.VIEW, loaderJobBean.getLdapGroupViewers());
          initPrivilegesForGroup(grouperLoaderResultsetOverall, privsToAdd, subjectCache, AccessPrivilege.READ, loaderJobBean.getLdapGroupReaders());
          initPrivilegesForGroup(grouperLoaderResultsetOverall, privsToAdd, subjectCache, AccessPrivilege.ADMIN, loaderJobBean.getLdapGroupAdmins());
          initPrivilegesForGroup(grouperLoaderResultsetOverall, privsToAdd, subjectCache, AccessPrivilege.UPDATE, loaderJobBean.getLdapGroupUpdaters());
          initPrivilegesForGroup(grouperLoaderResultsetOverall, privsToAdd, subjectCache, AccessPrivilege.OPTIN, loaderJobBean.getLdapGroupOptins());
          initPrivilegesForGroup(grouperLoaderResultsetOverall, privsToAdd, subjectCache, AccessPrivilege.OPTOUT, loaderJobBean.getLdapGroupOptouts());
          initPrivilegesForGroup(grouperLoaderResultsetOverall, privsToAdd, subjectCache, AccessPrivilege.GROUP_ATTR_READ, loaderJobBean.getLdapGroupAttrReaders());
          initPrivilegesForGroup(grouperLoaderResultsetOverall, privsToAdd, subjectCache, AccessPrivilege.GROUP_ATTR_UPDATE, loaderJobBean.getLdapGroupAttrUpdaters());
          
          if (LOG.isDebugEnabled()) {
            LOG.debug(groupNameOverall + &quot;: start syncing membership&quot;);
          }
        
          
          syncGroupList(grouperLoaderResultsetOverall, startTime, grouperSession, 
              andGroups, groupTypes, groupLikeString, groupNameOverall, hib3GrouploaderLogOverall,
              statusOverall, loaderJobBean.getGrouperLoaderDb(), groupNameToDisplayName, groupNameToDescription, privsToAdd, groupNames);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L4752">4752</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L2147">2147</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * convert a collection of sources to a string
   * @param sources
   * @return the string
   */
  public static String toString(Collection&lt;Source&gt; sources) {
    if (length(sources) == 0) {
      return null;
    }
    StringBuilder result = new StringBuilder();
    for (Source source : sources) {
      result.append(source.getId()).append(&quot;, &quot;);
    }
    result.delete(result.length()-2, result.length());
    return result.toString();
  }

  /**
   * fail safe toString for Exception blocks, and include the stack
   * if there is a problem with toString()
   * @param object
   * @return the toStringSafe string
   */
  public static String toStringSafe(Object object) {
    if (object == null) {
      return null;
    }

    try {
      //give size and type if collection
      if (object instanceof Collection) {
        Collection&lt;Object&gt; collection = (Collection&lt;Object&gt;) object;
        int collectionSize = collection.size();
        if (collectionSize == 0) {
          return &quot;Empty &quot; + object.getClass().getSimpleName();
        }
        Object first = collection.iterator().next();
        return object.getClass().getSimpleName() + &quot; of size &quot;
          + collectionSize + &quot; with first type: &quot; +
          (first == null ? null : first.getClass());
      }

      return object.toString();
    } catch (Exception e) {
      return &quot;&lt;&lt;exception&gt;&gt; &quot; + object.getClass() + &quot;:\n&quot; + getFullStackTrace(e) + &quot;\n&quot;;
    }
  }

  /**
   * get the boolean value for an object, cant be null or blank
   *
   * @param object
   * @return the boolean
   */
  public static boolean booleanValue(Object object) {
    // first handle blanks
    if (nullOrBlank(object)) {
      throw new RuntimeException(
          &quot;Expecting something which can be converted to boolean, but is null or blank: '&quot;
              + object + &quot;'&quot;);
    }
    // its not blank, just convert
    if (object instanceof Boolean) {
      return (Boolean) object;
    }
    if (object instanceof String) {
      String string = (String) object;
      if (equalsIgnoreCase(string, &quot;true&quot;)
          || equalsIgnoreCase(string, &quot;t&quot;)
          || equalsIgnoreCase(string, &quot;yes&quot;)
          || equalsIgnoreCase(string, &quot;on&quot;)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L683">683</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L599">599</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>              group.getId(), memberIds, membershipType, fields, null, true, null);
  
          if (LOG.isDebugEnabled()) {
            debugLog.put(&quot;additionalMembershipsSize&quot;, GrouperUtil.length(additionalMemberships));
          }
          
          //collate this
          if (GrouperUtil.length(additionalMemberships) &gt; 0) {
            Set&lt;Object[]&gt; newMemberships = new LinkedHashSet&lt;Object[]&gt;(additionalMemberships);
            newMemberships.addAll(memberships);
            memberships = newMemberships;
            
          }
        }
        
      }
      
      if (GrouperUtil.length(memberships) &gt; 0) {
        
        Map&lt;MultiKey, List&lt;Object[]&gt;&gt; membershipsMap = new HashMap&lt;MultiKey, List&lt;Object[]&gt;&gt;();
        
        //this multikey is sourceid, subjectid, groupid, fieldid, 
        Map&lt;MultiKey, PrivilegeAssignType&gt; privilegeAssignTypeMap = new HashMap&lt;MultiKey, PrivilegeAssignType&gt;();
        
        //lets get all the members first, and keep the answer
        for (Object[] objectArray: memberships) {
          
          Member member = (Member)objectArray[1];
          
          MultiKey subjectKey = new MultiKey(member.getSubjectSourceId(), member.getSubjectId());
  
          PrivilegeSubjectContainerImpl privilegeSubjectContainerImpl = resultsMap.get(subjectKey);
          if (privilegeSubjectContainerImpl == null) {
            privilegeSubjectContainerImpl = new PrivilegeSubjectContainerImpl();
            privilegeSubjectContainerImpl.setSubject(new LazySubject(member));
            resultsMap.put(subjectKey, privilegeSubjectContainerImpl);
            results.add(privilegeSubjectContainerImpl);
  
          }            
  
          Membership membership = (Membership)objectArray[0];
  
          List&lt;Object[]&gt; membershipList = membershipsMap.get(subjectKey);
          
          if (membershipList == null) {
  
            membershipList = new ArrayList&lt;Object[]&gt;();
            
            membershipsMap.put(subjectKey, membershipList);
  
          }
  
          membershipList.add(objectArray);
          
          MultiKey privilegeAssignTypeKey = new MultiKey(member.getSubjectSourceId(), member.getSubjectId(), group.getId(), membership.getFieldId());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3GroupDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3GroupDAO.html#L365">365</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3GroupDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3GroupDAO.html#L1460">1460</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  private Set&lt;Group&gt; findAllByApproximateAttrHelper(final String attr, final String val, final String scope, final boolean secureQuery) {
    Set resultGroups = (Set)HibernateSession.callbackHibernateSession(
        GrouperTransactionType.READONLY_OR_USE_EXISTING, AuditControl.WILL_NOT_AUDIT,
        new HibernateHandler() {

          public Object callback(HibernateHandlerBean hibernateHandlerBean)
              throws GrouperDAOException {

            ByHqlStatic byHql = HibernateSession.byHqlStatic();
            
            
            StringBuilder hql = new StringBuilder(&quot;select distinct theGroup from Group as theGroup &quot;);
            if (!Group._internal_fieldAttribute(attr)) {
              hql.append(&quot;, AttributeAssignValue value, AttributeAssign assign, AttributeAssign assign2, AttributeDefName name, AttributeDefName name2 &quot;);
            }
          
            GrouperSession grouperSession = GrouperSession.staticGrouperSession();
            
            //see if we are adding more to the query
            boolean changedQuery = false;
            StringBuilder sqlWhereClause = new StringBuilder();
            
            if (secureQuery) {
              if (Group._internal_fieldAttribute(attr)) {
              changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
                  grouperSession.getSubject(), byHql, 
                  hql, &quot;theGroup.uuid&quot;, AccessPrivilege.VIEW_PRIVILEGES);
              } else {
                grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, sqlWhereClause, &quot;name.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
                
                grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, sqlWhereClause, &quot;name2.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
                
                changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, &quot;theGroup.uuid&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);
              }
            }
            
            if (!changedQuery) {
              hql.append(&quot; where &quot;);
            } else {
              hql.append(&quot; and &quot;);
            }
            
            if (sqlWhereClause.toString().trim().length() &gt; 0) {
              hql.append(sqlWhereClause).append(&quot; and &quot;);
            }
                        
            if (Group._internal_fieldAttribute(attr)) {
              hql.append(&quot; lower(theGroup.&quot; + attr + &quot;Db) like :value &quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Member.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Member.html#L3946">3946</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportMember.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportMember.html#L466">466</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  
  /**
   * @return the sortString0
   */
  public String getSortString0() {
    return sortString0;
  }

  
  /**
   * @param sortString0 the sortString0 to set
   */
  public void setSortString0(String sortString0) {
    this.sortString0 = sortString0;
  }

  
  /**
   * @return the sortString1
   */
  public String getSortString1() {
    return sortString1;
  }

  
  /**
   * @param sortString1 the sortString1 to set
   */
  public void setSortString1(String sortString1) {
    this.sortString1 = sortString1;
  }

  
  /**
   * @return the sortString2
   */
  public String getSortString2() {
    return sortString2;
  }

  
  /**
   * @param sortString2 the sortString2 to set
   */
  public void setSortString2(String sortString2) {
    this.sortString2 = sortString2;
  }

  
  /**
   * @return the sortString3
   */
  public String getSortString3() {
    return sortString3;
  }

  
  /**
   * @param sortString3 the sortString3 to set
   */
  public void setSortString3(String sortString3) {
    this.sortString3 = sortString3;
  }

  
  /**
   * @return the sortString4
   */
  public String getSortString4() {
    return sortString4;
  }

  
  /**
   * @param sortString4 the sortString4 to set
   */
  public void setSortString4(String sortString4) {
    this.sortString4 = sortString4;
  }

  
  /**
   * @return the searchString0
   */
  public String getSearchString0() {
    return searchString0;
  }

  
  /**
   * @param searchString0 the searchString0 to set
   */
  public void setSearchString0(String searchString0) {
    this.searchString0 = searchString0;
  }

  
  /**
   * @return the searchString1
   */
  public String getSearchString1() {
    return searchString1;
  }

  
  /**
   * @param searchString1 the searchString1 to set
   */
  public void setSearchString1(String searchString1) {
    this.searchString1 = searchString1;
  }

  
  /**
   * @return the searchString2
   */
  public String getSearchString2() {
    return searchString2;
  }

  
  /**
   * @param searchString2 the searchString2 to set
   */
  public void setSearchString2(String searchString2) {
    this.searchString2 = searchString2;
  }

  
  /**
   * @return the searchString3
   */
  public String getSearchString3() {
    return searchString3;
  }

  
  /**
   * @param searchString3 the searchString3 to set
   */
  public void setSearchString3(String searchString3) {
    this.searchString3 = searchString3;
  }

  
  /**
   * @return the searchString4
   */
  public String getSearchString4() {
    return searchString4;
  }

  
  /**
   * @param searchString4 the searchString4 to set
   */
  public void setSearchString4(String searchString4) {
    this.searchString4 = searchString4;
  }

  
  /**
   * @return the name
   */
  public String getName() {
    return name;
  }

  
  /**
   * @param name the name to set
   */
  public void setName(String name) {
    this.name = name;
  }

  
  /**
   * @return the description
   */
  public String getDescription() {
    return description;
  }

  
  /**
   * @param description the description to set
   */
  public void setDescription(String description) {
    this.description = description;
  }  
  
  /**
   * @param subject
   * @param storeChanges if there are changes, should they be saved to the database?
   */
  public void updateMemberAttributes(Subject subject, boolean storeChanges) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L548">548</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAuditType.html#L227">227</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditType.html#L312">312</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * label for string01
   * @return label
   */
  public String getLabelString01() {
    return this.labelString01;
  }

  /**
   * label for string01
   * @param labelString01a
   */
  public void setLabelString01(String labelString01a) {
    this.labelString01 = labelString01a;
  }

  /**
   * label for string02
   * @return label
   */
  public String getLabelString02() {
    return this.labelString02;
  }

  /**
   * label for string02
   * @param labelString02a
   */
  public void setLabelString02(String labelString02a) {
    this.labelString02 = labelString02a;
  }

  /**
   * label for string03
   * @return label
   */
  public String getLabelString03() {
    return this.labelString03;
  }

  /**
   * label for string03
   * @param labelString03a
   */
  public void setLabelString03(String labelString03a) {
    this.labelString03 = labelString03a;
  }

  /**
   * label for string04
   * @return label
   */
  public String getLabelString04() {
    return this.labelString04;
  }

  /**
   * label for string04
   * @param labelString04a
   */
  public void setLabelString04(String labelString04a) {
    this.labelString04 = labelString04a;
  }

  /**
   * label for string05
   * @return label
   */
  public String getLabelString05() {
    return this.labelString05;
  }

  /**
   * label for string05
   * @param labelString05a
   */
  public void setLabelString05(String labelString05a) {
    this.labelString05 = labelString05a;
  }

  /**
   * context id ties multiple db changes
   * @return id
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * context id ties multiple db changes
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }

  /**
   * label for int01
   * @return label
   */
  public String getLabelInt01() {
    return this.labelInt01;
  }

  /**
   * label for int01
   * @param labelInt01a
   */
  public void setLabelInt01(String labelInt01a) {
    this.labelInt01 = labelInt01a;
  }

  /**
   * label for int02
   * @return label
   */
  public String getLabelInt02() {
    return this.labelInt02;
  }

  /**
   * label for int02
   * @param labelInt02a
   */
  public void setLabelInt02(String labelInt02a) {
    this.labelInt02 = labelInt02a;
  }
  
  /**
   * label for int03
   * @return label
   */
  public String getLabelInt03() {
    return this.labelInt03;
  }

  /**
   * label for int03
   * @param labelInt03a
   */
  public void setLabelInt03(String labelInt03a) {
    this.labelInt03 = labelInt03a;
  }

  /**
   * label for int04
   * @return label
   */
  public String getLabelInt04() {
    return this.labelInt04;
  }

  /**
   * label for int04
   * @param labelInt04a
   */
  public void setLabelInt04(String labelInt04a) {
    this.labelInt04 = labelInt04a;
  }

  /**
   * label for int05
   * @return label
   */
  public String getLabelInt05() {
    return this.labelInt05;
  }

  /**
   * label for int05
   * @param labelInt05
   */
  public void setLabelInt05(String labelInt05) {
    this.labelInt05 = labelInt05;
  }
  
  /**
   * make sure this object will fit in the DB
   */
  public void truncate() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L357">357</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditType.html#L146">146</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  private String id;

  /** friendly label for the audit type */
  private String auditCategory;
  
  /** friendly label for the action in the category */
  private String actionName;
  
  /** when this record was last updated */
  private Long lastUpdatedDb;
  
  /** when this record was created */
  private Long createdOnDb;
  
  /** label for the string01 field */
  private String labelString01;
  
  /** label for the string02 field */
  private String labelString02;
  
  /** label for the string03 field */
  private String labelString03;
  
  /** label for the string04 field */
  private String labelString04;
  
  /** label for the string05 field */
  private String labelString05;
  
  /** label for the string06 field */
  private String labelString06;
  
  /** label for the string07 field */
  private String labelString07;
  
  /** label for the string08 field */
  private String labelString08;
  
  /** context id ties multiple db changes  */
  private String contextId;
  
  /** label for the int01 field */
  private String labelInt01;
  
  /** label for the int02 field */
  private String labelInt02;

  /** label for the int03 field */
  private String labelInt03;
  
  /** label for the int04 field */
  private String labelInt04;
  
  /** label for the int05 field */
  private String labelInt05;

  /**
   * uuid of row
   * @return id
   */
  public String getId() {
    return this.id;
  }

  /**
   * uuid of row
   * @param id1
   */
  public void setId(String id1) {
    this.id = id1;
  }

  /**
   * category of audit
   * @return audit type
   */
  public String getAuditCategory() {
    return this.auditCategory;
  }

  /**
   * category of audit
   * @param auditType1
   */
  public void setAuditCategory(String auditType1) {
    this.auditCategory = auditType1;
  }

  /**
   * action within the audit category
   * @return the action name
   */
  public String getActionName() {
    return this.actionName;
  }

  /**
   * action within the audit category
   * @param actionName
   */
  public void setActionName(String actionName) {
    this.actionName = actionName;
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }

  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L1687">1687</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L665">665</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    if (isBlank(name)) {
      return name;
    }

    int lastColonIndex = name.lastIndexOf(':');
    if (lastColonIndex == -1) {

      if (nullForRoot) {
      return null;
      }
      return &quot;:&quot;;
    }
    String parentStemName = name.substring(0,lastColonIndex);
    return parentStemName;

  }

  /**
   * return the string or the other if the first is blank
   * @param string
   * @param defaultStringIfBlank
   * @return the string or the default one
   */
  public static String defaultIfBlank(String string, String defaultStringIfBlank) {
    return isBlank(string) ? defaultStringIfBlank : string;
  }

  /**
   * genericized method to see if first is null, if so then return second, else first.
   * @param &lt;T&gt;
   * @param theValue first input
   * @param defaultIfTheValueIsNull second input
   * @return the first if not null, second if no
   */
  public static &lt;T&gt; T defaultIfNull(T theValue, T defaultIfTheValueIsNull) {
    return theValue != null ? theValue : defaultIfTheValueIsNull;
  }

  /**
   * add each element of listToAdd if it is not already in list
   * @param &lt;T&gt;
   * @param list to add to
   * @param listToAdd each element will be added to list, or null if none
   */
  public static &lt;T&gt; void addIfNotThere(Collection&lt;T&gt; list, Collection&lt;T&gt; listToAdd) {
    //maybe nothing to do
    if (listToAdd == null) {
      return;
    }
    for (T t : listToAdd) {
      if (!list.contains(t)) {
        list.add(t);
      }
    }
  }


  /**
   * print out various types of objects
   *
   * @param object
   * @param maxChars is where it should stop when figuring out object.  note, result might be longer than max...
   * need to abbreviate when back
   * @param result is where to append to
   */
  private static void toStringForLogHelper(Object object, int maxChars, StringBuilder result) {

    try {
      if (object == null) {
        result.append(&quot;null&quot;);
      } else if (object.getClass().isArray()) {
        // handle arrays
        int length = Array.getLength(object);
        if (length == 0) {
          result.append(&quot;Empty array&quot;);
        } else {
          result.append(&quot;Array size: &quot;).append(length).append(&quot;: &quot;);
          for (int i = 0; i &lt; length; i++) {
            result.append(&quot;[&quot;).append(i).append(&quot;]: &quot;).append(</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3GroupDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3GroupDAO.html#L366">366</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3GroupDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3GroupDAO.html#L901">901</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    Set resultGroups = (Set)HibernateSession.callbackHibernateSession(
        GrouperTransactionType.READONLY_OR_USE_EXISTING, AuditControl.WILL_NOT_AUDIT,
        new HibernateHandler() {

          public Object callback(HibernateHandlerBean hibernateHandlerBean)
              throws GrouperDAOException {

            ByHqlStatic byHql = HibernateSession.byHqlStatic();
            
            
            StringBuilder hql = new StringBuilder(&quot;select distinct theGroup from Group as theGroup &quot;);
            if (!Group._internal_fieldAttribute(attr)) {
              hql.append(&quot;, AttributeAssignValue value, AttributeAssign assign, AttributeAssign assign2, AttributeDefName name, AttributeDefName name2 &quot;);
            }
          
            GrouperSession grouperSession = GrouperSession.staticGrouperSession();
            
            //see if we are adding more to the query
            boolean changedQuery = false;
            StringBuilder sqlWhereClause = new StringBuilder();
            
            if (secureQuery) {
              if (Group._internal_fieldAttribute(attr)) {
              changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
                  grouperSession.getSubject(), byHql, 
                  hql, &quot;theGroup.uuid&quot;, AccessPrivilege.VIEW_PRIVILEGES);
              } else {
                grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, sqlWhereClause, &quot;name.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
                
                grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, sqlWhereClause, &quot;name2.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
                
                changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
                    grouperSession.getSubject(), byHql, 
                    hql, &quot;theGroup.uuid&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);
              }
            }
            
            if (!changedQuery) {
              hql.append(&quot; where &quot;);
            } else {
              hql.append(&quot; and &quot;);
            }
            
            if (sqlWhereClause.toString().trim().length() &gt; 0) {
              hql.append(sqlWhereClause).append(&quot; and &quot;);
            }
                        
            if (Group._internal_fieldAttribute(attr)) {
              hql.append(&quot; lower(theGroup.&quot; + attr + &quot;Db) like :value &quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L511">511</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L658">658</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }
  }
  
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPostSave(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPostSave(HibernateSession hibernateSession) {
    
    // add change log entry for permissions
    if (this.isActive() &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L539">539</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L648">648</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    StringBuilder sqlTables = new StringBuilder(&quot; from PermissionEntryAll pea &quot;);
    
    StringBuilder sqlWhereClause = new StringBuilder(&quot;&quot;);
    
    GrouperSession grouperSession = GrouperSession.staticGrouperSession();
    
    Subject grouperSessionSubject = grouperSession.getSubject();
    
    grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
      grouperSessionSubject, byHqlStatic, 
      sqlTables, sqlWhereClause, &quot;pea.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
    
    boolean changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
        grouperSessionSubject, byHqlStatic, 
        sqlTables, &quot;pea.roleId&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);

    StringBuilder sql;
    if (changedQuery) {
      if (sqlWhereClause.length() &gt; 0) {
        sql = sqlTables.append(&quot; and &quot;).append(sqlWhereClause);
      } else {
        sql = sqlTables;
      }
    } else {
      sql = sqlTables.append(&quot; where &quot;).append(sqlWhereClause);
    }
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and pea.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and pea.enabledDb = 'F' &quot;);
    }
    
    if (!StringUtils.isBlank(ownerRoleId)) {
      sql.append(&quot; and pea.roleId = :theOwnerRoleId &quot;);
      byHqlStatic.setString(&quot;theOwnerRoleId&quot;, ownerRoleId);
    }
    
    if (!StringUtils.isBlank(action)) {
      sql.append(&quot; and pea.action = :theAction &quot;);
      byHqlStatic.setString(&quot;theAction&quot;, action);
    }

    if (!StringUtils.isBlank(attributeDefId)) {
      sql.append(&quot; and pea.attributeDefId = :theAttributeDefId &quot;);
      byHqlStatic.setString(&quot;theAttributeDefId&quot;, attributeDefId);
    }
    if (!StringUtils.isBlank(attributeDefNameId)) {
      sql.append(&quot; and pea.attributeDefNameId = :theAttributeDefNameId &quot;);
      byHqlStatic.setString(&quot;theAttributeDefNameId&quot;, attributeDefNameId);
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L829">829</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3759">3759</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            sql.append(HibUtils.convertToInClause(groupIds, byHqlStatic));
            sql.append(&quot;) &quot;);
          }
          if (memberIdsSize &gt; 0) {
            sql.append(&quot; and ms.memberUuid in (&quot;);
            sql.append(HibUtils.convertToInClause(memberIds, byHqlStatic));
            sql.append(&quot;) &quot;);
          }
          if (membershipIdsSize &gt; 0) {
            sql.append(&quot; and ms.uuid in (&quot;);
            sql.append(HibUtils.convertToInClause(membershipIds, byHqlStatic));
            sql.append(&quot;) &quot;);
          }
          
          if (!StringUtils.isBlank(filterForMember)) {

            filterForMember = filterForMember.toLowerCase();

            String[] filtersForMember = splitScopeForMember ? GrouperUtil.splitTrim(filterForMember, &quot; &quot;) 
                : new String[]{filterForMember};

            if (sql.length() &gt; 0) {
              sql.append(&quot; and &quot;);
            }
            sql.append(&quot; ( &quot;);

            int index = 0;
            
            String searchFieldName = SearchStringEnum.getDefaultSearchString().getFieldName();

            for (String theFilter : filtersForMember) {
              if (index != 0) {
                sql.append(&quot; and &quot;);
              }
              sql.append(&quot; ( m.&quot; + searchFieldName + &quot; like :filterString&quot; + index + &quot; ) &quot;);

              if (!theFilter.endsWith(&quot;%&quot;)) {
                theFilter += &quot;%&quot;;
              }
              if (!theFilter.startsWith(&quot;%&quot;)) {
                theFilter = &quot;%&quot; + theFilter;
              }
              byHqlStatic.setString(&quot;filterString&quot; + index, theFilter);
              index++;
            }
            sql.append(&quot; ) &quot;);
          }

          if (!StringUtils.isBlank(scopeForGroup)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L481">481</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L520">520</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPreUpdate(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPreUpdate(HibernateSession hibernateSession) {
    super.onPreUpdate(hibernateSession);
    
    // add change log entry for permissions
    if (!this.isActive() &amp;&amp; this.dbVersion().isActive() &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleThenEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleThenEnum.html#L378">378</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleThenEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleThenEnum.html#L500">500</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      Stem stem = group.getParentStem();
      
      Set&lt;Subject&gt; creators = stem.getCreators();
      
      Set&lt;Subject&gt; creatorsAreNonWheelGroups = new HashSet&lt;Subject&gt;();

      Group wheelGroup = null;
      boolean calculatedWheelGroup = false;
      
      //lets see which ones are groups
      for (Subject creator : GrouperUtil.nonNull(creators)) {
        
        if (!StringUtils.equals(&quot;g:gsa&quot;, creator.getSourceId())) {
          continue;
        }
        
        //ok, we have a group, is the session user a member of the group?
        Group creatorGroup = GroupFinder.findByUuid(GrouperSession.staticGrouperSession(), creator.getId(), false);
        if (!creatorGroup.hasMember(subjectUnderlyingSession)) {
          continue;
        }
        
        //lets see if this is the wheel group
        if (!calculatedWheelGroup) {
          if (GrouperConfig.getPropertyBoolean(GrouperConfig.PROP_USE_WHEEL_GROUP, false)) {
            String wheelGroupName = GrouperConfig.getProperty( GrouperConfig.PROP_WHEEL_GROUP );
            if (!StringUtils.isBlank(wheelGroupName)) {
              wheelGroup = GroupFinder.findByName( GrouperSession.staticGrouperSession(), wheelGroupName, true );
            }
          }
          calculatedWheelGroup = true;
        }
        
        //if wheel
        if (wheelGroup != null) {

          //dont worry about wheel groups
          if (StringUtils.equals(wheelGroup.getId(), creator.getId())) {
            continue;
          }
          
          //dont worry if group is a member of the wheel gropu
          if (wheelGroup.hasMember(creator)) {
            continue;
          }
          
        }
        
        //ok, we have a group to do this with
        creatorsAreNonWheelGroups.add(creator);
        
      }
      
      boolean result = false;
      
      //if we found a group to use, or if user is wheel or root
      if (creatorsAreNonWheelGroups.size() &gt; 0 || PrivilegeHelper.isWheelOrRoot(subjectUnderlyingSession)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L793">793</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L931">931</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapErrorUnresolvableName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapGroupNameExpressionName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapGroupDisplayNameExpressionName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapGroupDescriptionExpressionName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSubjectExpressionName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapReadersName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapViewersName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapAdminsName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapUpdatersName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapOptinsName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapOptoutsName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapGroupAttrReadersName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapGroupAttrUpdatersName(), attributeName)
            ;
        
        //not allowed: StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapGroupAttributeName(), attributeName)
      }

      /**
       * sync up an attributeDefinition membership based on query and db
       */
      @SuppressWarnings(&quot;unchecked&quot;)
      @Override
      public void runJob(LoaderJobBean loaderJobBean) {
    
        GrouperContext.createNewDefaultContext(GrouperEngineBuiltin.LOADER, false, true);
    
        GrouperSession grouperSession = loaderJobBean.getGrouperSession();

        Hib3GrouperLoaderLog hib3GrouploaderLogOverall = loaderJobBean.getHib3GrouploaderLogOverall();
        GrouperLoaderStatus[] statusOverall = new GrouperLoaderStatus[]{GrouperLoaderStatus.SUCCESS};
        

        try {
        
          //      GrouperLoaderDb grouperLoaderDb, attributeDefName
          //      Hib3GrouperLoaderLog hib3GrouploaderLog, long startTime, GrouperSession grouperSession, 
          //      attributeLoaderAttrQuery, attributeLoaderAttrSetQuery, attributeLoaderAttrsLike
          //   attributeLoaderActionQuery, attributeLoaderActionSetQuery
          
          boolean errorUnresolvable = GrouperUtil.booleanValue(loaderJobBean.getLdapErrorUnresolvable(), true);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\bench\Add100UnionMembers.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/bench/Add100UnionMembers.html#L75">75</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\bench\Add10UnionMembers.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/bench/Add10UnionMembers.html#L75">75</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  protected Add100UnionMembers() {
    super();
  } // protected Add100UnionMembers()

  // PUBLIC INSTANCE METHODS //

  /**
   * @since 1.1.0
   */
  public void init() 
    throws GrouperException 
  {
    try {
      GrouperSession  s     = GrouperSession.start( SubjectFinder.findRootSubject() );
      Stem            root  = StemFinder.findRootStem(s);
      Stem            ns    = root.addChildStem(&quot;example&quot;, &quot;example&quot;);
      this.g0               = ns.addChildGroup(&quot;group 0&quot;, &quot;group 0&quot;);
      this.g1               = ns.addChildGroup(&quot;group 1&quot;, &quot;group 1&quot;);
      this.g2               = ns.addChildGroup(&quot;group 2&quot;, &quot;group 2&quot;);
      String          type  = &quot;person&quot;;
      for (int i=0; i &lt; CNT; i++) {
        String id = &quot;subj&quot; + i;
        RegistrySubject.add(s, id, type, &quot;subject &quot; + i);
        subjects[i] = SubjectFinder.findById(id, true);
        // add half to each group
        if (i % 2 == 0) {
          this.g0.addMember( subjects[i] );
        }
        else {
          this.g1.addMember( subjects[i] );
        }
      }
    }
    catch (Exception e) {
      throw new GrouperException(e.getMessage());
    }
  } // public void init()

  /**
   * @since 1.1.0
   */
  public void run() 
    throws GrouperException 
  {
    try {
      this.g2.addCompositeMember(CompositeType.UNION, this.g0, this.g1);
    }
    catch (Exception e) {
      throw new GrouperException(e);
    }
  } // public void run()

} // public class Add100UnionMembers</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L442">442</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L529">529</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  thisGroupHasImmediateEnabledMembership {

    /**
     * 
     */
    @Override
    public String validate(RuleDefinition ruleDefinition) {
      return RuleUtils.validateGroup(ruleDefinition.getIfCondition().getIfOwnerId(), 
          ruleDefinition.getIfCondition().getIfOwnerName(), 
          ruleDefinition.getAttributeAssignType().getOwnerGroupId());

    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleIfConditionEnum#shouldFire(edu.internet2.middleware.grouper.rules.RuleDefinition, edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public boolean shouldFire(RuleDefinition ruleDefinition, RuleEngine ruleEngine,
        RulesBean rulesBean) {
      
      String memberId = null;
      try {
        memberId = rulesBean.getMemberId();
      } catch (Exception e) {
        //ignore
      }
      
      GrouperSession rootSession = GrouperSession.startRootSession(false);
      try {
        
        if (StringUtils.isBlank(memberId)) {
          
          Member member = MemberFinder.findBySubject(rootSession, rulesBean.getSubject(), false);
          memberId = member == null ? null : member.getUuid();

          if (StringUtils.isBlank(memberId )) {
            return false;
          }
        }
        
        Group group = RuleUtils.group(ruleDefinition.getIfCondition().getIfOwnerId(), 
            ruleDefinition.getIfCondition().getIfOwnerName(), ruleDefinition.getAttributeAssignType().getOwnerGroupId(), false, true);
        String groupId = group.getId();
        
        Set&lt;Membership&gt; memberships = GrouperDAOFactory.getFactory().getMembership()
          .findAllByGroupOwnerAndFieldAndMemberIdsAndType(
              groupId, Group.getDefaultList(), 
              GrouperUtil.toSet(memberId), &quot;immediate&quot;, true);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1329">1329</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1502">1502</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      RuleCheck ruleCheck = ruleDefinition.getCheck();
      if (StringUtils.isBlank(ruleCheck.getCheckOwnerId()) &amp;&amp; StringUtils.isBlank(ruleCheck.getCheckOwnerName())) {
        //if this is assigned to a group
        if (!StringUtils.isBlank(ruleDefinition.getAttributeAssignType().getOwnerGroupId())) {

          //clone so we dont edit the object
          ruleCheck = ruleCheck.clone();
          //set the owner to this group
          ruleCheck.setCheckOwnerId(ruleDefinition.getAttributeAssignType().getOwnerGroupId());
        } else {
          LOG.error(&quot;Not sure why no check owner if not assigned to group&quot;);
        }
      }
      return ruleCheck;
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#ruleDefinitions(edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public Set&lt;RuleDefinition&gt; ruleDefinitions(RuleEngine ruleEngine, RulesBean rulesBean) {
      
      return ruleDefinitionsMembership(this, ruleEngine, rulesBean);
      
    }
  
    /**
     * 
     */
    @Override
    public void addElVariables(RuleDefinition ruleDefinition, Map&lt;String, Object&gt; variableMap, 
        RulesBean rulesBean, boolean hasAccessToElApi) {
      flattenedMembershipRemove.addElVariables(ruleDefinition, variableMap, rulesBean, hasAccessToElApi);
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#validate(RuleDefinition, edu.internet2.middleware.grouper.rules.RuleCheck)
     */
    @Override
    public String validate(RuleDefinition ruleDefinition, RuleCheck ruleCheck) {
      return this.validate(false, ruleDefinition, ruleCheck, false, true, false, false);
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#isCheckOwnerTypeAttributeDef(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isCheckOwnerTypeAttributeDef(RuleDefinition ruleDefinition) {
      return false;
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#isCheckOwnerTypeGroup(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isCheckOwnerTypeGroup(RuleDefinition ruleDefinition) {
      return true;
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#isCheckOwnerTypeStem(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isCheckOwnerTypeStem(RuleDefinition ruleDefinition) {
      return false;
    }
  }, </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L9174">9174</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L5963">5963</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  };

  /**
   * &lt;p&gt;Checks whether this &lt;code&gt;Throwable&lt;/code&gt; class can store a cause.&lt;/p&gt;
   *
   * &lt;p&gt;This method does &lt;b&gt;not&lt;/b&gt; check whether it actually does store a cause.&lt;p&gt;
   *
   * @param throwable  the &lt;code&gt;Throwable&lt;/code&gt; to examine, may be null
   * @return boolean &lt;code&gt;true&lt;/code&gt; if nested otherwise &lt;code&gt;false&lt;/code&gt;
   * @since 2.0
   */
  public static boolean isNestedThrowable(Throwable throwable) {
      if (throwable == null) {
          return false;
      }

      if (throwable instanceof Nestable) {
          return true;
      } else if (throwable instanceof SQLException) {
          return true;
      } else if (throwable instanceof InvocationTargetException) {
          return true;
      } else if (isThrowableNested()) {
          return true;
      }

      Class cls = throwable.getClass();
      for (int i = 0, isize = CAUSE_METHOD_NAMES.length; i &lt; isize; i++) {
          try {
              Method method = cls.getMethod(CAUSE_METHOD_NAMES[i], (Class[])null);
              if (method != null &amp;&amp; Throwable.class.isAssignableFrom(method.getReturnType())) {
                  return true;
              }
          } catch (NoSuchMethodException ignored) {
          } catch (SecurityException ignored) {
          }
      }

      try {
          Field field = cls.getField(&quot;detail&quot;);
          if (field != null) {
              return true;
          }
      } catch (NoSuchFieldException ignored) {
      } catch (SecurityException ignored) {
      }

      return false;
  }

  /**
   * &lt;p&gt;The Method object for JDK1.4 getCause.&lt;/p&gt;
   */
  private static final Method THROWABLE_CAUSE_METHOD;
  static {
      Method getCauseMethod;
      try {
          getCauseMethod = Throwable.class.getMethod(&quot;getCause&quot;, (Class[])null);
      } catch (Exception e) {
          getCauseMethod = null;
      }
      THROWABLE_CAUSE_METHOD = getCauseMethod;
  }

  /**
   * &lt;p&gt;Checks if the Throwable class has a &lt;code&gt;getCause&lt;/code&gt; method.&lt;/p&gt;
   *
   * &lt;p&gt;This is true for JDK 1.4 and above.&lt;/p&gt;
   *
   * @return true if Throwable is nestable
   * @since 2.0
   */
  public static boolean isThrowableNested() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L491">491</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignActionSet.html#L281">281</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefNameSet.html#L279">279</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITRoleSet.html#L280">280</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    if (!this.isActive() &amp;&amp; this.dbVersion().isActive() &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }
  }
  
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPostSave(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPostSave(HibernateSession hibernateSession) {
    
    // add change log entry for permissions
    if (this.isActive() &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L10384">10384</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L5230">5230</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * Return the zero element of the list, if it exists, null if the list is empty.
   * If there is more than one element in the list, an exception is thrown.
   * @param &lt;T&gt;
   * @param list is the container of objects to get the first of.
   * @return the first object, null, or exception.
   */
  public static &lt;T&gt; T listPopOne(List&lt;T&gt; list) {
    int size = length(list);
    if (size == 1) {
      return list.get(0);
    } else if (size == 0) {
      return null;
    }
    throw new RuntimeException(&quot;More than one object of type &quot; + className(list.get(0))
        + &quot; was returned when only one was expected. (size:&quot; + size +&quot;)&quot; );
  }

  /**
   * Return the zero element of the set, if it exists, null if the list is empty.
   * If there is more than one element in the list, an exception is thrown.
   * @param &lt;T&gt;
   * @param set is the container of objects to get the first of.
   * @return the first object, null, or exception.
   */
  public static &lt;T&gt; T setPopOne(Set&lt;T&gt; set) {
    int size = length(set);
    if (size == 1) {
      return set.iterator().next();
    } else if (size == 0) {
      return null;
    }
    throw new RuntimeException(&quot;More than one object of type &quot; + className(set.iterator().next())
        + &quot; was returned when only one was expected. (size:&quot; + size +&quot;)&quot; );
  }

  /**
   * Return the zero element of the list, if it exists, null if the list is empty.
   * If there is more than one element in the list, an exception is thrown.
   * @param &lt;T&gt;
   * @param collection is the container of objects to get the first of.
   * @param exceptionIfMoreThanOne will throw exception if there is more than one item in list
   * @return the first object, null, or exception.
   */
  public static &lt;T&gt; T collectionPopOne(Collection&lt;T&gt; collection, boolean exceptionIfMoreThanOne) {
    int size = length(collection);
    if (size &gt; 1 &amp;&amp; exceptionIfMoreThanOne) {
      throw new RuntimeException(&quot;More than one object of type &quot; + className(get(collection, 0))
          + &quot; was returned when only one was expected. (size:&quot; + size +&quot;)&quot; );
    }
    if (size == 0) {
      return null;
    }
    return collection.iterator().next();
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignActionSet.html#L281">281</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignActionSet.html#L319">319</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefNameSet.html#L279">279</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefNameSet.html#L317">317</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITRoleSet.html#L280">280</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITRoleSet.html#L318">318</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    if (!this.isActive() &amp;&amp; this.dbVersion().isActive() &amp;&amp; this.getDepth() == 1 &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L530">530</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignActionSet.html#L319">319</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefNameSet.html#L317">317</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITRoleSet.html#L318">318</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    if (this.isActive() &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }
    
    super.onPostSave(hibernateSession);
  }
  

  
  /**
   * save the state when retrieving from DB
   * @return the dbVersion
   */
  @Override
  public PITAttributeAssign dbVersion() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L1978">1978</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L2060">2060</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          gtt, GroupTypeTuple.class, VetoTypeGrouper.GROUP_TYPE_TUPLE_PRE_DELETE, false, false);
    }
    
    String ownerId1 = null;
    String ownerId2 = null;
    
    AttributeAssignType ownerType = this.getAttributeAssignType();
    if (AttributeAssignType.group == ownerType) {
      ownerId1 = this.getOwnerGroupId();
    } else if (AttributeAssignType.stem == ownerType) {
      ownerId1 = this.getOwnerStemId();
    } else if (AttributeAssignType.member == ownerType) {
      ownerId1 = this.getOwnerMemberId();
    } else if (AttributeAssignType.attr_def == ownerType) {
      ownerId1 = this.getOwnerAttributeDefId();
    } else if (AttributeAssignType.any_mem == ownerType) {
      ownerId1 = this.getOwnerGroupId();
      ownerId2 = this.getOwnerMemberId();
    } else if (AttributeAssignType.imm_mem == ownerType) {
      ownerId1 = this.getOwnerMembershipId();
    } else if (this.getOwnerAttributeAssignId() != null) {
      ownerId1 = this.getOwnerAttributeAssignId();
    } else {
      throw new RuntimeException(&quot;Unexpected ownerType: &quot; + ownerType);
    }
    
    // may need to delete group sets if we're unassigning a group type.  also change log entry.
    if (gtt != null) {
      // ok this is really a group type unassignment
      
      Group group = gtt.retrieveGroup(true);
      GroupType groupType = GroupTypeFinder.findByUuid(gtt.getTypeUuid(), true);
      Set&lt;Field&gt; fields = FieldFinder.findAllByGroupType(groupType);
      for (Field field : fields) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L530">530</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L676">676</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    if (!this.isActive() &amp;&amp; this.dbVersion().isActive() &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }
    
    // add change log entry for flat memberships
    if (!this.isActive() &amp;&amp; this.dbVersion().isActive() &amp;&amp; (this.getFlatMembershipNotificationsOnSaveOrUpdate() || this.getFlatPrivilegeNotificationsOnSaveOrUpdate())) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\audit\AuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditEntry.html#L562">562</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAuditEntry.html#L224">224</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditEntry.html#L319">319</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public String getAuditTypeId() {
    return this.auditTypeId;
  }

  /**
   * foreign key to the type of audit entry this is
   * @param auditTypeId1
   */
  public void setAuditTypeId(String auditTypeId1) {
    this.auditTypeId = auditTypeId1;
  }

  /**
   * primary key uuid of this record
   * @return the id
   */
  public String getId() {
    return this.id;
  }

  /**
   * primary key uuid of this record
   * @param id1
   */
  public void setId(String id1) {
    this.id = id1;
  }

  /**
   * member uuid of the user being acted as
   * @return uuid
   */
  public String getActAsMemberId() {
    return this.actAsMemberId;
  }

  /**
   * context id ties multiple db changes
   * @return id
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * member uuid of the user logged in to grouper ui or ws etc
   * @return uuid
   */
  public String getLoggedInMemberId() {
    return this.loggedInMemberId;
  }

  /**
   * host of the server that executed the transaction
   * @return host
   */
  public String getServerHost() {
    return this.serverHost;
  }

  /**
   * ip address of user (from WS or UI etc)
   * @return user ip address
   */
  public String getUserIpAddress() {
    return this.userIpAddress;
  }

  /**
   * member uuid of the user being acted as
   * @param actAsMemberUuid1
   */
  public void setActAsMemberId(String actAsMemberUuid1) {
    this.actAsMemberId = actAsMemberUuid1;
  }

  /**
   * context id ties multiple db changes
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }

  /**
   * member uuid of the user logged in to grouper ui or ws etc
   * @param loggedInMemberUuid
   */
  public void setLoggedInMemberId(String loggedInMemberUuid) {
    this.loggedInMemberId = loggedInMemberUuid;
  }

  /**
   * host of the server that executed the transaction
   * @param serverHost1
   */
  public void setServerHost(String serverHost1) {
    this.serverHost = serverHost1;
  }

  /**
   * ip address of user (from WS or UI etc)
   * @param userIpAddress1
   */
  public void setUserIpAddress(String userIpAddress1) {
    this.userIpAddress = userIpAddress1;
  }

  /**
   * env label from grouper.properties
   * @return env label
   */
  public String getEnvName() {
    return this.envName;
  }

  /**
   * env label from grouper.properties
   * @param envLabel1
   */
  public void setEnvName(String envLabel1) {
    this.envName = envLabel1;
  }

  /**
   * WS, UI, loader, GSH, etc
   * @return grouper system
   */
  public String getGrouperEngine() {
    return this.grouperEngine;
  }

  /**
   * WS, UI, loader, GSH, etc
   * @param grouperSystem1
   */
  public void setGrouperEngine(String grouperSystem1) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L491">491</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L530">530</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L530">530</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L676">676</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (!this.isActive() &amp;&amp; this.dbVersion().isActive() &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L149">149</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogType.html#L196">196</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      .append(this.labelString08, auditType.labelString08).isEquals();
      
  }
  
  /**
   * labels for this type
   * @return the labels
   */
  public Set&lt;String&gt; labels() {
    Set&lt;String&gt; labels = new LinkedHashSet&lt;String&gt;();
    if (!StringUtils.isBlank(this.labelString01)) {
      labels.add(this.labelString01);
    }
    if (!StringUtils.isBlank(this.labelString02)) {
      labels.add(this.labelString02);
    }
    if (!StringUtils.isBlank(this.labelString03)) {
      labels.add(this.labelString03);
    }
    if (!StringUtils.isBlank(this.labelString04)) {
      labels.add(this.labelString04);
    }
    if (!StringUtils.isBlank(this.labelString05)) {
      labels.add(this.labelString05);
    }
    if (!StringUtils.isBlank(this.labelString06)) {
      labels.add(this.labelString06);
    }
    if (!StringUtils.isBlank(this.labelString07)) {
      labels.add(this.labelString07);
    }
    if (!StringUtils.isBlank(this.labelString08)) {
      labels.add(this.labelString08);
    }

    if (!StringUtils.isBlank(this.labelInt01)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Group.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Group.html#L7445">7445</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Stem.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Stem.html#L4468">4468</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * @see GrouperObject#matchesLowerSearchStrings(Set)
   */
  @Override
  public boolean matchesLowerSearchStrings(Set&lt;String&gt; filterStrings) {

    if (GrouperUtil.length(filterStrings) == 0) {
      return true;
    }

    String lowerId = this.getId().toLowerCase();
    String lowerName = StringUtils.defaultString(this.getName()).toLowerCase();
    String lowerDisplayName = StringUtils.defaultString(this.getDisplayName()).toLowerCase();
    String lowerDescription = StringUtils.defaultString(this.getDescription()).toLowerCase();
    String lowerAlternateName = StringUtils.defaultString(this.getAlternateName()).toLowerCase();
    
    for (String filterString : GrouperUtil.nonNull(filterStrings)) {
      
      //if all dont match, return false
      if (!lowerId.contains(filterString)
          &amp;&amp; !lowerName.contains(filterString)
          &amp;&amp; !lowerDisplayName.contains(filterString)
          &amp;&amp; !lowerDescription.contains(filterString)
          &amp;&amp; !lowerAlternateName.contains(filterString)) {
        return false;
      }
      
    }
    return true;
  }

  /**
   * see if the subject has a privilege or another privilege that implies this privilege.
   * @param subject
   * @param privilegeOrListName
   * @param secure if the user must be an admin to check
   * @return true if has privilege
   */
  public boolean canHavePrivilege(Subject subject, String privilegeOrListName, boolean secure) {
    
    GrouperSession grouperSession = GrouperSession.staticGrouperSession();
    
    if (secure) {
      PrivilegeHelper.dispatch(grouperSession, this, grouperSession.getSubject(), AccessPrivilege.ADMIN);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L805">805</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L2344">2344</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                    stemScope, true, null, true, false);

                for (PermissionEntry permissionEntry : GrouperUtil.nonNull(permissionEntries)) {

                  
                  //must be immediate so it can be unassigned
                  if (permissionEntry.isImmediate(permissionEntry.getPermissionType())) {
                    
                    AttributeAssign attributeAssign = AttributeAssignFinder.findById(permissionEntry.getAttributeAssignId(), false);
                    
                    if (attributeAssign == null) {
                      continue;
                    }
                    
                    Role role = GroupFinder.findByUuid(GrouperSession.staticGrouperSession(), permissionEntry.getRoleId(), false);
                    if (role == null) {
                      continue;
                    }
                    Member member = MemberFinder.findByUuid(GrouperSession.staticGrouperSession(), permissionEntry.getMemberId(), false);
                    if (member == null) {
                      continue;
                    }
                    AttributeDefName attributeDefName = GrouperDAOFactory.getFactory().getAttributeDefName().findByIdSecure(permissionEntry.getAttributeDefNameId(), false);
                    if (attributeDefName == null) {
                      continue;
                    }
                    RulesPermissionBean rulesPermissionBean = new RulesPermissionBean(attributeAssign, role, member, attributeDefName, attributeDefName.getAttributeDef(), permissionEntry.getAction());
                    theRulesPermissionBeans.add(rulesPermissionBean);
                  }

                }
              
                
                return theRulesPermissionBeans;
                
              }
            });

          for (RulesPermissionBean rulesPermissionBean : rulesPermissionBeans) {
            
            //fire the rule then clause
            RuleEngine.ruleFirings++;
            
            ruleDefinition.getThen().fireRule(ruleDefinition, ruleEngine, rulesPermissionBean, null);

          }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L491">491</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignActionSet.html#L319">319</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefNameSet.html#L317">317</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITRoleSet.html#L318">318</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (!this.isActive() &amp;&amp; this.dbVersion().isActive() &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L530">530</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignActionSet.html#L281">281</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefNameSet.html#L279">279</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L530">530</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L676">676</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITRoleSet.html#L280">280</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (this.isActive() &amp;&amp; this.getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate()) {
      Set&lt;ChangeLogEntry&gt; changeLogEntryBatch = new LinkedHashSet&lt;ChangeLogEntry&gt;();
      int batchSize = GrouperConfig.getHibernatePropertyInt(&quot;hibernate.jdbc.batch_size&quot;, 20);
      if (batchSize &lt;= 0) {
        batchSize = 1;
      }

      Set&lt;PITGroup&gt; roles = GrouperDAOFactory.getFactory().getPITGroup().findRolesWithPermissionsContainingObject(this);

      for (PITGroup role : roles) {
        ChangeLogEntry changeLogEntry = new ChangeLogEntry(false, ChangeLogTypeBuiltin.PERMISSION_CHANGE_ON_ROLE,
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleId.name(), role.getSourceId(),
            ChangeLogLabels.PERMISSION_CHANGE_ON_ROLE.roleName.name(), role.getName());
            
        changeLogEntry.setContextId(this.getContextId());
        changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
        changeLogEntryBatch.add(changeLogEntry);
        if (changeLogEntryBatch.size() % batchSize == 0) {
          GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
          changeLogEntryBatch.clear();
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITGroupSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroupSet.html#L581">581</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L495">495</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>              ChangeLogLabels.PRIVILEGE_ADD.sourceId.name(), pitMembership.getMember().getSubjectSourceId(),
              ChangeLogLabels.PRIVILEGE_ADD.privilegeType.name(), privilegeType,
              ChangeLogLabels.PRIVILEGE_ADD.ownerType.name(), ownerType,
              ChangeLogLabels.PRIVILEGE_ADD.ownerId.name(), ownerId,
              ChangeLogLabels.PRIVILEGE_ADD.membershipType.name(), &quot;flattened&quot;,
              ChangeLogLabels.PRIVILEGE_ADD.ownerName.name(), ownerName);
        }

        if (changeLogEntry != null) {
          changeLogEntry.setContextId(this.getContextId());
          changeLogEntry.setCreatedOnDb(this.getStartTimeDb());
          changeLogEntryBatch.add(changeLogEntry);
          
          if (changeLogEntryBatch.size() % batchSize == 0) {
            GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
            changeLogEntryBatch.clear();
          }
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }
  }
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPreUpdate(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPreUpdate(HibernateSession hibernateSession) {
    super.onPreUpdate(hibernateSession);
    
    // add change log entry for flat memberships
    if (!this.isActive() &amp;&amp; this.dbVersion().isActive() &amp;&amp; (this.getFlatMembershipNotificationsOnSaveOrUpdate() || this.getFlatPrivilegeNotificationsOnSaveOrUpdate())) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1413">1413</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2822">2822</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefAssignToIdsSize &gt; 0) {
      sql.append(&quot; and aa.ownerAttributeDefId in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefAssignToIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefIdsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefNameIdsSize &gt; 0) {
      sql.append(&quot; and adn.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefNameIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    byHqlStatic
      .setCacheable(false)
      .setCacheRegion(KLASS + &quot;.FindAttributeDefAttributeAssignments&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L289">289</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignValueView.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignValueView.html#L169">169</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * @return ownerAttributeAssignId
   */
  public String getOwnerAttributeAssignId() {
    return ownerAttributeAssignId;
  }

  /**
   * @param ownerAttributeAssignId
   */
  public void setOwnerAttributeAssignId(String ownerAttributeAssignId) {
    this.ownerAttributeAssignId = ownerAttributeAssignId;
  }

  /**
   * @return ownerAttributeDefId
   */
  public String getOwnerAttributeDefId() {
    return ownerAttributeDefId;
  }

  /**
   * @param ownerAttributeDefId
   */
  public void setOwnerAttributeDefId(String ownerAttributeDefId) {
    this.ownerAttributeDefId = ownerAttributeDefId;
  }

  /**
   * @return ownerGroupId
   */
  public String getOwnerGroupId() {
    return ownerGroupId;
  }

  /**
   * @param ownerGroupId
   */
  public void setOwnerGroupId(String ownerGroupId) {
    this.ownerGroupId = ownerGroupId;
  }

  /**
   * @return ownerMemberId
   */
  public String getOwnerMemberId() {
    return ownerMemberId;
  }

  /**
   * @param ownerMemberId
   */
  public void setOwnerMemberId(String ownerMemberId) {
    this.ownerMemberId = ownerMemberId;
  }

  /**
   * @return ownerMembershipId
   */
  public String getOwnerMembershipId() {
    return ownerMembershipId;
  }

  /**
   * @param ownerMembershipId
   */
  public void setOwnerMembershipId(String ownerMembershipId) {
    this.ownerMembershipId = ownerMembershipId;
  }

  /**
   * @return ownerStemId
   */
  public String getOwnerStemId() {
    return ownerStemId;
  }

  /**
   * @param ownerStemId
   */
  public void setOwnerStemId(String ownerStemId) {
    this.ownerStemId = ownerStemId;
  }

  /**
   * @return attributeAssignActionId
   */
  public String getAttributeAssignActionId() {
    return attributeAssignActionId;
  }

  /**
   * @param attributeAssignActionId
   */
  public void setAttributeAssignActionId(String attributeAssignActionId) {
    this.attributeAssignActionId = attributeAssignActionId;
  }

  /**
   * @return attributeAssignType
   */
  public String getAttributeAssignTypeDb() {
    return attributeAssignType;
  }

  /**
   * @param attributeAssignType
   */
  public void setAttributeAssignTypeDb(String attributeAssignType) {
    this.attributeAssignType = attributeAssignType;
  }

  /**
   * @return attributeDefNameId
   */
  public String getAttributeDefNameId() {
    return attributeDefNameId;
  }

  /**
   * @param attributeDefNameId
   */
  public void setAttributeDefNameId(String attributeDefNameId) {
    this.attributeDefNameId = attributeDefNameId;
  }

  /**
   * save this object
   */
  public void save() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\MembershipFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/MembershipFinder.html#L1644">1644</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\MembershipFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/MembershipFinder.html#L2430">2430</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      while (it.hasNext()) {
        try {
          subjs.add(new LazySubject(it.next()));
        } catch (GrouperException gre) {
          if (gre.getCause() instanceof MemberNotFoundException) {
            throw (MemberNotFoundException) gre.getCause();
          }
          if (gre.getCause() instanceof SubjectNotFoundException) {
            throw (SubjectNotFoundException) gre.getCause();
          }
        }
      }
    } catch (MemberNotFoundException eMNF) {
      String msg = &quot;internal_findGroupSubjectsImmediateOnly: &quot; + eMNF.getMessage();
      LOG.fatal(msg);
      throw new GrouperException(msg, eMNF);
    } catch (SubjectNotFoundException eSNF) {
      String msg = &quot;internal_findGroupSubjectsImmediateOnly: &quot; + eSNF.getMessage();
      LOG.fatal(msg);
      throw new GrouperException(msg, eSNF);
    } catch (InsufficientPrivilegeException e) {
      String msg = &quot;internal_findGroupSubjectsImmediateOnly: &quot; + e.getMessage();
      LOG.fatal(msg);
      throw new GrouperException(msg, e);
    } catch (SchemaException e) {
      String msg = &quot;internal_findGroupSubjectsImmediateOnly: &quot; + e.getMessage();
      LOG.fatal(msg);
      throw new GrouperException(msg, e);
    }
    return subjs;
  } 
  
  /**
   * 
   * @param s
   * @param stem
   * @param f
   * @return set of subjects
   * @throws GrouperException
   */
  public static Set&lt;Subject&gt; internal_findStemSubjectsImmediateOnly(GrouperSession s,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditEntry.html#L52">52</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditEntry.html#L34">34</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>public class AuditEntry extends GrouperAPI implements Hib3GrouperVersioned, XmlImportable&lt;AuditEntry&gt; {
  
  //*****  START GENERATED WITH GenerateFieldConstants.java *****//

  /** constant for field name for: actAsMemberId */
  public static final String FIELD_ACT_AS_MEMBER_ID = &quot;actAsMemberId&quot;;

  /** constant for field name for: auditTypeId */
  public static final String FIELD_AUDIT_TYPE_ID = &quot;auditTypeId&quot;;

  /** constant for field name for: contextId */
  public static final String FIELD_CONTEXT_ID = &quot;contextId&quot;;

  /** constant for field name for: createdOnDb */
  public static final String FIELD_CREATED_ON_DB = &quot;createdOnDb&quot;;

  /** constant for field name for: description */
  public static final String FIELD_DESCRIPTION = &quot;description&quot;;

  /** constant for field name for: durationMicroseconds */
  public static final String FIELD_DURATION_MICROSECONDS = &quot;durationMicroseconds&quot;;

  /** constant for field name for: envName */
  public static final String FIELD_ENV_NAME = &quot;envName&quot;;

  /** constant for field name for: grouperEngine */
  public static final String FIELD_GROUPER_ENGINE = &quot;grouperEngine&quot;;

  /** constant for field name for: grouperVersion */
  public static final String FIELD_GROUPER_VERSION = &quot;grouperVersion&quot;;

  /** constant for field name for: id */
  public static final String FIELD_ID = &quot;id&quot;;

  /** constant for field name for: int01 */
  public static final String FIELD_INT01 = &quot;int01&quot;;

  /** constant for field name for: int02 */
  public static final String FIELD_INT02 = &quot;int02&quot;;

  /** constant for field name for: int03 */
  public static final String FIELD_INT03 = &quot;int03&quot;;

  /** constant for field name for: int04 */
  public static final String FIELD_INT04 = &quot;int04&quot;;

  /** constant for field name for: int05 */
  public static final String FIELD_INT05 = &quot;int05&quot;;

  /** constant for field name for: lastUpdatedDb */
  public static final String FIELD_LAST_UPDATED_DB = &quot;lastUpdatedDb&quot;;

  /** constant for field name for: loggedInMemberId */
  public static final String FIELD_LOGGED_IN_MEMBER_ID = &quot;loggedInMemberId&quot;;

  /** constant for field name for: queryCount */
  public static final String FIELD_QUERY_COUNT = &quot;queryCount&quot;;

  /** constant for field name for: serverHost */
  public static final String FIELD_SERVER_HOST = &quot;serverHost&quot;;

  /** constant for field name for: serverUserName */
  public static final String FIELD_SERVER_USER_NAME = &quot;serverUserName&quot;;

  /** constant for field name for: string01 */
  public static final String FIELD_STRING01 = &quot;string01&quot;;

  /** constant for field name for: string02 */
  public static final String FIELD_STRING02 = &quot;string02&quot;;

  /** constant for field name for: string03 */
  public static final String FIELD_STRING03 = &quot;string03&quot;;

  /** constant for field name for: string04 */
  public static final String FIELD_STRING04 = &quot;string04&quot;;

  /** constant for field name for: string05 */
  public static final String FIELD_STRING05 = &quot;string05&quot;;

  /** constant for field name for: string06 */
  public static final String FIELD_STRING06 = &quot;string06&quot;;

  /** constant for field name for: string07 */
  public static final String FIELD_STRING07 = &quot;string07&quot;;

  /** constant for field name for: string08 */
  public static final String FIELD_STRING08 = &quot;string08&quot;;

  /** constant for field name for: userIpAddress */
  public static final String FIELD_USER_IP_ADDRESS = &quot;userIpAddress&quot;;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L350">350</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L708">708</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  groupHasNoImmediateEnabledMembership {

    /**
     * 
     */
    @Override
    public boolean shouldFire(RuleDefinition ruleDefinition, RuleEngine ruleEngine,
        RulesBean rulesBean) {
      
      String memberId = null;
      try {
        memberId = rulesBean.getMemberId();
      } catch (Exception e) {
        //ignore
      }
      
      GrouperSession rootSession = GrouperSession.startRootSession(false);
      try {
        
        if (StringUtils.isBlank(memberId)) {
          
          Member member = MemberFinder.findBySubject(rootSession, rulesBean.getSubject(), false);
          memberId = member == null ? null : member.getUuid();

          if (StringUtils.isBlank(memberId )) {
            return false;
          }
        }
        Group group = RuleUtils.group(ruleDefinition.getIfCondition().getIfOwnerId(), 
            ruleDefinition.getIfCondition().getIfOwnerName(), ruleDefinition.getAttributeAssignType().getOwnerGroupId(), false, false);
        if (group == null) {
          LOG.error(&quot;Group doesnt exist in rule! &quot; + ruleDefinition);
          return false;
        }
        String groupId = group.getId();
        
        Set&lt;Membership&gt; memberships = GrouperDAOFactory.getFactory().getMembership()
          .findAllByGroupOwnerAndFieldAndMemberIdsAndType(
              groupId, Group.getDefaultList(), 
              GrouperUtil.toSet(memberId), &quot;immediate&quot;, true);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\bench\Add100EffMembers.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/bench/Add100EffMembers.html#L74">74</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\bench\Add10EffMembers.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/bench/Add10EffMembers.html#L74">74</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  protected Add100EffMembers() {
    super();
  } // protected Add100EffMembers()

  // PUBLIC INSTANCE METHODS //

  /**
   * @since 1.1.0
   */
  public void init() 
    throws GrouperException 
  {
    try {
      GrouperSession  s     = GrouperSession.start( SubjectFinder.findRootSubject() );
      Stem            root  = StemFinder.findRootStem(s);
      Stem            ns    = root.addChildStem(&quot;example&quot;, &quot;example&quot;);
      this.g0               = ns.addChildGroup(&quot;group 0&quot;, &quot;group 0&quot;);
      this.g1               = ns.addChildGroup(&quot;group 1&quot;, &quot;group 1&quot;);
      String          type  = &quot;person&quot;;
      for (int i=0; i &lt; CNT; i++) {
        String id = &quot;subj&quot; + i;
        RegistrySubject.add(s, id, type, &quot;subject &quot; + i);
        subjects[i] = SubjectFinder.findById(id, true);
        this.g0.addMember( subjects[i] );
      }
      this.g_subj = this.g0.toSubject();
    }
    catch (Exception e) {
      throw new GrouperException(e.getMessage());
    }
  } // public void init()

  /**
   * @since 1.1.0
   */
  public void run() 
    throws GrouperException 
  {
    try {
      this.g1.addMember(this.g_subj);
    }
    catch (Exception e) {
      throw new GrouperException(e);
    }
  } // public void run()

} // public class Add100EffMembers</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L646">646</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L562">562</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            group.getId(), membershipType, fields, null, true, queryOptions);
        
        if (LOG.isDebugEnabled()) {
          debugLog.put(&quot;membershipsSize&quot;, GrouperUtil.length(memberships));
        }
  
      }
      
      //lets non-null it
      memberships = GrouperUtil.nonNull(memberships);
      
      //lets put it all back together...
      Set&lt;PrivilegeSubjectContainer&gt; results = new LinkedHashSet&lt;PrivilegeSubjectContainer&gt;();
      Map&lt;MultiKey, PrivilegeSubjectContainerImpl&gt; resultsMap = new HashMap&lt;MultiKey, PrivilegeSubjectContainerImpl&gt;();
      
  
      //now we need to factor in the additionals
      if (GrouperUtil.length(additionalMembers) &gt; 0) {
        
        if (GrouperUtil.length(additionalMembers) &gt; 0) {
          
          //lets get the memberships for these members
          List&lt;String&gt; memberIds = new ArrayList&lt;String&gt;();
          for (Member member : additionalMembers) {
            memberIds.add(member.getUuid());
            
            //put in a placeholder
            PrivilegeSubjectContainerImpl privilegeSubjectContainerImpl = new PrivilegeSubjectContainerImpl();
            privilegeSubjectContainerImpl.setSubject(new LazySubject(member));
            results.add(privilegeSubjectContainerImpl);
            MultiKey multiKey = new MultiKey(member.getSubjectSourceId(), member.getSubjectId());
            resultsMap.put(multiKey, privilegeSubjectContainerImpl);
            
          }
          //note, we arent paging here...
          //get those results
          Set&lt;Object[]&gt; additionalMemberships = GrouperDAOFactory.getFactory().getMembership().findAllByGroupOwnerOptions(</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L459">459</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogConsumer.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogConsumer.html#L155">155</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogType.html#L512">512</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }

  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }

  /**
   * 
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPreSave(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPreSave(HibernateSession hibernateSession) {
    super.onPreSave(hibernateSession);
    if (this.createdOnDb == null) {
      this.createdOnDb = System.currentTimeMillis();
    }
    if (this.lastUpdatedDb == null) {
      this.lastUpdatedDb = System.currentTimeMillis();
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\ddl\GrouperDdl.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/ddl/GrouperDdl.html#L9171">9171</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\ddl\GrouperDdl.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/ddl/GrouperDdl.html#L9346">9346</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\ddl\GrouperDdl.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/ddl/GrouperDdl.html#L9519">9519</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        &quot;grouper_pit_perms_role_v: shows all permissions assigned to users due to the users being in a role, and the role being assigned the permission&quot;,
        GrouperUtil.toSet(&quot;role_name&quot;, 
            &quot;subject_source_id&quot;, 
            &quot;subject_id&quot;,
            &quot;action&quot;, 
            &quot;attribute_def_name_name&quot;,
            &quot;role_id&quot;,
            &quot;attribute_def_id&quot;,
            &quot;member_id&quot;, 
            &quot;attribute_def_name_id&quot;,
            &quot;action_id&quot;,
            &quot;membership_depth&quot;,
            &quot;role_set_depth&quot;,
            &quot;attr_def_name_set_depth&quot;,
            &quot;attr_assign_action_set_depth&quot;,
            &quot;membership_id&quot;,
            &quot;group_set_id&quot;, 
            &quot;role_set_id&quot;,
            &quot;attribute_def_name_set_id&quot;,
            &quot;action_set_id&quot;,
            &quot;attribute_assign_id&quot;,
            &quot;permission_type&quot;,
            &quot;group_set_active&quot;, 
            &quot;group_set_start_time&quot;, 
            &quot;group_set_end_time&quot;, 
            &quot;membership_active&quot;, 
            &quot;membership_start_time&quot;, 
            &quot;membership_end_time&quot;,
            &quot;role_set_active&quot;,
            &quot;role_set_start_time&quot;,
            &quot;role_set_end_time&quot;,
            &quot;action_set_active&quot;,
            &quot;action_set_start_time&quot;,
            &quot;action_set_end_time&quot;,
            &quot;attr_def_name_set_active&quot;,
            &quot;attr_def_name_set_start_time&quot;,
            &quot;attr_def_name_set_end_time&quot;,
            &quot;attribute_assign_active&quot;,
            &quot;attribute_assign_start_time&quot;,
            &quot;attribute_assign_end_time&quot;,
            &quot;disallowed&quot;,
            &quot;action_source_id&quot;,
            &quot;role_source_id&quot;,
            &quot;attribute_def_name_source_id&quot;,
            &quot;attribute_def_source_id&quot;,
            &quot;member_source_id&quot;,
            &quot;membership_source_id&quot;,
            &quot;attribute_assign_source_id&quot;
            ),
        GrouperUtil.toSet(&quot;role_name: name of the role that the user is in and that has the permission&quot;,
            &quot;subject_source_id: source id of the subject which is in the role and thus has the permission&quot;,
            &quot;subject_id: subject id of the subject which is in the role and thus has the permission&quot;,
            &quot;action: the action associated with the attribute assignment (default is assign)&quot;,
            &quot;attribute_def_name_name: name of the attribute definition name which is assigned to the group&quot;,
            &quot;role_id: id of role the subject is in, and that the permissions are assigned to&quot;,
            &quot;attribute_def_id: id of the attribute definition&quot;,
            &quot;member_id: id of the subject in the members table&quot;,
            &quot;attribute_def_name_id: id of the attribute definition name&quot;,
            &quot;action_id: id of the attribute assign action&quot;,
            &quot;membership_depth: depth of membership, 0 is immediate&quot;,
            &quot;role_set_depth: depth of role hierarchy, 0 is immediate&quot;,
            &quot;attr_def_name_set_depth: depth of attribute def name set hierarchy, 0 is immediate&quot;,
            &quot;attr_assign_action_set_depth: depth of action hierarchy, 0 is immediate&quot;,
            &quot;membership_id: id of the immediate or composite membership in grouper_pit_memberships&quot;, 
            &quot;group_set_id: id of the group set&quot;, 
            &quot;role_set_id: id of the role set&quot;,
            &quot;attribute_def_name_set_id: id of the attribute def name set&quot;,
            &quot;action_set_id: id of the action set&quot;,
            &quot;attribute_assign_id: id of the underlying attribute assign&quot;,
            &quot;permission_type: role or role_subject for assignment to role or to role subject pair&quot;,
            &quot;group_set_active: whether the group set is currently active&quot;, 
            &quot;group_set_start_time: start time of group set&quot;, 
            &quot;group_set_end_time: end time of group set&quot;, 
            &quot;membership_active: whether the membership is currently active&quot;, 
            &quot;membership_start_time: start time of membership&quot;, 
            &quot;membership_end_time: end time of membership&quot;,
            &quot;role_set_active: whether the role set is currently active&quot;,
            &quot;role_set_start_time: start time of role set&quot;,
            &quot;role_set_end_time: end time of role set&quot;,
            &quot;action_set_active: whether the action set is currently active&quot;,
            &quot;action_set_start_time: start time of action set&quot;,
            &quot;action_set_end_time: end time of action set&quot;,
            &quot;attr_def_name_set_active: whether the attribute def name set is currently active&quot;,
            &quot;attr_def_name_set_start_time: start time of attribute def name set&quot;,
            &quot;attr_def_name_set_end_time: end time of attribute def name set&quot;,
            &quot;attribute_assign_active: whether the attribute assign is currently active&quot;,
            &quot;attribute_assign_start_time: start time of attribute assign&quot;,
            &quot;attribute_assign_end_time: end time of attribute assign&quot;,
            &quot;disallowed: if permission is disallowed from a wider allow, null means false&quot;,
            &quot;action_source_id: id of the actual (non-pit) attribute assign action&quot;,
            &quot;role_source_id: id of the actual (non-pit) role the subject is in, and that the permissions are assigned to&quot;,
            &quot;attribute_def_name_source_id: id of the actual (non-pit) attribute definition name&quot;,
            &quot;attribute_def_source_id: id of the actual (non-pit) attribute definition&quot;,
            &quot;member_source_id: id of the actual (non-pit) subject in the members table&quot;,
            &quot;membership_source_id: id of the actual (non-pit) immediate or composite membership&quot;,
            &quot;attribute_assign_source_id: id of the actual (non-pit) attribute assign&quot;
        ),</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L1024">1024</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\value\AttributeAssignValue.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/value/AttributeAssignValue.html#L490">490</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * context id of the transaction
   * @return context id
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * context id of the transaction
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }

  /**
   * id of this attribute assign
   * @return id
   */
  public String getId() {
    return this.id;
  }

  /**
   * id of this attribute assign
   * @param id1
   */
  public void setId(String id1) {
    this.id = id1;
  }

  
  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }
  
  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }

  /**
   * notes about this assignment, free-form text
   * @return the notes
   */
  public String getNotes() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L640">640</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1497">1497</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  membershipRemove {

    /**
     * @see RuleCheckType#checkKey(RuleDefinition)
     */
    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      RuleCheck ruleCheck = ruleDefinition.getCheck();
      if (StringUtils.isBlank(ruleCheck.getCheckOwnerId()) &amp;&amp; StringUtils.isBlank(ruleCheck.getCheckOwnerName())) {
        //if this is assigned to a group
        if (!StringUtils.isBlank(ruleDefinition.getAttributeAssignType().getOwnerGroupId())) {

          //clone so we dont edit the object
          ruleCheck = ruleCheck.clone();
          //set the owner to this group
          ruleCheck.setCheckOwnerId(ruleDefinition.getAttributeAssignType().getOwnerGroupId());
        } else {
          LOG.error(&quot;Not sure why no check owner if not assigned to group&quot;);
        }
      }
      return ruleCheck;
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#ruleDefinitions(edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public Set&lt;RuleDefinition&gt; ruleDefinitions(RuleEngine ruleEngine, RulesBean rulesBean) {
      
      return ruleDefinitionsMembership(this, ruleEngine, rulesBean);
      
    }

    /**
     * 
     */
    @Override
    public void addElVariables(RuleDefinition ruleDefinition, Map&lt;String, Object&gt; variableMap, 
        RulesBean rulesBean, boolean hasAccessToElApi) {
      flattenedMembershipRemove.addElVariables(ruleDefinition, variableMap, rulesBean, hasAccessToElApi);
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#validate(RuleDefinition, edu.internet2.middleware.grouper.rules.RuleCheck)
     */
    @Override
    public String validate(RuleDefinition ruleDefinition, RuleCheck ruleCheck) {
      return this.validate(false, ruleDefinition, ruleCheck, false, true, false, false);
    }

    /**
     * 
     */
    @Override
    public void runDaemon(final RuleDefinition ruleDefinition) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L1136">1136</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L4029">4029</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            }
            
          }
                   
          Set&lt;Object[]&gt; results = byHqlStatic.createQuery(selectPrefix + sql.toString()).listSet(Object[].class);

          totalResults.addAll(results);
          
        }
      }
    }
    
    
    //nothing to filter
    if (GrouperUtil.length(totalResults) == 0) {
      return totalResults;
    }
    
    //if the hql didnt filter, we need to do that here
    Set&lt;Membership&gt; memberships = new LinkedHashSet&lt;Membership&gt;();
    for (Object[] objects : totalResults) {
      memberships.add((Membership)objects[0]);
    }
    int origMembershipsSize = memberships.size();
    Set&lt;Membership&gt; filteredMemberships = grouperSession.getAccessResolver().postHqlFilterMemberships(grouperSessionSubject, memberships);
    if (origMembershipsSize != filteredMemberships.size()) {
      
      //we have work to do
      Iterator&lt;Object[]&gt; iterator = totalResults.iterator();
      while (iterator.hasNext()) {
        Object[] row = iterator.next();
        Membership currentMembership = (Membership)row[0];
        //if not in the allowed list
        if (!filteredMemberships.contains(currentMembership)) {
          //remove the object row
          iterator.remove();
        }
      }
    }
    
    assignMembersOwnersToMemberships(totalResults);
    //we should be down to the cesure list
    return totalResults;
    
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L645">645</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1329">1329</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      RuleCheck ruleCheck = ruleDefinition.getCheck();
      if (StringUtils.isBlank(ruleCheck.getCheckOwnerId()) &amp;&amp; StringUtils.isBlank(ruleCheck.getCheckOwnerName())) {
        //if this is assigned to a group
        if (!StringUtils.isBlank(ruleDefinition.getAttributeAssignType().getOwnerGroupId())) {

          //clone so we dont edit the object
          ruleCheck = ruleCheck.clone();
          //set the owner to this group
          ruleCheck.setCheckOwnerId(ruleDefinition.getAttributeAssignType().getOwnerGroupId());
        } else {
          LOG.error(&quot;Not sure why no check owner if not assigned to group&quot;);
        }
      }
      return ruleCheck;
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#ruleDefinitions(edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public Set&lt;RuleDefinition&gt; ruleDefinitions(RuleEngine ruleEngine, RulesBean rulesBean) {
      
      return ruleDefinitionsMembership(this, ruleEngine, rulesBean);
      
    }

    /**
     * 
     */
    @Override
    public void addElVariables(RuleDefinition ruleDefinition, Map&lt;String, Object&gt; variableMap, 
        RulesBean rulesBean, boolean hasAccessToElApi) {
      flattenedMembershipRemove.addElVariables(ruleDefinition, variableMap, rulesBean, hasAccessToElApi);
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#validate(RuleDefinition, edu.internet2.middleware.grouper.rules.RuleCheck)
     */
    @Override
    public String validate(RuleDefinition ruleDefinition, RuleCheck ruleCheck) {
      return this.validate(false, ruleDefinition, ruleCheck, false, true, false, false);
    }

    /**
     * 
     */
    @Override
    public void runDaemon(final RuleDefinition ruleDefinition) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L805">805</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L2266">2266</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                    stemScope, true, null, true, false);

                for (PermissionEntry permissionEntry : GrouperUtil.nonNull(permissionEntries)) {

                  
                  //must be immediate so it can be unassigned
                  if (permissionEntry.isImmediate(permissionEntry.getPermissionType())) {
                    
                    AttributeAssign attributeAssign = AttributeAssignFinder.findById(permissionEntry.getAttributeAssignId(), false);
                    
                    if (attributeAssign == null) {
                      continue;
                    }
                    
                    Role role = GroupFinder.findByUuid(GrouperSession.staticGrouperSession(), permissionEntry.getRoleId(), false);
                    if (role == null) {
                      continue;
                    }
                    Member member = MemberFinder.findByUuid(GrouperSession.staticGrouperSession(), permissionEntry.getMemberId(), false);
                    if (member == null) {
                      continue;
                    }
                    AttributeDefName attributeDefName = GrouperDAOFactory.getFactory().getAttributeDefName().findByIdSecure(permissionEntry.getAttributeDefNameId(), false);
                    if (attributeDefName == null) {
                      continue;
                    }
                    RulesPermissionBean rulesPermissionBean = new RulesPermissionBean(attributeAssign, role, member, attributeDefName, attributeDefName.getAttributeDef(), permissionEntry.getAction());
                    theRulesPermissionBeans.add(rulesPermissionBean);
                  }

                }
              
                
                return theRulesPermissionBeans;
                
              }
            });

          for (RulesPermissionBean rulesPermissionBean : rulesPermissionBeans) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L3980">3980</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L1484">1484</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public static Object toArray(Object objectOrArrayOrCollection) {
    // do this before length since if array with null in it, we want ti get
    // it back
    if (objectOrArrayOrCollection != null
        &amp;&amp; objectOrArrayOrCollection.getClass().isArray()) {
      return objectOrArrayOrCollection;
    }
    int length = length(objectOrArrayOrCollection);
    if (length == 0) {
      return null;
    }

    if (objectOrArrayOrCollection instanceof Collection) {
      Collection collection = (Collection) objectOrArrayOrCollection;
      Object first = collection.iterator().next();
      return toArray(collection, first == null ? Object.class : first
          .getClass());
    }
    // make an array of the type of object passed in, size one
    Object array = Array.newInstance(objectOrArrayOrCollection.getClass(),
        1);
    Array.set(array, 0, objectOrArrayOrCollection);
    return array;
  }

  /**
   * convert a list into an array of type of theClass
   * @param &lt;T&gt; is the type of the array
   * @param collection list to convert
   * @param theClass type of array to return
   * @return array of type theClass[] filled with the objects from list
   */
  @SuppressWarnings(&quot;unchecked&quot;)
  public static &lt;T&gt; T[] toArray(Collection collection, Class&lt;T&gt; theClass) {
    if (collection == null || collection.size() == 0) {
      return null;
    }

    return (T[])collection.toArray((Object[]) Array.newInstance(theClass,
        collection.size()));

  }

  /**
   * helper method for calling a static method up the stack. method takes no
   * args (could be in superclass)
   *
   * @param theClass
   *            the class which has the method
   * @param methodName
   *            method name to call
   * @return the data
   */
  public static Object callMethod(Class theClass, String methodName) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L5561">5561</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L6137">6137</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L2357">2357</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L2839">2839</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          return dateFormat().parse(input);
        }
        if (!contains(input, '.')) {
          if (contains(input, '/')) {
            return dateMinutesSecondsFormat.parse(input);
          }
          //else no slash
          return dateMinutesSecondsNoSlashFormat.parse(input);
        }
        if (contains(input, '/')) {
          //see if the period is 6 back
          int lastDotIndex = input.lastIndexOf('.');
          if (lastDotIndex == input.length() - 7) {
            String nonNanoInput = input.substring(0,input.length()-3);
            Date date = timestampFormat.parse(nonNanoInput);
            //get the last 3
            String lastThree = input.substring(input.length()-3,input.length());
            int lastThreeInt = Integer.parseInt(lastThree);
            Timestamp timestamp = new Timestamp(date.getTime());
            timestamp.setNanos(timestamp.getNanos() + (lastThreeInt * 1000));
            return timestamp;
          }
          return timestampFormat.parse(input);
        }
        //else no slash
        return timestampNoSlashFormat.parse(input);
      } catch (ParseException pe) {
        throw new RuntimeException(errorStart + toStringForLog(input));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportGroup.html#L136">136</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportStem.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportStem.html#L140">140</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public XmlExportGroup() {
    
  }

  /**
   * alternate name
   * @return alternate name
   */
  public String getAlternateName() {
    return this.alternateName;
  }

  /**
   * alternateName
   * @param alternateName1
   */
  public void setAlternateName(String alternateName1) {
    this.alternateName = alternateName1;
  }

  /**
   * uuid
   * @return uuid
   */
  public String getUuid() {
    return this.uuid;
  }

  /**
   * uuid
   * @param uuid1
   */
  public void setUuid(String uuid1) {
    this.uuid = uuid1;
  }

  /**
   * parentStem
   * @return parentStem
   */
  public String getParentStem() {
    return this.parentStem;
  }

  /**
   * parentStem
   * @param parentStem1
   */
  public void setParentStem(String parentStem1) {
    this.parentStem = parentStem1;
  }

  /**
   * name
   * @return name
   */
  public String getName() {
    return this.name;
  }

  /**
   * name
   * @param name
   */
  public void setName(String name) {
    this.name = name;
  }

  /**
   * display name
   * @return display name
   */
  public String getDisplayName() {
    return this.displayName;
  }

  /**
   * display name
   * @param displayName1
   */
  public void setDisplayName(String displayName1) {
    this.displayName = displayName1;
  }

  /**
   * creatorId
   * @return creatorId
   */
  public String getCreatorId() {
    return this.creatorId;
  }

  /**
   * creatorId
   * @param creatorId1
   */
  public void setCreatorId(String creatorId1) {
    this.creatorId = creatorId1;
  }

  /**
   * createTime
   * @return createTime
   */
  public String getCreateTime() {
    return this.createTime;
  }

  /**
   * createTime
   * @param createTime1
   */
  public void setCreateTime(String createTime1) {
    this.createTime = createTime1;
  }

  /**
   * modifierId
   * @return modifierId
   */
  public String getModifierId() {
    return this.modifierId;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITGroupSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroupSet.html#L701">701</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L641">641</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>              ChangeLogLabels.PRIVILEGE_DELETE.sourceId.name(), pitMembership.getMember().getSubjectSourceId(),
              ChangeLogLabels.PRIVILEGE_DELETE.privilegeType.name(), privilegeType,
              ChangeLogLabels.PRIVILEGE_DELETE.ownerType.name(), ownerType,
              ChangeLogLabels.PRIVILEGE_DELETE.ownerId.name(), ownerId,
              ChangeLogLabels.PRIVILEGE_DELETE.membershipType.name(), &quot;flattened&quot;,
              ChangeLogLabels.PRIVILEGE_DELETE.ownerName.name(), ownerName);
        }

        if (changeLogEntry != null) {
          changeLogEntry.setContextId(this.getContextId());
          changeLogEntry.setCreatedOnDb(this.getEndTimeDb());
          changeLogEntryBatch.add(changeLogEntry);
          
          if (changeLogEntryBatch.size() % batchSize == 0) {
            GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
            changeLogEntryBatch.clear();
          }
        }
      }
      
      // make sure all changes get made      
      if (changeLogEntryBatch.size() &gt; 0) {
        GrouperDAOFactory.getFactory().getChangeLogEntry().saveBatch(changeLogEntryBatch, false);
        changeLogEntryBatch.clear();
      }
    }
  }
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPostSave(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPostSave(HibernateSession hibernateSession) {
    
    // take care of effective PIT group sets
    if (this.getDepth() == 1 &amp;&amp; this.getMemberGroupId() != null) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L2267">2267</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L2344">2344</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            true, null, true, false);
  
        for (PermissionEntry permissionEntry : GrouperUtil.nonNull(permissionEntries)) {
  
          //must be immediate so it can be unassigned
          if (permissionEntry.isImmediate(permissionEntry.getPermissionType())) {
            
            AttributeAssign attributeAssign = AttributeAssignFinder.findById(permissionEntry.getAttributeAssignId(), false);
            
            if (attributeAssign == null) {
              continue;
            }
            
            Role role = GroupFinder.findByUuid(GrouperSession.staticGrouperSession(), permissionEntry.getRoleId(), false);
            if (role == null) {
              continue;
            }
            Member member = MemberFinder.findByUuid(GrouperSession.staticGrouperSession(), permissionEntry.getMemberId(), false);
            if (member == null) {
              continue;
            }
            AttributeDefName attributeDefName = GrouperDAOFactory.getFactory().getAttributeDefName().findByIdSecure(permissionEntry.getAttributeDefNameId(), false);
            if (attributeDefName == null) {
              continue;
            }
            RulesPermissionBean rulesPermissionBean = new RulesPermissionBean(attributeAssign, role, member, attributeDefName, attributeDefName.getAttributeDef(), permissionEntry.getAction());
            theRulesPermissionBeans.add(rulesPermissionBean);
          }
          
        }
        return theRulesPermissionBeans;
      }
    });
  
    //do this here so it is in the right grouper session (act as)
    for (RulesPermissionBean rulesPermissionBean : rulePermissionBeans) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L737">737</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L653">653</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          MultiKey privilegeAssignTypeKey = new MultiKey(member.getSubjectSourceId(), member.getSubjectId(), group.getId(), membership.getFieldId());
          
          PrivilegeAssignType privilegeAssignType = privilegeAssignTypeMap.get(privilegeAssignTypeKey);
          privilegeAssignType = PrivilegeAssignType.convertMembership(privilegeAssignType, membership);
          privilegeAssignTypeMap.put(privilegeAssignTypeKey, privilegeAssignType);
          
        }
        
        if (LOG.isDebugEnabled()) {
          debugLog.put(&quot;resultsSize&quot;, GrouperUtil.length(results));
        }
  
        for (PrivilegeSubjectContainer privilegeSubjectContainer : results) {
          PrivilegeSubjectContainerImpl privilegeSubjectContainerImpl = (PrivilegeSubjectContainerImpl)privilegeSubjectContainer;
          
          privilegeSubjectContainerImpl.setPrivilegeContainers(new TreeMap&lt;String, PrivilegeContainer&gt;());
          
          Subject subject = privilegeSubjectContainerImpl.getSubject();
          MultiKey subjectKey = new MultiKey(subject.getSourceId(), subject.getId());
          
          //lets get the memberships
          List&lt;Object[]&gt; membershipList = membershipsMap.get(subjectKey);
          
          if (membershipList != null) {
            for (Object[] objectArray : membershipList) {
              
              Membership membership = (Membership)objectArray[0];
              Member member = (Member)objectArray[1];
              Field field = FieldFinder.findById(membership.getFieldId(), true);
              Privilege privilege = AccessPrivilege.listToPriv(field.getName());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\GrouperReport.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/GrouperReport.html#L283">283</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\GrouperReport.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/GrouperReport.html#L309">309</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        result.append(&quot;LOADER JOBS WITH NON-SUCCESS\n&quot;);
        result.append(&quot;----------------\n&quot;);
        for (Hib3GrouperLoaderLog loaderLog : loaderLogs) {
          result.append(&quot;\njob:               &quot;).append(loaderLog.getJobName())
            .append(&quot;\n&quot;);
          result.append(&quot;status:            &quot;).append(loaderLog.getStatus()).append(&quot;, started: &quot;)
            .append(loaderLog.getStartedTime()).append(&quot; (&quot;)
            .append(GrouperUtil.convertMillisToFriendlyString(loaderLog.getMillis())).append(&quot;)\n&quot;);
          result.append(&quot;ins/upd/del/tot:   &quot;).append(loaderLog.getInsertCount()).append(&quot;/&quot;)
            .append(loaderLog.getUpdateCount()).append(&quot;/&quot;).append(loaderLog.getDeleteCount()).append(&quot;/&quot;)
            .append(loaderLog.getTotalCount()).append(&quot;\n&quot;);
          if (loaderLog.getUnresolvableSubjectCount() &gt; 0) {
            result.append(&quot;unresolv subjects: &quot;).append(loaderLog.getUnresolvableSubjectCount()).append(&quot;\n&quot;);
          }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L469">469</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L297">297</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }


  /**
   * return the arg after the argBefore, or null if not there, or exception
   * if argBefore is not found
   * @param args
   * @param argBefore
   * @return the arg
   */
  public static String argAfter(String[] args, String argBefore) {
    if (length(args) &lt;= 1) {
      return null;
    }
    int argBeforeIndex = -1;
    for (int i=0;i&lt;args.length;i++) {
      if (equals(args[i], argBefore)) {
        argBeforeIndex = i;
        break;
      }
    }
    if (argBeforeIndex == -1) {
      throw new RuntimeException(&quot;Cant find arg before&quot;);
    }
    if (argBeforeIndex &lt; args.length - 1) {
      return args[argBeforeIndex + 1];
    }
    return null;
  }

  /**
   * append and maybe put a separator in there
   * @param result
   * @param separatorIfResultNotEmpty
   * @param stringToAppend
   */
  public static void append(StringBuilder result,
      String separatorIfResultNotEmpty, String stringToAppend) {
    if (result.length() != 0) {
      result.append(separatorIfResultNotEmpty);
    }
    result.append(stringToAppend);
  }

  /**
   *
   */
  public static final String LOG_ERROR = &quot;Error trying to make parent dirs for logger or logging first statement, check to make &quot; +
                &quot;sure you have proper file permissions, and that your servlet container is giving &quot; +
                &quot;your app rights to access the log directory (e.g. for tomcat set TOMCAT5_SECURITY=no), g&quot; +
                &quot;oogle it for more info&quot;;

  /**
   * The number of bytes in a kilobyte.
   */
  public static final long ONE_KB = 1024;

  /**
   * The number of bytes in a megabyte.
   */
  public static final long ONE_MB = ONE_KB * ONE_KB;

  /**
   * The number of bytes in a gigabyte.
   */
  public static final long ONE_GB = ONE_KB * ONE_MB;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L192">192</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L775">775</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      StringBuilder sqlTables = new StringBuilder(&quot; from PermissionEntryAll pea &quot;);

      if (permissionNameInStem != null &amp;&amp; permissionNameInStemScope == Scope.ONE) {
        sqlTables.append(&quot; , AttributeDefName adn &quot;);
      }
      
      StringBuilder sqlWhereClause = new StringBuilder(&quot;&quot;);
      
      GrouperSession grouperSession = GrouperSession.staticGrouperSession();
      
      Subject grouperSessionSubject = grouperSession.getSubject();
      
      grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
        grouperSessionSubject, byHqlStatic, 
        sqlTables, sqlWhereClause, &quot;pea.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
      
      boolean changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
          grouperSessionSubject, byHqlStatic, 
          sqlTables, &quot;pea.roleId&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);

      StringBuilder sql;
      if (changedQuery) {
        if (sqlWhereClause.length() &gt; 0) {
          sql = sqlTables.append(&quot; and &quot;).append(sqlWhereClause);
        } else {
          sql = sqlTables;
        }
      } else {
        sql = sqlTables.append(&quot; where &quot;).append(sqlWhereClause);
      }
      
      if (enabled != null &amp;&amp; enabled) {
        sql.append(&quot; and pea.enabledDb = 'T' &quot;);
      }
      if (enabled != null &amp;&amp; !enabled) {
        sql.append(&quot; and pea.enabledDb = 'F' &quot;);
      }
      
      if (permissionNameInStem != null) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L963">963</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2026">2026</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      byHqlStatic.setString(&quot;theAttributeDefType&quot;, attributeDefType.name());
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (groupIdsSize &gt; 0) {
      sql.append(&quot; and aa.ownerGroupId in (&quot;);
      sql.append(HibUtils.convertToInClause(groupIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefIdsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefNameIdsSize &gt; 0) {
      sql.append(&quot; and adn.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefNameIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    byHqlStatic
      .setCacheable(false)
      .setCacheRegion(KLASS + &quot;.FindGroupAttributeAssignments&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1258">1258</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2177">2177</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      byHqlStatic.setString(&quot;theAttributeDefType&quot;, attributeDefType.name());
    }

    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (memberIdsSize &gt; 0) {
      sql.append(&quot; and aa.ownerMemberId in (&quot;);
      sql.append(HibUtils.convertToInClause(memberIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefIdsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefNameIdsSize &gt; 0) {
      sql.append(&quot; and adn.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefNameIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    byHqlStatic
      .setCacheable(false)
      .setCacheRegion(KLASS + &quot;.FindMemberAttributeAssignments&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L148">148</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L204">204</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    Set&lt;Object[]&gt; groupsAndFields = GrouperDAOFactory.getFactory().getGroupSet().findMissingSelfGroupSetsForGroups();
    totalCount = groupsAndFields.size();
    showStatus(&quot;Found &quot; + totalCount + &quot; missing groupSets&quot;);
    
    Set&lt;GroupSet&gt; batch = new LinkedHashSet&lt;GroupSet&gt;();
    int batchSize = getBatchSize();

    try {
      reset();
    Iterator&lt;Object[]&gt; groupsAndFieldsIter = groupsAndFields.iterator();
    while (groupsAndFieldsIter.hasNext()) {
      Object[] groupAndField = groupsAndFieldsIter.next();
      Group group = (Group)groupAndField[0];
      Field field = (Field)groupAndField[1];
      
        GroupSet groupSet = new GroupSet();
        groupSet.setId(GrouperUuid.getUuid());
        groupSet.setCreatorId(group.getCreatorUuid());
        groupSet.setCreateTime(group.getCreateTimeLong());
        groupSet.setDepth(0);
        groupSet.setMemberGroupId(group.getUuid());
        groupSet.setOwnerGroupId(group.getUuid());
        groupSet.setParentId(groupSet.getId());
        groupSet.setFieldId(field.getUuid());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1758">1758</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2708">2708</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      byHqlStatic.setString(&quot;theAttributeDefType&quot;, attributeDefType.name());
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (groupIdsAndMemberIdsSize &gt; 0) {
      HibUtils.convertToMultiKeyInClause(groupIdsAndMemberIds, byHqlStatic, GrouperUtil.toSet(&quot;aa.ownerGroupId&quot;, &quot;aa.ownerMemberId&quot;), sql);
    }
    if (attributeDefIdsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefNameIdsSize &gt; 0) {
      sql.append(&quot; and adn.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefNameIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    byHqlStatic
      .setCacheable(false)
      .setCacheRegion(KLASS + &quot;.FindAnyMembershipAttributeAssignments&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L2024">2024</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L2213">2213</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (this.dbVersion().isEnabled()) {
      //change log into temp table
      new ChangeLogEntry(true, ChangeLogTypeBuiltin.ATTRIBUTE_ASSIGN_DELETE, 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_DELETE.id.name(), this.getId(), 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_DELETE.attributeDefNameId.name(), this.getAttributeDefNameId(), 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_DELETE.attributeAssignActionId.name(), this.getAttributeAssignActionId(), 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_DELETE.assignType.name(), this.getAttributeAssignTypeDb(), 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_DELETE.ownerId1.name(), ownerId1,
          ChangeLogLabels.ATTRIBUTE_ASSIGN_DELETE.ownerId2.name(), ownerId2,
          ChangeLogLabels.ATTRIBUTE_ASSIGN_DELETE.attributeDefNameName.name(), this.getAttributeDefName().getName(),
          ChangeLogLabels.ATTRIBUTE_ASSIGN_DELETE.action.name(), this.getAttributeAssignAction().getName(),
          ChangeLogLabels.ATTRIBUTE_ASSIGN_DELETE.disallowed.name(), this.getDisallowedDb()).save();
    }
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogType.html#L496">496</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditType.html#L232">232</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * action within the changeLog category
   * @return the action name
   */
  public String getActionName() {
    return this.actionName;
  }

  /**
   * action within the changeLog category
   * @param actionName
   */
  public void setActionName(String actionName) {
    this.actionName = actionName;
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }

  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\WheelAccessResolver.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/WheelAccessResolver.html#L89">89</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\WheelAttrDefResolver.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/WheelAttrDefResolver.html#L89">89</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public WheelAccessResolver(AccessResolver resolver) {
    super(resolver);

    // TODO 20070816 this is ugly
    String useWheelString = GrouperConfig.retrieveConfig().propertyValueString(GrouperConfig.PROP_USE_WHEEL_GROUP);
    this.useWheel = Boolean.valueOf(useWheelString).booleanValue();
    // TODO 20070816 and this is even worse
    if (this.useWheel) {
      String wheelName = null;
      try {
        wheelName = GrouperConfig.retrieveConfig().propertyValueString(GrouperConfig.PROP_WHEEL_GROUP);
        this.wheelSession = GrouperSession.start(SubjectFinder.findRootSubject(), false);
        this.wheelGroup = GroupFinder.findByName(
            this.wheelSession,
            wheelName, true
            );
      } catch (Exception e) {

        String error = &quot;Initialisation error with wheel group name '&quot; + wheelName
            + &quot;': &quot; + e.getClass().getSimpleName()
            + &quot;\n&quot; + ExceptionUtils.getFullStackTrace(e);

        //only log this once as error, dont log if checking config
        if (!loggedWheelGroupMissing &amp;&amp; !GrouperCheckConfig.inCheckConfig) {
          //OK, so wheel group does not exist. Not fatal...
          LOG.error(error);
          loggedWheelGroupMissing = true;
        } else {
          LOG.debug(error);
        }
        this.useWheel = false;
      }
    }
  }

  /**
   * @see     AccessResolver#getPrivileges(Group, Subject)
   * @since   1.2.1
   */
  public Set&lt;AccessPrivilege&gt; getPrivileges(Group group, Subject subject)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1183">1183</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1243">1243</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        RuleCheckType.membershipDisabledDate.name());
    
    //will find memberships with a disabled date at least 6 days from now.  blank means no min
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleCheckArg0Name(), daysInFutureDisabledDateMin == null ? null : daysInFutureDisabledDateMin.toString());

    //will find memberships with a disabled date at most 8 days from now.  blank means no max
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleCheckArg1Name(), daysInFutureDisabledDateMax == null ? null : daysInFutureDisabledDateMax.toString());

    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumName(), RuleThenEnum.sendEmail.name());
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg0Name(), emailToValue);
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg1Name(), emailSubjectValue);
 
    //the to, subject, or body could be text with EL variables, or could be a template.  If template, it is
    //read from the classpath from package: grouperRulesEmailTemplates/theTemplateName.txt
    //or you could configure grouper.properties to keep them in an external folder, not in the classpath
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg2Name(), emailBodyValue);
    
    //should be valid
    String isValidString = attributeAssign.getAttributeValueDelegate().retrieveValueString(
        RuleUtils.ruleValidName());

    if (!StringUtils.equals(&quot;T&quot;, isValidString)) {
      throw new RuntimeException(isValidString);
    }
    
    return attributeAssign;

  }

  /**
   * 
   * @param actAsSubject
   * @param permissionDef
   * @param daysInFutureDisabledDateMin
   * @param daysInFutureDisabledDateMax
   * @param emailToValue
   * @param emailSubjectValue
   * @param emailBodyValue
   * @return attribute assign for customizing
   */
  public static AttributeAssign emailOnFlattenedPermissionDisabledDate(Subject actAsSubject, </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L1046">1046</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\value\AttributeAssignValue.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/value/AttributeAssignValue.html#L512">512</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogConsumer.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogConsumer.html#L145">145</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public String getId() {
    return this.id;
  }

  /**
   * id of this attribute assign
   * @param id1
   */
  public void setId(String id1) {
    this.id = id1;
  }

  
  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }
  
  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L1978">1978</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L2060">2060</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L2174">2174</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          gtt, GroupTypeTuple.class, VetoTypeGrouper.GROUP_TYPE_TUPLE_PRE_DELETE, false, false);
    }
    
    String ownerId1 = null;
    String ownerId2 = null;
    
    AttributeAssignType ownerType = this.getAttributeAssignType();
    if (AttributeAssignType.group == ownerType) {
      ownerId1 = this.getOwnerGroupId();
    } else if (AttributeAssignType.stem == ownerType) {
      ownerId1 = this.getOwnerStemId();
    } else if (AttributeAssignType.member == ownerType) {
      ownerId1 = this.getOwnerMemberId();
    } else if (AttributeAssignType.attr_def == ownerType) {
      ownerId1 = this.getOwnerAttributeDefId();
    } else if (AttributeAssignType.any_mem == ownerType) {
      ownerId1 = this.getOwnerGroupId();
      ownerId2 = this.getOwnerMemberId();
    } else if (AttributeAssignType.imm_mem == ownerType) {
      ownerId1 = this.getOwnerMembershipId();
    } else if (this.getOwnerAttributeAssignId() != null) {
      ownerId1 = this.getOwnerAttributeAssignId();
    } else {
      throw new RuntimeException(&quot;Unexpected ownerType: &quot; + ownerType);
    }
    
    // may need to delete group sets if we're unassigning a group type.  also change log entry.
    if (gtt != null) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L225">225</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L141">141</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    return matcher.matches();
  }

  /**
   * shorten a set if it is too long
   * @param &lt;T&gt;
   * @param theSet
   * @param maxSize
   * @return the new set
   */
  public static &lt;T&gt; Set&lt;T&gt; setShorten(Set&lt;T&gt; theSet, int maxSize) {

    if (length(theSet) &lt; maxSize) {
      return theSet;
    }

    //truncate the list
    Set&lt;T&gt; newList = new LinkedHashSet&lt;T&gt;();
    int i=0;

    //TODO test this logic
    for (T t : theSet) {

      if (i&gt;=maxSize) {
        break;
      }

      newList.add(t);
      i++;
    }
    return newList;
  }

  /**
   *
   * @param number e.g. 12345678
   * @return the string, e.g. 12,345,678
   */
  public static String formatNumberWithCommas(Long number) {
    if (number == null) {
      return &quot;null&quot;;
    }
    DecimalFormat df = new DecimalFormat();
    return df.format(number);
  }

  /**
   * compare null safe
   * @param first
   * @param second
   * @return 0 for equal, 1 for greater, -1 for less
   */
  public static int compare(Comparable first, Comparable second) {
    if (first == second) {
      return 0;
    }
    if (first == null) {
      return -1;
    }
    if (second == null) {
      return 1;
    }
    return first.compareTo(second);
  }

  /**
   * e.g. ('g:gsa', 'jdbc')
   * @param sources is comma separated source id's
   * @return the set of sources
   */
  public static Set&lt;Source&gt; convertSources(String sources) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L960">960</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L413">413</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public static void sleep(long millis) {
    try {
      Thread.sleep(millis);
    } catch (InterruptedException ie) {
      throw new RuntimeException(ie);
    }
  }

  /**
   *
   * @param seconds
   */
  public static void sleepWithStdoutCountdown(int seconds) {
    for (int i=seconds;i&gt;0;i--) {
      System.out.println(&quot;Sleeping: &quot; + i);
      sleep(1000);
    }
  }

  /**
   * encrypt a message to SHA
   * @param plaintext
   * @return the hash
   */
  public synchronized static String encryptSha(String plaintext) {
    MessageDigest md = null;
    try {
      md = MessageDigest.getInstance(&quot;SHA&quot;); //step 2
    } catch (NoSuchAlgorithmException e) {
      throw new RuntimeException(e);
    }
    try {
      md.update(plaintext.getBytes(&quot;UTF-8&quot;)); //step 3
    } catch (UnsupportedEncodingException e) {
      throw new RuntimeException(e);
  }
    byte raw[] = md.digest(); //step 4
    byte[] encoded = Base64.encodeBase64(raw); //step 5
    String hash = new String(encoded);
    //String hash = (new BASE64Encoder()).encode(raw); //step 5
    return hash; //step 6
  }

  /**
   * If we can, inject this into the exception, else return false
   * @param t
   * @param message
   * @return true if success, false if not
   */
  public static boolean injectInException(Throwable t, String message) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\db\GrouperLoaderResultset.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/db/GrouperLoaderResultset.html#L593">593</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\db\GrouperLoaderResultset.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/db/GrouperLoaderResultset.html#L956">956</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                    + &quot; sub-results) for serverId: &quot; + ldapServerId + &quot;, searchDn: &quot;
                    + searchDn
                    + &quot;, filter: '&quot; + filter + &quot;', returning subject attribute: &quot;
                    + subjectAttributeName + &quot;, some results: &quot;
                    + GrouperUtil.toStringForLog(result, 100));
              }

              return result;
            }
          });
    } catch (RuntimeException re) {
      GrouperUtil.injectInException(re, &quot;Error querying ldap server id: &quot; + ldapServerId
          + &quot;, searchDn: &quot; + searchDn
          + &quot;, filter: '&quot; + filter + &quot;', returning subject attribute: &quot;
          + subjectAttributeName);
      throw re;
    }

    for (String currentGroupName : resultMap.keySet()) {
      List&lt;String&gt; results = resultMap.get(currentGroupName);
      for (String result : results) {
        Row row = new Row();
        Object[] rowData = new Object[hasSourceId ? 3 : 2];
        row.setRowData(rowData);
        this.data.add(row);
        rowData[0] = currentGroupName;
        rowData[1] = result;
        if (hasSourceId) {
          rowData[2] = sourceId;
        }
      }
    }
    this.convertToSubjectIdIfNeeded(jobName, hib3GrouperLoaderLog, subjectExpression,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\XmlArgs.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/XmlArgs.html#L73">73</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\XmlArgs.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/XmlArgs.html#L132">132</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public static Properties internal_getXmlExportArgs(String args[])
    throws  IllegalArgumentException,
            IllegalStateException
  {
    // TODO 20070321 DRY `getXmlImportArgs()`
    Properties  rc        = new Properties();
    String      arg;
    int         inputPos  = 0;
    int         pos       = 0;
    while (pos &lt; args.length) {
      arg = args[pos];
      if (arg.startsWith(&quot;-&quot;)) {
        if (_handleNamedArgUuid(rc, arg))       {
          rc.setProperty(RC_UUID, args[pos + 1]);
          pos += 2;
          continue;
        } 
        else if (_handleNamedArgName(rc, arg))  {
          rc.setProperty(RC_NAME, args[pos + 1]);
          pos += 2;
          continue;
        } 
        else if (arg.equals(&quot;-userAuditFilename&quot;)) {
          rc.setProperty(&quot;userAuditFilename&quot;, args[pos + 1]);
          pos += 2;
          continue;
        }  
        else if (arg.equals(&quot;-userAuditOnly&quot;)) {
          rc.setProperty(&quot;userAuditOnly&quot;, &quot;true&quot;);
          pos += 1;
          continue;
        }  
        else if (arg.equals(&quot;-relative&quot;))       {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L2116">2116</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L2201">2201</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (this.isEnabled()) {
      //change log into temp table
      new ChangeLogEntry(true, ChangeLogTypeBuiltin.ATTRIBUTE_ASSIGN_ADD, 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_ADD.id.name(), this.getId(), 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_ADD.attributeDefNameId.name(), this.getAttributeDefNameId(), 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_ADD.attributeAssignActionId.name(), this.getAttributeAssignActionId(), 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_ADD.assignType.name(), this.getAttributeAssignTypeDb(), 
          ChangeLogLabels.ATTRIBUTE_ASSIGN_ADD.ownerId1.name(), ownerId1,
          ChangeLogLabels.ATTRIBUTE_ASSIGN_ADD.ownerId2.name(), ownerId2,
          ChangeLogLabels.ATTRIBUTE_ASSIGN_ADD.attributeDefNameName.name(), this.getAttributeDefName().getName(),
          ChangeLogLabels.ATTRIBUTE_ASSIGN_ADD.action.name(), this.getAttributeAssignAction().getName(),
          ChangeLogLabels.ATTRIBUTE_ASSIGN_ADD.disallowed.name(), this.getDisallowedDb()).save();
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L1047">1047</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\AttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDef.html#L1305">1305</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\value\AttributeAssignValue.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/value/AttributeAssignValue.html#L513">513</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    return this.id;
  }

  /**
   * id of this attribute assign
   * @param id1
   */
  public void setId(String id1) {
    this.id = id1;
  }

  
  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }
  
  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }

  /**
   * notes about this assignment, free-form text
   * @return the notes
   */
  public String getNotes() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2551">2551</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3230">3230</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    		&quot; aa.attributeDefNameId = adn.id and aa.attributeAssignTypeDb = 'stem' &quot;);
    
    GrouperSession grouperSession = GrouperSession.staticGrouperSession();
    
    Subject grouperSessionSubject = grouperSession.getSubject();
    
    grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
      grouperSessionSubject, byHqlStatic, 
      sqlTables, sqlWhereClause, &quot;adn.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
    
    boolean changedQuery = grouperSession.getNamingResolver().hqlFilterStemsWhereClause(
        grouperSessionSubject, byHqlStatic, 
        sqlTables, &quot;aa.ownerStemId&quot;, NamingPrivilege.ATTRIBUTE_READ_PRIVILEGES);
  
    StringBuilder sql;
    if (changedQuery) {
      sqlTables.append(&quot; and &quot;);
    } else {
      sqlTables.append(&quot; where &quot;);
    }
    sql = sqlTables.append(sqlWhereClause);
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L313">313</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L371">371</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L442">442</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    Set&lt;Membership&gt; mships = GrouperDAOFactory.getFactory().getMembership().findMissingImmediateGroupSetsForGroupOwners();
    totalCount = mships.size();
    showStatus(&quot;Found &quot; + totalCount + &quot; missing groupSets&quot;);
    
    Set&lt;GroupSet&gt; batch = new LinkedHashSet&lt;GroupSet&gt;();
    int batchSize = getBatchSize();

    try {
      reset();
    Iterator&lt;Membership&gt; mshipsIter = mships.iterator();
    
    while (mshipsIter.hasNext()) {
      Membership mship = mshipsIter.next();
      Field field = FieldFinder.findById(mship.getFieldId(), true);
      
        GroupSet immediateGroupSet = new GroupSet();
        immediateGroupSet.setId(GrouperUuid.getUuid());
        immediateGroupSet.setCreatorId(mship.getCreatorUuid());
        immediateGroupSet.setCreateTime(mship.getCreateTimeLong());
        immediateGroupSet.setDepth(1);
        immediateGroupSet.setFieldId(field.getUuid());
        immediateGroupSet.setMemberGroupId(mship.getMemberSubjectId());
        immediateGroupSet.setType(MembershipType.EFFECTIVE.getTypeString());
        immediateGroupSet.setOwnerGroupId(mship.getOwnerGroupId());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\AttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDef.html#L1305">1305</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogConsumer.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogConsumer.html#L146">146</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    return id;
  }

  /**
   * id of this attribute def
   * @param id1
   */
  public void setId(String id1) {
    this.id = id1;
  }

  
  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }
  
  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }
  
  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITGroupSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroupSet.html#L312">312</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L305">305</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    GrouperDAOFactory.getFactory().getPITGroupSet().delete(this);
  }

  /**
   * @return ownerId
   */
  public String getOwnerId() {
    return ownerId;
  }

  /**
   * @param ownerId
   */
  public void setOwnerId(String ownerId) {
    this.ownerId = ownerId;
  }

  /**
   * @return ownerAttrDefId
   */
  public String getOwnerAttrDefId() {
    return ownerAttrDefId;
  }

  /**
   * @param ownerAttrDefId
   */
  public void setOwnerAttrDefId(String ownerAttrDefId) {
    this.ownerAttrDefId = ownerAttrDefId;
    if (ownerAttrDefId != null) {
      setOwnerId(ownerAttrDefId);
    }
  }

  /**
   * @return ownerGroupId
   */
  public String getOwnerGroupId() {
    return ownerGroupId;
  }

  /**
   * @param ownerGroupId
   */
  public void setOwnerGroupId(String ownerGroupId) {
    this.ownerGroupId = ownerGroupId;
    if (ownerGroupId != null) {
      setOwnerId(ownerGroupId);
    }
  }

  /**
   * @return ownerStemId
   */
  public String getOwnerStemId() {
    return ownerStemId;
  }

  /**
   * @param ownerStemId
   */
  public void setOwnerStemId(String ownerStemId) {
    this.ownerStemId = ownerStemId;
    if (ownerStemId != null) {
      setOwnerId(ownerStemId);
    }
  }

  /**
   * @return memberId
   */
  public String getMemberId() {
    return memberId;
  }

  /**
   * @param memberId
   */
  public void setMemberId(String memberId) {
    this.memberId = memberId;
  }

  /**
   * @return fieldId
   */
  public String getFieldId() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L686">686</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L763">763</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    LDAP_SIMPLE {
      
      /**
       * 
       * @see edu.internet2.middleware.grouper.app.loader.GrouperLoaderType#attributeRequired(java.lang.String)
       */
      @Override
      public boolean attributeRequired(String attributeName) {
        return StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapServerIdName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapFilterName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapQuartzCronName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSubjectAttributeName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapTypeName(), attributeName);
      }

      /**
       * 
       * @see edu.internet2.middleware.grouper.app.loader.GrouperLoaderType#attributeOptional(java.lang.String)
       */
      @Override
      public boolean attributeOptional(String attributeName) {
        return StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSearchDnName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSearchScopeName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSourceIdName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapAndGroupsName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapPriorityName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSubjectIdTypeName(), attributeName)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L992">992</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1288">1288</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1609">1609</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1785">1785</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3293">3293</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      .setCacheRegion(KLASS + &quot;.FindGroupAttributeAssignments&quot;);

    int maxAssignments = GrouperConfig.retrieveConfig().propertyValueInt(&quot;ws.findAttrAssignments.maxResultSize&quot;, 30000);
    
    //if -1, lets not check
    long size = -1;
    
    if (maxAssignments &gt;= 0) {

      size = byHqlStatic.createQuery(countPrefix + sql.toString()).uniqueResult(long.class);    
      
      //see if too many
      if (size &gt; maxAssignments) {
        throw new RuntimeException(&quot;Too many results: &quot; + size);
      }
      
    }
    
    Set&lt;AttributeAssign&gt; results = size == 0 ? new LinkedHashSet&lt;AttributeAssign&gt;() 
        : byHqlStatic.createQuery(selectPrefix + sql.toString()).listSet(AttributeAssign.class);

    //nothing to filter
    if (GrouperUtil.length(results) == 0) {
      return results;
    }
    
    //if the hql didnt filter, we need to do that here
    results = grouperSession.getAttributeDefResolver().postHqlFilterAttributeAssigns(grouperSessionSubject, results);
    
    //if looking for assignments on assignments, do that now
    if (includeAssignmentsOnAssignments) {
      Set&lt;AttributeAssign&gt; assignmentsOnAssignments = GrouperDAOFactory.getFactory().getAttributeAssign()
        .findAssignmentsOnAssignments(results, AttributeAssignType.group_asgn, enabled);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L198">198</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L541">541</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L650">650</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L781">781</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      StringBuilder sqlWhereClause = new StringBuilder(&quot;&quot;);
      
      GrouperSession grouperSession = GrouperSession.staticGrouperSession();
      
      Subject grouperSessionSubject = grouperSession.getSubject();
      
      grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
        grouperSessionSubject, byHqlStatic, 
        sqlTables, sqlWhereClause, &quot;pea.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
      
      boolean changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
          grouperSessionSubject, byHqlStatic, 
          sqlTables, &quot;pea.roleId&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);

      StringBuilder sql;
      if (changedQuery) {
        if (sqlWhereClause.length() &gt; 0) {
          sql = sqlTables.append(&quot; and &quot;).append(sqlWhereClause);
        } else {
          sql = sqlTables;
        }
      } else {
        sql = sqlTables.append(&quot; where &quot;).append(sqlWhereClause);
      }
      
      if (enabled != null &amp;&amp; enabled) {
        sql.append(&quot; and pea.enabledDb = 'T' &quot;);
      }
      if (enabled != null &amp;&amp; !enabled) {
        sql.append(&quot; and pea.enabledDb = 'F' &quot;);
      }
      
      if (permissionNameInStem != null) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1010">1010</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1188">1188</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1725">1725</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          throw new RuntimeException(&quot;RuleThenEnum needs to be &quot; + RuleThenEnum.assignGroupPrivilegeToGroupId);
        }
        //return, nothing to do
        return;
      }

      String sqlLikeString = null;
      
      if (ruleDefinition.getIfCondition().ifConditionEnum() == RuleIfConditionEnum.nameMatchesSqlLikeString) {
        sqlLikeString = ruleDefinition.getIfCondition().getIfConditionEnumArg0();
      }
      
      
      String subjectString = ruleDefinition.getThen().getThenEnumArg0();
      Subject subject = SubjectFinder.findByPackedSubjectString(subjectString, true);
      String privilegesString = ruleDefinition.getThen().getThenEnumArg1();
      
      Set&lt;String&gt; privilegesStringSet = GrouperUtil.splitTrimToSet(privilegesString, &quot;,&quot;);
      
      Set&lt;Privilege&gt; privilegeSet = new HashSet&lt;Privilege&gt;();
      for (String privilegeString: privilegesStringSet) {
        Privilege privilege = Privilege.getInstance(privilegeString);
        privilegeSet.add(privilege);
      }
      
      //so basically, for the memberships in this group, where there is none in the other group, process them
      String stemId = ruleDefinition.getAttributeAssignType().getOwnerStemId();
      
      Scope scope = ruleDefinition.getCheck().stemScopeEnum();
      
      for (Privilege privilege : privilegeSet) {
      
        Set&lt;Group&gt; groupsWhichNeedPrivs = GrouperSession.staticGrouperSession().getAccessResolver().getGroupsWhereSubjectDoesntHavePrivilege(</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\client\GroupSyncConsumer.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/client/GroupSyncConsumer.html#L111">111</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\client\GroupSyncConsumer.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/client/GroupSyncConsumer.html#L193">193</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        GcAddMember gcAddMember = new GcAddMember();
        Subject subject = groupSyncConsumerBean.getSubject();
        String localGroupName = clientGroupConfigBean.getLocalGroupName();
        
        ClientConnectionConfigBean clientConnectionConfigBean = ClientConfig.clientConnectionConfigBeanCache().get(clientGroupConfigBean.getConnectionName());
        
        ClientConnectionSourceConfigBean clientConnectionSourceConfigBean = clientConnectionConfigBean.getClientConnectionSourceConfigBeans().get(subject.getSourceId());

        WsSubjectLookup wsSubjectLookup = new WsSubjectLookup();
        
        if (!StringUtils.isBlank(clientConnectionSourceConfigBean.getRemoteSourceId())) {
          wsSubjectLookup.setSubjectSourceId(clientConnectionSourceConfigBean.getRemoteSourceId());
        }
        
        String localReadSubjectId = clientConnectionSourceConfigBean.getLocalReadSubjectId();
        String subjectIdentifier = null;
        if (StringUtils.equals(&quot;id&quot;, localReadSubjectId)) {
          subjectIdentifier = subject.getId();
        } else {
          subjectIdentifier = subject.getAttributeValue(localReadSubjectId);
        }
        
        GroupSyncWriteIdentifier groupSyncWriteIdentifier = (GroupSyncWriteIdentifier)ObjectUtils.defaultIfNull(
            clientConnectionSourceConfigBean.getRemoteWriteSubjectId(), GroupSyncWriteIdentifier.idOrIdentifier);
        
        groupSyncWriteIdentifier.assignIdentifier(wsSubjectLookup, subjectIdentifier);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Group.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Group.html#L7249">7249</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Stem.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Stem.html#L4116">4116</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public boolean xmlDifferentBusinessProperties(Group other) {
    if (!StringUtils.equals(this.alternateNameDb, other.alternateNameDb)) {
      return true;
    }
    if (!StringUtils.equals(StringUtils.trimToNull(this.description), StringUtils.trimToNull(other.description))) {
      return true;
    }
    if (!StringUtils.equals(this.displayExtension, other.displayExtension)) {
      return true;
    }
    if (!StringUtils.equals(this.displayName, other.displayName)) {
      return true;
    }
    if (!StringUtils.equals(this.extension, other.extension)) {
      return true;
    }
    if (!StringUtils.equals(this.name, other.name)) {
      return true;
    }
    if (!StringUtils.equals(this.parentUuid, other.parentUuid)) {
      return true;
    }
    if (!GrouperUtil.equals(this.typeOfGroup, other.typeOfGroup)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L4710">4710</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L5864">5864</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * Get a specific index of an array or collection (note for collections and
   * iterating, it is more efficient to get an iterator and iterate
   *
   * @param arrayOrCollection
   * @param index
   * @return the object at that index
   */
  public static Object get(Object arrayOrCollection, int index) {

    if (arrayOrCollection == null) {
      if (index == 0) {
        return null;
      }
      throw new RuntimeException(&quot;Trying to access index &quot; + index
          + &quot; of null&quot;);
    }

    // no need to iterator on list (e.g. FastProxyList has no iterator
    if (arrayOrCollection instanceof List) {
      return ((List) arrayOrCollection).get(index);
    }
    if (arrayOrCollection instanceof Collection) {
      Iterator iterator = iterator(arrayOrCollection);
      for (int i = 0; i &lt; index; i++) {
        next(arrayOrCollection, iterator, i);
      }
      return next(arrayOrCollection, iterator, index);
    }

    if (arrayOrCollection.getClass().isArray()) {
      return Array.get(arrayOrCollection, index);
    }

    if (index == 0) {
      return arrayOrCollection;
    }

    throw new RuntimeException(&quot;Trying to access index &quot; + index
        + &quot; of and object: &quot; + arrayOrCollection);
  }

  /**
   * convert a collection of sources to a string
   * @param sources
   * @return the string
   */
  public static String toString(Collection&lt;Source&gt; sources) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L306">306</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembershipView.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembershipView.html#L160">160</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * @return ownerId
   */
  public String getOwnerId() {
    return ownerId;
  }

  /**
   * @param ownerId
   */
  public void setOwnerId(String ownerId) {
    this.ownerId = ownerId;
  }

  /**
   * @return ownerAttrDefId
   */
  public String getOwnerAttrDefId() {
    return ownerAttrDefId;
  }

  /**
   * @param ownerAttrDefId
   */
  public void setOwnerAttrDefId(String ownerAttrDefId) {
    this.ownerAttrDefId = ownerAttrDefId;
    if (ownerAttrDefId != null) {
      setOwnerId(ownerAttrDefId);
    }
  }

  /**
   * @return ownerGroupId
   */
  public String getOwnerGroupId() {
    return ownerGroupId;
  }

  /**
   * @param ownerGroupId
   */
  public void setOwnerGroupId(String ownerGroupId) {
    this.ownerGroupId = ownerGroupId;
    if (ownerGroupId != null) {
      setOwnerId(ownerGroupId);
    }
  }

  /**
   * @return ownerStemId
   */
  public String getOwnerStemId() {
    return ownerStemId;
  }

  /**
   * @param ownerStemId
   */
  public void setOwnerStemId(String ownerStemId) {
    this.ownerStemId = ownerStemId;
    if (ownerStemId != null) {
      setOwnerId(ownerStemId);
    }
  }

  /**
   * @return memberId
   */
  public String getMemberId() {
    return memberId;
  }

  /**
   * @param memberId
   */
  public void setMemberId(String memberId) {
    this.memberId = memberId;
  }
  
  /**
   * @param member
   */
  public void setMember(PITMember member) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\MembershipFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/MembershipFinder.html#L1591">1591</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\MembershipFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/MembershipFinder.html#L2379">2379</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    try {
      while (it.hasNext()) {
    	//2007-12-18 Gary Brown
        //Instantiating all the Subjects can be very slow. LazySubjects
    	//only make expensive calls when necessary - so a client can page 
        //results.
    	//A partial alternative may have been to always instantiate the Member of
    	//a Membership when the latter is created - assuming one query.
    	try {
    		subjs.add ( new LazySubject((Membership) it.next()) );
    	}catch(GrouperException gre) {
    		if(gre.getCause() instanceof MemberNotFoundException) {
    			throw (MemberNotFoundException) gre.getCause();
    		}
    		if(gre.getCause() instanceof SubjectNotFoundException) {
    			throw (SubjectNotFoundException) gre.getCause();
    		}
    	}
      }
    }
    catch (MemberNotFoundException eMNF) {
      String msg = &quot;internal_findSubjects: &quot; + eMNF.getMessage();
      LOG.fatal(msg);
      throw new GrouperException(msg, eMNF);
    }
    catch (SubjectNotFoundException eSNF) {
      String msg = &quot;internal_findSubjects: &quot; + eSNF.getMessage();
      LOG.fatal(msg);
      throw new GrouperException(msg, eSNF);
    }
    return subjs;
  } // public static Set internal_findSubjects(s, o, f)

  /**
   * 
   * @param s
   * @param attributeDef
   * @param f
   * @return set of subjects
   * @throws GrouperException
   */
  public static Set&lt;Subject&gt; internal_findAttributeDefSubjectsImmediateOnly(GrouperSession s,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITGroupSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroupSet.html#L313">313</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembershipView.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembershipView.html#L160">160</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * @return ownerId
   */
  public String getOwnerId() {
    return ownerId;
  }

  /**
   * @param ownerId
   */
  public void setOwnerId(String ownerId) {
    this.ownerId = ownerId;
  }

  /**
   * @return ownerAttrDefId
   */
  public String getOwnerAttrDefId() {
    return ownerAttrDefId;
  }

  /**
   * @param ownerAttrDefId
   */
  public void setOwnerAttrDefId(String ownerAttrDefId) {
    this.ownerAttrDefId = ownerAttrDefId;
    if (ownerAttrDefId != null) {
      setOwnerId(ownerAttrDefId);
    }
  }

  /**
   * @return ownerGroupId
   */
  public String getOwnerGroupId() {
    return ownerGroupId;
  }

  /**
   * @param ownerGroupId
   */
  public void setOwnerGroupId(String ownerGroupId) {
    this.ownerGroupId = ownerGroupId;
    if (ownerGroupId != null) {
      setOwnerId(ownerGroupId);
    }
  }

  /**
   * @return ownerStemId
   */
  public String getOwnerStemId() {
    return ownerStemId;
  }

  /**
   * @param ownerStemId
   */
  public void setOwnerStemId(String ownerStemId) {
    this.ownerStemId = ownerStemId;
    if (ownerStemId != null) {
      setOwnerId(ownerStemId);
    }
  }

  /**
   * @return memberId
   */
  public String getMemberId() {
    return memberId;
  }

  /**
   * @param memberId
   */
  public void setMemberId(String memberId) {
    this.memberId = memberId;
  }

  /**
   * @return fieldId
   */
  public String getFieldId() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogType.html#L601">601</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAuditType.html#L227">227</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditType.html#L312">312</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * label for string01
   * @return label
   */
  public String getLabelString01() {
    return this.labelString01;
  }

  /**
   * label for string01
   * @param labelString01a
   */
  public void setLabelString01(String labelString01a) {
    this.labelString01 = labelString01a;
  }

  /**
   * label for string02
   * @return label
   */
  public String getLabelString02() {
    return this.labelString02;
  }

  /**
   * label for string02
   * @param labelString02a
   */
  public void setLabelString02(String labelString02a) {
    this.labelString02 = labelString02a;
  }

  /**
   * label for string03
   * @return label
   */
  public String getLabelString03() {
    return this.labelString03;
  }

  /**
   * label for string03
   * @param labelString03a
   */
  public void setLabelString03(String labelString03a) {
    this.labelString03 = labelString03a;
  }

  /**
   * label for string04
   * @return label
   */
  public String getLabelString04() {
    return this.labelString04;
  }

  /**
   * label for string04
   * @param labelString04a
   */
  public void setLabelString04(String labelString04a) {
    this.labelString04 = labelString04a;
  }

  /**
   * label for string05
   * @return label
   */
  public String getLabelString05() {
    return this.labelString05;
  }

  /**
   * label for string05
   * @param labelString05a
   */
  public void setLabelString05(String labelString05a) {
    this.labelString05 = labelString05a;
  }

  /**
   * context id ties multiple db changes
   * @return id
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * context id ties multiple db changes
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }

  /**
   * make sure this object will fit in the DB
   */
  public void truncate() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L307">307</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L243">243</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            Membership.internal_addImmediateMembership(grouperSession, g, subj, f, uuid);
          } catch (MemberAddException eMA) {
            if (eMA instanceof MemberAddAlreadyExistsException) {
              throw new GrouperSessionException(new GrantPrivilegeAlreadyExistsException(eMA.getMessage(), eMA));
            }
            throw new GrouperSessionException(new GrantPrivilegeException(eMA.getMessage(), eMA));
          } catch (SchemaException se) {
            throw new GrouperSessionException(se);
          }
          return null;
        }
        
      });
    } catch (GrouperSessionException gse) {
      if (gse.getCause() instanceof GrantPrivilegeException) {
        throw (GrantPrivilegeException)gse.getCause();
      }
      if (gse.getCause() instanceof InsufficientPrivilegeException) {
        throw (InsufficientPrivilegeException)gse.getCause();
      }
      if (gse.getCause() instanceof SchemaException) {
        throw (SchemaException)gse.getCause();
      }
      throw gse;
    }
  }

  /**
   * 
   * @see edu.internet2.middleware.grouper.privs.AccessAdapter#hasPriv(edu.internet2.middleware.grouper.GrouperSession, edu.internet2.middleware.grouper.Group, edu.internet2.middleware.subject.Subject, edu.internet2.middleware.grouper.privs.Privilege)
   */
  public boolean hasPriv(GrouperSession s, Group g, Subject subj, Privilege priv)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeDef.html#L534">534</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeDefName.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeDefName.html#L228">228</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * createTime
   * @return createTime
   */
  public String getCreateTime() {
    return this.createTime;
  }

  /**
   * createTime
   * @param createTime1
   */
  public void setCreateTime(String createTime1) {
    this.createTime = createTime1;
  }

  /**
   * modifierTime
   * @return modifierTime
   */
  public String getModifierTime() {
    return this.modifierTime;
  }

  /**
   * modifierTime
   * @param modifierTime1
   */
  public void setModifierTime(String modifierTime1) {
    this.modifierTime = modifierTime1;
  }

  /**
   * extension
   * @return extension
   */
  public String getExtension() {
    return this.extension;
  }

  /**
   * extension
   * @param extension1
   */
  public void setExtension(String extension1) {
    this.extension = extension1;
  }

  /**
   * description
   * @return description
   */
  public String getDescription() {
    return this.description;
  }

  /**
   * description
   * @param description1
   */
  public void setDescription(String description1) {
    this.description = description1;
  }

  /**
   * hibernateVersionNumber
   * @return hibernateVersionNumber
   */
  public long getHibernateVersionNumber() {
    return this.hibernateVersionNumber;
  }

  /**
   * hibernateVersionNumber
   * @param hibernateVersionNumber1
   */
  public void setHibernateVersionNumber(long hibernateVersionNumber1) {
    this.hibernateVersionNumber = hibernateVersionNumber1;
  }

  /**
   * contextId
   * @return contextId
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * contextId
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }
  
  /**
   * convert to attributeDef
   * @return the attributeDef
   */
  public AttributeDef toAttributeDef() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L384">384</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L451">451</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1575">1575</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  flattenedMembershipAddInFolder{
  
    /**
     * @see RuleCheckType#checkKey(RuleDefinition)
     */
    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      return checkKeyForStem(ruleDefinition);
    }


    /**
     * validate this check type
     * @param ruleDefinition
     * @param ruleCheck 
     * @return the error or null if valid
     */
    public String validate(RuleDefinition ruleDefinition, RuleCheck ruleCheck) {
      return validate(false, ruleDefinition, ruleCheck, true, false, true, false);
    }
  
    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#ruleDefinitions(edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public Set&lt;RuleDefinition&gt; ruleDefinitions(RuleEngine ruleEngine, RulesBean rulesBean) {
      
      return ruleDefinitionsMembershipInFolder(this, ruleEngine, rulesBean);
      
    }
  
    /**
     * 
     */
    @Override
    public void addElVariables(RuleDefinition ruleDefinition, Map&lt;String, Object&gt; variableMap, 
        RulesBean rulesBean, boolean hasAccessToElApi) {
      flattenedMembershipRemove.addElVariables(ruleDefinition, variableMap, rulesBean, hasAccessToElApi);
    }
    
    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#isCheckOwnerTypeAttributeDef(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isCheckOwnerTypeAttributeDef(RuleDefinition ruleDefinition) {
      return false;
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#isCheckOwnerTypeGroup(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isCheckOwnerTypeGroup(RuleDefinition ruleDefinition) {
      return false;
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#isCheckOwnerTypeStem(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isCheckOwnerTypeStem(RuleDefinition ruleDefinition) {
      return true;
    }
  }, </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogTempToEntity.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogTempToEntity.html#L839">839</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogTempToEntity.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogTempToEntity.html#L942">942</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    String id = changeLogEntry.retrieveValueForLabel(ChangeLogLabels.MEMBERSHIP_DELETE.id);
    Long time = changeLogEntry.getCreatedOnDb();

    PITMembership pitMembership = GrouperDAOFactory.getFactory().getPITMembership().findBySourceIdActive(id, false);
    if (pitMembership == null) {
      return;
    }
    
    pitMembership.setEndTimeDb(time);
    pitMembership.setActiveDb(&quot;F&quot;);

    if (!GrouperUtil.isEmpty(changeLogEntry.getContextId())) {
      pitMembership.setContextId(changeLogEntry.getContextId());
    }
    
    boolean includeFlattenedMemberships = GrouperLoaderConfig.retrieveConfig().propertyValueBoolean(&quot;changeLog.includeFlattenedMemberships&quot;, true);
    boolean includeFlattenedPrivileges = GrouperLoaderConfig.retrieveConfig().propertyValueBoolean(&quot;changeLog.includeFlattenedPrivileges&quot;, true);
    boolean includeRolesWithPermissionChanges = GrouperLoaderConfig.retrieveConfig().propertyValueBoolean(&quot;changeLog.includeRolesWithPermissionChanges&quot;, false);
    pitMembership.setNotificationsForRolesWithPermissionChangesOnSaveOrUpdate(includeRolesWithPermissionChanges);
    pitMembership.setFlatMembershipNotificationsOnSaveOrUpdate(includeFlattenedMemberships);
    pitMembership.setFlatPrivilegeNotificationsOnSaveOrUpdate(includeFlattenedPrivileges);
    
    pitMembership.update();
  }
  
  /**
   * If an access, naming, or attr def privilege gets added, the privilege needs to
   * get added to the PIT table.
   * @param changeLogEntry
   */
  private static void processPrivilegeAdd(ChangeLogEntry changeLogEntry) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L97">97</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L264">264</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      permissionAssignToSubject.addElVariables(ruleDefinition, variableMap, rulesBean, hasAccessToElApi);
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#ruleDefinitions(edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public Set&lt;RuleDefinition&gt; ruleDefinitions(RuleEngine ruleEngine, RulesBean rulesBean) {

      //this should never fire normally, we will use it from a daemon
      return null;
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#validate(edu.internet2.middleware.grouper.rules.RuleDefinition, edu.internet2.middleware.grouper.rules.RuleCheck)
     */
    @Override
    public String validate(RuleDefinition ruleDefinition, RuleCheck ruleCheck) {

      int timestampFrom = -1;
      try {
        timestampFrom = GrouperUtil.intValue(ruleCheck.getCheckArg0(), -1);      
      } catch (Exception e) {
        return &quot;checkArg0 timestampFrom problem &quot; + e.getMessage();
      }
      
      int timestampTo = -1;
      try {
        timestampTo = GrouperUtil.intValue(ruleCheck.getCheckArg1(), -1);      
      } catch (Exception e) {
        return &quot;checkArg1 timestampTo problem &quot; + e.getMessage();
      }
      
      if (timestampTo &lt; 0 &amp;&amp; timestampFrom &lt; 0) {
        return &quot;Enter checkArg0 or checkArg1 or most likely both, &quot; +
            &quot;this is the days in future lower bound and upper bound&quot;;
      }
      
      return this.validate(true, ruleDefinition, ruleCheck, false, false, false, true);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L389">389</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L456">456</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L917">917</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1580">1580</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      return checkKeyForStem(ruleDefinition);
    }


    /**
     * validate this check type
     * @param ruleDefinition
     * @param ruleCheck 
     * @return the error or null if valid
     */
    public String validate(RuleDefinition ruleDefinition, RuleCheck ruleCheck) {
      return validate(false, ruleDefinition, ruleCheck, true, false, true, false);
    }
  
    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#ruleDefinitions(edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public Set&lt;RuleDefinition&gt; ruleDefinitions(RuleEngine ruleEngine, RulesBean rulesBean) {
      
      return ruleDefinitionsMembershipInFolder(this, ruleEngine, rulesBean);
      
    }
  
    /**
     * 
     */
    @Override
    public void addElVariables(RuleDefinition ruleDefinition, Map&lt;String, Object&gt; variableMap, 
        RulesBean rulesBean, boolean hasAccessToElApi) {
      flattenedMembershipRemove.addElVariables(ruleDefinition, variableMap, rulesBean, hasAccessToElApi);
    }
    
    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#isCheckOwnerTypeAttributeDef(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isCheckOwnerTypeAttributeDef(RuleDefinition ruleDefinition) {
      return false;
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#isCheckOwnerTypeGroup(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isCheckOwnerTypeGroup(RuleDefinition ruleDefinition) {
      return false;
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#isCheckOwnerTypeStem(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isCheckOwnerTypeStem(RuleDefinition ruleDefinition) {
      return true;
    }
  }, </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\AttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDef.html#L2159">2159</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\AttributeDefName.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDefName.html#L1414">1414</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * @see GrouperObject#matchesLowerSearchStrings(Set)
   */
  @Override
  public boolean matchesLowerSearchStrings(Set&lt;String&gt; filterStrings) {

    if (GrouperUtil.length(filterStrings) == 0) {
      return true;
    }

    String lowerId = this.getId().toLowerCase();
    String lowerName = StringUtils.defaultString(this.getName()).toLowerCase();
    String lowerDisplayName = StringUtils.defaultString(this.getDisplayName()).toLowerCase();
    String lowerDescription = StringUtils.defaultString(this.getDescription()).toLowerCase();
    
    for (String filterString : GrouperUtil.nonNull(filterStrings)) {
      
      //if all dont match, return false
      if (!lowerId.contains(filterString)
          &amp;&amp; !lowerName.contains(filterString)
          &amp;&amp; !lowerDisplayName.contains(filterString)
          &amp;&amp; !lowerDescription.contains(filterString)) {
        return false;
      }
      
    }
    return true;
  }

  
}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L218">218</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogType.html#L251">251</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public String retrieveAuditEntryFieldForLabel(String label, boolean exceptionIfNotFound) {
    if (StringUtils.equals(label, this.labelString01)) {
      return &quot;string01&quot;;
    }
    if (StringUtils.equals(label, this.labelString02)) {
      return &quot;string02&quot;;
    }
    if (StringUtils.equals(label, this.labelString03)) {
      return &quot;string03&quot;;
    }
    if (StringUtils.equals(label, this.labelString04)) {
      return &quot;string04&quot;;
    }
    if (StringUtils.equals(label, this.labelString05)) {
      return &quot;string05&quot;;
    }
    if (StringUtils.equals(label, this.labelString06)) {
      return &quot;string06&quot;;
    }
    if (StringUtils.equals(label, this.labelString07)) {
      return &quot;string07&quot;;
    }
    if (StringUtils.equals(label, this.labelString08)) {
      return &quot;string08&quot;;
    }

    if (StringUtils.equals(label, this.labelInt01)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeDefDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeDefDAO.html#L419">419</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeDefNameDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeDefNameDAO.html#L523">523</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        switch (attributeAssignType) {
          case any_mem:
            whereClause.append(&quot; theAttributeDef.assignToEffMembershipDb = 'T' &quot;);
            break;
          case any_mem_asgn:
            whereClause.append(&quot; theAttributeDef.assignToEffMembershipAssnDb = 'T' &quot;);
            break;
          case attr_def:
            whereClause.append(&quot; theAttributeDef.assignToAttributeDefDb = 'T' &quot;);
            break;
          case attr_def_asgn:
            whereClause.append(&quot; theAttributeDef.assignToAttributeDefAssnDb = 'T' &quot;);
            break;
          case group:
            whereClause.append(&quot; theAttributeDef.assignToGroupDb = 'T' &quot;);
            break;
          case group_asgn:
            whereClause.append(&quot; theAttributeDef.assignToGroupAssnDb = 'T' &quot;);
            break;
          case imm_mem:
            whereClause.append(&quot; theAttributeDef.assignToImmMembershipDb = 'T' &quot;);
            break;
          case imm_mem_asgn:
            whereClause.append(&quot; theAttributeDef.assignToImmMembershipAssnDb = 'T' &quot;);
            break;
          case member:
            whereClause.append(&quot; theAttributeDef.assignToMemberDb = 'T' &quot;);
            break;
          case mem_asgn:
            whereClause.append(&quot; theAttributeDef.assignToMemberAssnDb = 'T' &quot;);
            break;
          case stem:
            whereClause.append(&quot; theAttributeDef.assignToStemDb = 'T' &quot;);
            break;
          case stem_asgn:
            whereClause.append(&quot; theAttributeDef.assignToStemAssnDb = 'T' &quot;);
            break;
          default:
            throw new RuntimeException(&quot;Not expecting attribute assign type: &quot; + attributeAssignType);
        }
      }
      
      //see if there is a scope
      if (!StringUtils.isBlank(scope)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L1380">1380</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L1430">1430</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      Field f, Collection&lt;Member&gt; members, boolean enabledOnly) throws GrouperDAOException {
    
    if (members == null) {
      return null;
    }
    if (members.size() == 0) {
      return new LinkedHashSet&lt;Membership&gt;();
    }

    //lets page through these
    List&lt;Member&gt; totalMembersList = GrouperUtil.listFromCollection(members);
    int pages = GrouperUtil.batchNumberOfBatches(totalMembersList, batchSize);
    
    Set&lt;Membership&gt; memberships = new LinkedHashSet&lt;Membership&gt;();
    
    for (int i=0; i&lt;pages; i++) {
      List&lt;Member&gt; memberList = GrouperUtil.batchList(totalMembersList, batchSize, i);
      
      List&lt;String&gt; uuids = GrouperUtil.propertyList(memberList, Member.PROPERTY_UUID, String.class);
      
      ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic();
      StringBuilder query = new StringBuilder(&quot;select ms&quot;
          + &quot; from MembershipEntry ms where&quot;
          + &quot; ms.ownerGroupId      = :owner &quot;
          + &quot;and  ms.fieldId = :fieldId &quot;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L518">518</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L640">640</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1497">1497</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  flattenedMembershipRemove {

    /**
     * @see RuleCheckType#checkKey(RuleDefinition)
     */
    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      RuleCheck ruleCheck = ruleDefinition.getCheck();
      if (StringUtils.isBlank(ruleCheck.getCheckOwnerId()) &amp;&amp; StringUtils.isBlank(ruleCheck.getCheckOwnerName())) {
        //if this is assigned to a group
        if (!StringUtils.isBlank(ruleDefinition.getAttributeAssignType().getOwnerGroupId())) {

          //clone so we dont edit the object
          ruleCheck = ruleCheck.clone();
          //set the owner to this group
          ruleCheck.setCheckOwnerId(ruleDefinition.getAttributeAssignType().getOwnerGroupId());
        } else {
          LOG.error(&quot;Not sure why no check owner if not assigned to group&quot;);
        }
      }
      return ruleCheck;
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#ruleDefinitions(edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public Set&lt;RuleDefinition&gt; ruleDefinitions(RuleEngine ruleEngine, RulesBean rulesBean) {
      
      return ruleDefinitionsMembership(this, ruleEngine, rulesBean);
    }

    /**
     * 
     */
    @Override
    public void addElVariables(RuleDefinition ruleDefinition, Map&lt;String, Object&gt; variableMap, 
        RulesBean rulesBean, boolean hasAccessToElApi) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L389">389</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L747">747</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>              GrouperUtil.toSet(memberId), &quot;immediate&quot;, true);
        
        return GrouperUtil.length(memberships) == 0;
        
      } finally {
        GrouperSession.stopQuietly(rootSession);
      }
    }

    /**
     * 
     */
    @Override
    public String validate(RuleDefinition ruleDefinition) {

      return RuleUtils.validateGroup(ruleDefinition.getIfCondition().getIfOwnerId(), 
          ruleDefinition.getIfCondition().getIfOwnerName(), 
          ruleDefinition.getAttributeAssignType().getOwnerGroupId());

    }
    
    /**
     * @see edu.internet2.middleware.grouper.rules.RuleIfConditionEnum#isIfOwnerTypeAttributeDef(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isIfOwnerTypeAttributeDef(RuleDefinition ruleDefinition) {
      return false;
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleIfConditionEnum#isIfOwnerTypeGroup(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isIfOwnerTypeGroup(RuleDefinition ruleDefinition) {
      if (!StringUtils.isBlank(ruleDefinition.getIfCondition().getIfOwnerId()) || !StringUtils.isBlank(ruleDefinition.getIfCondition().getIfOwnerName())) {
        return true;
      }
      
      return false;
    }

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleIfConditionEnum#isIfOwnerTypeStem(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public boolean isIfOwnerTypeStem(RuleDefinition ruleDefinition) {
      return false;
    }
    
  }, </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L1056">1056</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\AttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDef.html#L1314">1314</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\value\AttributeAssignValue.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/value/AttributeAssignValue.html#L522">522</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditType.html#L248">248</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  
  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }
  
  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }

  /**
   * notes about this assignment, free-form text
   * @return the notes
   */
  public String getNotes() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L523">523</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1329">1329</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      RuleCheck ruleCheck = ruleDefinition.getCheck();
      if (StringUtils.isBlank(ruleCheck.getCheckOwnerId()) &amp;&amp; StringUtils.isBlank(ruleCheck.getCheckOwnerName())) {
        //if this is assigned to a group
        if (!StringUtils.isBlank(ruleDefinition.getAttributeAssignType().getOwnerGroupId())) {

          //clone so we dont edit the object
          ruleCheck = ruleCheck.clone();
          //set the owner to this group
          ruleCheck.setCheckOwnerId(ruleDefinition.getAttributeAssignType().getOwnerGroupId());
        } else {
          LOG.error(&quot;Not sure why no check owner if not assigned to group&quot;);
        }
      }
      return ruleCheck;
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#ruleDefinitions(edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public Set&lt;RuleDefinition&gt; ruleDefinitions(RuleEngine ruleEngine, RulesBean rulesBean) {
      
      return ruleDefinitionsMembership(this, ruleEngine, rulesBean);
    }

    /**
     * 
     */
    @Override
    public void addElVariables(RuleDefinition ruleDefinition, Map&lt;String, Object&gt; variableMap, 
        RulesBean rulesBean, boolean hasAccessToElApi) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L2318">2318</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L1206">1206</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public static final String DATE_FORMAT = &quot;yyyyMMdd&quot;;

  /**
   * string format of dates for file names
   */
  public static final String TIMESTAMP_FILE_FORMAT = &quot;yyyy_MM_dd__HH_mm_ss_SSS&quot;;

  /**
   * timestamp format, make sure to synchronize
   */
  final static SimpleDateFormat timestampFileFormat = new SimpleDateFormat(TIMESTAMP_FILE_FORMAT);

  /**
   * string format of dates
   */
  public static final String DATE_FORMAT2 = &quot;yyyy/MM/dd&quot;;

  /**
   * format including minutes and seconds: yyyy/MM/dd HH:mm:ss
   */
  public static final String DATE_MINUTES_SECONDS_FORMAT = &quot;yyyy/MM/dd HH:mm:ss&quot;;

  /**
   * format including minutes and seconds: yyyyMMdd HH:mm:ss
   */
  public static final String DATE_MINUTES_SECONDS_NO_SLASH_FORMAT = &quot;yyyyMMdd HH:mm:ss&quot;;

  /**
   * format on screen of config for milestone: yyyy/MM/dd HH:mm:ss.SSS
   */
  public static final String TIMESTAMP_FORMAT = &quot;yyyy/MM/dd HH:mm:ss.SSS&quot;;

  /**
   * format on screen of config for milestone: yyyyMMdd HH:mm:ss.SSS
   */
  public static final String TIMESTAMP_NO_SLASH_FORMAT = &quot;yyyyMMdd HH:mm:ss.SSS&quot;;

  /**
   * date format, make sure to synchronize
   */
  final static SimpleDateFormat dateFormat = new SimpleDateFormat(DATE_FORMAT);

  /**
   * date format, make sure to synchronize
   */
  final static SimpleDateFormat dateFormat2 = new SimpleDateFormat(DATE_FORMAT2);

  /**
   * synchronize code that uses this standard formatter for dates with minutes and seconds
   */
  final static SimpleDateFormat dateMinutesSecondsFormat = new SimpleDateFormat(
      DATE_MINUTES_SECONDS_FORMAT);

  /**
   * synchronize code that uses this standard formatter for dates with minutes and seconds
   */
  final static SimpleDateFormat dateMinutesSecondsNoSlashFormat = new SimpleDateFormat(
      DATE_MINUTES_SECONDS_NO_SLASH_FORMAT);

  /**
   * &lt;pre&gt; format: yyyy/MM/dd HH:mm:ss.SSS synchronize code that uses this standard formatter for timestamps &lt;/pre&gt;
   */
  final static SimpleDateFormat timestampFormat = new SimpleDateFormat(TIMESTAMP_FORMAT);

  /**
   * synchronize code that uses this standard formatter for timestamps
   */
  final static SimpleDateFormat timestampNoSlashFormat = new SimpleDateFormat(
      TIMESTAMP_NO_SLASH_FORMAT);

  /**
   * If false, throw an assertException, and give a reason
   *
   * @param isTrue
   * @param reason
   */
  public static void assertion(boolean isTrue, String reason) {
    if (!isTrue) {
      throw new RuntimeException(reason);
    }

  }

  /**
   * use the field cache, expire every day (just to be sure no leaks)
   */
  private static GrouperCache&lt;String, Set&lt;Field&gt;&gt; fieldSetCache = null;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDef.html#L104">104</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroup.html#L110">110</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  private String sourceId;
  
  /**
   * @return source id
   */
  public String getSourceId() {
    return sourceId;
  }

  /**
   * set source id
   * @param sourceId
   */
  public void setSourceId(String sourceId) {
    this.sourceId = sourceId;
  }
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#clone()
   */
  @Override
  public GrouperAPI clone() {
    return GrouperUtil.clone(this, CLONE_FIELDS);
  }

  /**
   * @return context id
   */
  public String getContextId() {
    return contextId;
  }

  /**
   * set context id
   * @param contextId
   */
  public void setContextId(String contextId) {
    this.contextId = contextId;
  }

  /**
   * @return id
   */
  public String getId() {
    return id;
  }

  /**
   * set id
   * @param id
   */
  public void setId(String id) {
    this.id = id;
  }

  /**
   * @return name
   */
  public String getName() {
    return name;
  }
  
  /**
   * @return name
   */
  public String getNameDb() {
    return name;
  }

  /**
   * Set name
   * @param name
   */
  public void setNameDb(String name) {
    this.name = name;
  }
  
  /**
   * @return stem id
   */
  public String getStemId() {
    return stemId;
  }
  
  /**
   * @param stemId
   */
  public void setStemId(String stemId) {
    this.stemId = stemId;
  }
  
  /**
   * @return attributeDefType
   */
  public String getAttributeDefTypeDb() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L1766">1766</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L744">744</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>                toStringForLog(Array.get(object, i), maxChars)).append(&quot;\n&quot;);
            if (maxChars != -1 &amp;&amp; result.length() &gt; maxChars) {
              return;
            }
          }
        }
      } else if (object instanceof Collection) {
        //give size and type if collection
        Collection&lt;Object&gt; collection = (Collection&lt;Object&gt;) object;
        int collectionSize = collection.size();
        if (collectionSize == 0) {
          result.append(&quot;Empty &quot;).append(object.getClass().getSimpleName());
        } else {
          result.append(object.getClass().getSimpleName()).append(&quot; size: &quot;).append(collectionSize).append(&quot;: &quot;);
          int i=0;
          for (Object collectionObject : collection) {
            result.append(&quot;[&quot;).append(i).append(&quot;]: &quot;).append(</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L1056">1056</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\AttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDef.html#L1314">1314</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\value\AttributeAssignValue.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/value/AttributeAssignValue.html#L522">522</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L459">459</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogType.html#L512">512</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  
  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }
  
  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogConsumer.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogConsumer.html#L155">155</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditType.html#L248">248</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }

  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2582">2582</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3268">3268</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (stemIdsSize &gt; 0) {
      sql.append(&quot; and aa.ownerStemId in (&quot;);
      sql.append(HibUtils.convertToInClause(stemIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefIdsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefNameIdsSize &gt; 0) {
      sql.append(&quot; and adn.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeDefNameIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    byHqlStatic
      .setCacheable(false)
      .setCacheRegion(KLASS + &quot;.FindStemAttributeDefNames&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\externalSubjects\ExternalSubject.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/externalSubjects/ExternalSubject.html#L663">663</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\externalSubjects\ExternalSubjectAttribute.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/externalSubjects/ExternalSubjectAttribute.html#L352">352</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }
  
  /**
   * @see GrouperAPI#onPreSave(HibernateSession)
   */
  @Override
  public void onPreSave(HibernateSession hibernateSession) {
    super.onPreSave(hibernateSession);
    
    if (StringUtils.isBlank(this.getUuid())) {
      this.setUuid(GrouperUuid.getUuid());
    }
    
    this.setModifierMemberId( GrouperSession.staticGrouperSession().getMember().getUuid() );
    this.setModifyTimeDb( System.currentTimeMillis() );

    this.setCreatorMemberId( GrouperSession.staticGrouperSession().getMember().getUuid() );
    this.setCreateTimeDb( System.currentTimeMillis() );
  }


  /**
   * @see GrouperAPI#onPreUpdate(HibernateSession)
   */
  @Override
  public void onPreUpdate(HibernateSession hibernateSession) {
    
    super.onPreUpdate(hibernateSession);
    
    this.setModifierMemberId( GrouperSession.staticGrouperSession().getMember().getUuid() );
    this.setModifyTimeDb( System.currentTimeMillis() );

  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderJob.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderJob.html#L405">405</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderJob.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderJob.html#L563">563</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          hib3GrouploaderLog, grouperSession, andGroups, groupTypes, groupLikeString, groupQuery, startTime);
      
      //call hooks if registered
      GrouperHooksUtils.callHooksIfRegistered(GrouperHookType.LOADER, 
          LoaderHooks.METHOD_LOADER_PRE_RUN, HooksLoaderBean.class, loaderJobBean, 
          LoaderJobBean.class, VetoTypeGrouper.LOADER_PRE_RUN);
  
      //based on type, run query from the db and sync members
      grouperLoaderTypeEnum.runJob(loaderJobBean);
  
      //call hooks if registered
      GrouperHooksUtils.callHooksIfRegistered(GrouperHookType.LOADER, 
          LoaderHooks.METHOD_LOADER_POST_RUN, HooksLoaderBean.class, loaderJobBean, 
          LoaderJobBean.class, VetoTypeGrouper.LOADER_POST_RUN);
      
    } catch (Exception t) {
      LOG.error(&quot;Error on job: &quot; + jobName, t);
      
      hib3GrouploaderLog.setStatus(GrouperLoaderStatus.ERROR.name());
      hib3GrouploaderLog.appendJobMessage(ExceptionUtils.getFullStackTrace(t));
      throwExceptionsInFinally = false;
      if (t instanceof RuntimeException) {
        throw (RuntimeException)t;
      }
      throw new RuntimeException(t.getMessage(), t);
    } finally {
      
      storeLogInDb(hib3GrouploaderLog, throwExceptionsInFinally, startTime);
    }
    
  }

  /**
   * run a job (either from quartz or outside)
   * @param hib3GrouploaderLog will get information, most importantly the job name
   * @param jobGroup group that this ldap job is about
   * @param grouperSession 
   */
  public static void runJobLdap(Hib3GrouperLoaderLog hib3GrouploaderLog, Group jobGroup, GrouperSession grouperSession) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderJob.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderJob.html#L405">405</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderJob.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderJob.html#L643">643</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          hib3GrouploaderLog, grouperSession, andGroups, groupTypes, groupLikeString, groupQuery, startTime);
      
      //call hooks if registered
      GrouperHooksUtils.callHooksIfRegistered(GrouperHookType.LOADER, 
          LoaderHooks.METHOD_LOADER_PRE_RUN, HooksLoaderBean.class, loaderJobBean, 
          LoaderJobBean.class, VetoTypeGrouper.LOADER_PRE_RUN);
  
      //based on type, run query from the db and sync members
      grouperLoaderTypeEnum.runJob(loaderJobBean);
  
      //call hooks if registered
      GrouperHooksUtils.callHooksIfRegistered(GrouperHookType.LOADER, 
          LoaderHooks.METHOD_LOADER_POST_RUN, HooksLoaderBean.class, loaderJobBean, 
          LoaderJobBean.class, VetoTypeGrouper.LOADER_POST_RUN);
      
    } catch (Exception t) {
      LOG.error(&quot;Error on job: &quot; + jobName, t);
      
      hib3GrouploaderLog.setStatus(GrouperLoaderStatus.ERROR.name());
      hib3GrouploaderLog.appendJobMessage(ExceptionUtils.getFullStackTrace(t));
      throwExceptionsInFinally = false;
      if (t instanceof RuntimeException) {
        throw (RuntimeException)t;
      }
      throw new RuntimeException(t.getMessage(), t);
    } finally {
      
      storeLogInDb(hib3GrouploaderLog, throwExceptionsInFinally, startTime);
    }
    
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L46">46</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\userAudit\XmlAuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/userAudit/XmlAuditType.html#L33">33</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>public class AuditType extends GrouperAPI implements Hib3GrouperVersioned, XmlImportable&lt;AuditType&gt; {

  //*****  START GENERATED WITH GenerateFieldConstants.java *****//

  /** constant for field name for: actionName */
  public static final String FIELD_ACTION_NAME = &quot;actionName&quot;;

  /** constant for field name for: auditCategory */
  public static final String FIELD_AUDIT_CATEGORY = &quot;auditCategory&quot;;

  /** constant for field name for: contextId */
  public static final String FIELD_CONTEXT_ID = &quot;contextId&quot;;

  /** constant for field name for: createdOnDb */
  public static final String FIELD_CREATED_ON_DB = &quot;createdOnDb&quot;;

  /** constant for field name for: id */
  public static final String FIELD_ID = &quot;id&quot;;

  /** constant for field name for: labelInt01 */
  public static final String FIELD_LABEL_INT01 = &quot;labelInt01&quot;;

  /** constant for field name for: labelInt02 */
  public static final String FIELD_LABEL_INT02 = &quot;labelInt02&quot;;

  /** constant for field name for: labelInt03 */
  public static final String FIELD_LABEL_INT03 = &quot;labelInt03&quot;;

  /** constant for field name for: labelInt04 */
  public static final String FIELD_LABEL_INT04 = &quot;labelInt04&quot;;

  /** constant for field name for: labelInt05 */
  public static final String FIELD_LABEL_INT05 = &quot;labelInt05&quot;;

  /** constant for field name for: labelString01 */
  public static final String FIELD_LABEL_STRING01 = &quot;labelString01&quot;;

  /** constant for field name for: labelString02 */
  public static final String FIELD_LABEL_STRING02 = &quot;labelString02&quot;;

  /** constant for field name for: labelString03 */
  public static final String FIELD_LABEL_STRING03 = &quot;labelString03&quot;;

  /** constant for field name for: labelString04 */
  public static final String FIELD_LABEL_STRING04 = &quot;labelString04&quot;;

  /** constant for field name for: labelString05 */
  public static final String FIELD_LABEL_STRING05 = &quot;labelString05&quot;;

  /** constant for field name for: labelString06 */
  public static final String FIELD_LABEL_STRING06 = &quot;labelString06&quot;;

  /** constant for field name for: labelString07 */
  public static final String FIELD_LABEL_STRING07 = &quot;labelString07&quot;;

  /** constant for field name for: labelString08 */
  public static final String FIELD_LABEL_STRING08 = &quot;labelString08&quot;;

  /** constant for field name for: lastUpdatedDb */
  public static final String FIELD_LAST_UPDATED_DB = &quot;lastUpdatedDb&quot;;

  //*****  END GENERATED WITH GenerateFieldConstants.java *****//

  /**
   * fields in to string deep method
   */
  private static final Set&lt;String&gt; TO_STRING_DEEP_FIELDS = GrouperUtil.toSet(</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3032">3032</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3179">3179</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        .setString(&quot;owner&quot;, attributeDefId)
        .options(queryOptions);

      HibUtils.convertFieldsToSqlInString(fields, byHqlStatic, sql, &quot;ms.fieldId&quot;);
      HibUtils.convertSourcesToSqlInString(sources, byHqlStatic, sql, &quot;m.subjectSourceIdDb&quot;);
      
      if (membershipType != null) {
        sql.append(&quot;and  ms.type &quot;).append(membershipType.queryClause());
      }
      
      if (enabled != null) {
        sql.append(&quot; and ms.enabledDb = '&quot; + (enabled ? 'T' : 'F') + &quot;'&quot;);
      }
      sql.append(&quot; and ms.memberUuid in (&quot;);
      sql.append(HibUtils.convertToInClause(memberIds, byHqlStatic));
      sql.append(&quot;) &quot;);
      
      byHqlStatic.createQuery(sql.toString());
      Set&lt;Object[]&gt; mships = byHqlStatic.listSet(Object[].class);
      
      totalResults.addAll(mships);
          
    }
    
    return totalResults;
  }

  /**
   * generally you will order by m.subjectSourceIdDb, m.subjectIdDb, and page to the first 100
   * @see edu.internet2.middleware.grouper.internal.dao.MembershipDAO#findAllMembersByAttributeDefOwnerOptions(java.lang.String, edu.internet2.middleware.grouper.membership.MembershipType, java.util.Collection, java.util.Set, java.lang.Boolean, edu.internet2.middleware.grouper.internal.dao.QueryOptions)
   */
  public List&lt;Member&gt; findAllMembersByAttributeDefOwnerOptions(String attributeDefId,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L355">355</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L459">459</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L546">546</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleIfConditionEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleIfConditionEnum.html#L713">713</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    @Override
    public boolean shouldFire(RuleDefinition ruleDefinition, RuleEngine ruleEngine,
        RulesBean rulesBean) {
      
      String memberId = null;
      try {
        memberId = rulesBean.getMemberId();
      } catch (Exception e) {
        //ignore
      }
      
      GrouperSession rootSession = GrouperSession.startRootSession(false);
      try {
        
        if (StringUtils.isBlank(memberId)) {
          
          Member member = MemberFinder.findBySubject(rootSession, rulesBean.getSubject(), false);
          memberId = member == null ? null : member.getUuid();

          if (StringUtils.isBlank(memberId )) {
            return false;
          }
        }
        Group group = RuleUtils.group(ruleDefinition.getIfCondition().getIfOwnerId(), 
            ruleDefinition.getIfCondition().getIfOwnerName(), ruleDefinition.getAttributeAssignType().getOwnerGroupId(), false, false);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderJob.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderJob.html#L563">563</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderJob.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderJob.html#L643">643</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          grouperLoaderLdapGroupAttrUpdaters);

      //call hooks if registered
      GrouperHooksUtils.callHooksIfRegistered(GrouperHookType.LOADER, 
          LoaderHooks.METHOD_LOADER_PRE_RUN, HooksLoaderBean.class, loaderJobBean, 
          LoaderJobBean.class, VetoTypeGrouper.LOADER_PRE_RUN);

      //based on type, run query from the db and sync members
      grouperLoaderTypeEnum.runJob(loaderJobBean);

      //call hooks if registered
      GrouperHooksUtils.callHooksIfRegistered(GrouperHookType.LOADER, 
          LoaderHooks.METHOD_LOADER_POST_RUN, HooksLoaderBean.class, loaderJobBean, 
          LoaderJobBean.class, VetoTypeGrouper.LOADER_POST_RUN);
      
    } catch (Exception t) {
      LOG.error(&quot;Error on job: &quot; + jobName, t);
      
      hib3GrouploaderLog.setStatus(GrouperLoaderStatus.ERROR.name());
      hib3GrouploaderLog.appendJobMessage(ExceptionUtils.getFullStackTrace(t));
      throwExceptionsInFinally = false;
      if (t instanceof RuntimeException) {
        throw (RuntimeException)t;
      }
      throw new RuntimeException(t.getMessage(), t);
    } finally {
      
      storeLogInDb(hib3GrouploaderLog, throwExceptionsInFinally, startTime);
    }
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITMembershipView.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembershipView.html#L354">354</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITPermissionAllView.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITPermissionAllView.html#L273">273</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * @return groupSetActiveDb
   */
  public String getGroupSetActiveDb() {
    return groupSetActiveDb;
  }

  /**
   * @param groupSetActiveDb
   */
  public void setGroupSetActiveDb(String groupSetActiveDb) {
    this.groupSetActiveDb = groupSetActiveDb;
  }

  /**
   * @return groupSetStartTimeDb
   */
  public Long getGroupSetStartTimeDb() {
    return groupSetStartTimeDb;
  }

  /**
   * @param groupSetStartTimeDb
   */
  public void setGroupSetStartTimeDb(Long groupSetStartTimeDb) {
    this.groupSetStartTimeDb = groupSetStartTimeDb;
  }

  /**
   * @return groupSetEndTimeDb
   */
  public Long getGroupSetEndTimeDb() {
    return groupSetEndTimeDb;
  }

  /**
   * @param groupSetEndTimeDb
   */
  public void setGroupSetEndTimeDb(Long groupSetEndTimeDb) {
    this.groupSetEndTimeDb = groupSetEndTimeDb;
  }
  
  /**
   * @return membershipActiveDb
   */
  public String getMembershipActiveDb() {
    return membershipActiveDb;
  }

  /**
   * @param membershipActiveDb
   */
  public void setMembershipActiveDb(String membershipActiveDb) {
    this.membershipActiveDb = membershipActiveDb;
  }

  /**
   * @return membershipStartTimeDb
   */
  public Long getMembershipStartTimeDb() {
    return membershipStartTimeDb;
  }

  /**
   * @param membershipStartTimeDb
   */
  public void setMembershipStartTimeDb(Long membershipStartTimeDb) {
    this.membershipStartTimeDb = membershipStartTimeDb;
  }

  /**
   * @return membershipEndTimeDb
   */
  public Long getMembershipEndTimeDb() {
    return membershipEndTimeDb;
  }

  /**
   * @param membershipEndTimeDb
   */
  public void setMembershipEndTimeDb(Long membershipEndTimeDb) {
    this.membershipEndTimeDb = membershipEndTimeDb;
  }

  /**
   * @return true if active
   */
  public boolean isActive() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1027">1027</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1080">1080</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        RuleCheckType.flattenedMembershipAddInFolder.name());
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleCheckStemScopeName(),
        stemScope.name());
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumName(), RuleThenEnum.sendEmail.name());
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg0Name(), emailToValue);

    //the to, subject, or body could be text with EL variables, or could be a template.  If template, it is
    //read from the classpath from package: grouperRulesEmailTemplates/theTemplateName.txt
    //or you could configure grouper.properties to keep them in an external folder, not in the classpath
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg1Name(), emailSubjectValue);
    
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg2Name(), emailBodyValue);
    
    //should be valid
    String isValidString = attributeAssign.getAttributeValueDelegate().retrieveValueString(
        RuleUtils.ruleValidName());

    if (!StringUtils.equals(&quot;T&quot;, isValidString)) {
      throw new RuntimeException(isValidString);
    }
    
    return attributeAssign;

  }

  /**
   * 
   * @param actAsSubject
   * @param ruleStem
   * @param stemScope
   * @param emailToValue
   * @param emailSubjectValue
   * @param emailBodyValue
   * @return the assignment to tweak it
   */
  public static AttributeAssign emailOnFlattenedMembershipRemoveFromStem(Subject actAsSubject, Stem ruleStem,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\db\GrouperLoaderResultset.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/db/GrouperLoaderResultset.html#L455">455</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\db\GrouperLoaderResultset.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/db/GrouperLoaderResultset.html#L730">730</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>              String[] extraAttributeArray = null;

              if (!StringUtils.isBlank(extraAttributes)) {
                extraAttributeArray = GrouperUtil.splitTrim(extraAttributes, &quot;,&quot;);
                for (String attribute : extraAttributeArray) {
                  attributesList.add(attribute);
                }

              }

              SearchFilter searchFilterObject = new SearchFilter(filter);
              String[] attributeArray = GrouperUtil.toArray(attributesList, String.class);

              SearchControls searchControls = ldap.getLdapConfig().getSearchControls(
                  attributeArray);

              if (ldapSearchScopeEnum != null) {
                searchControls.setSearchScope(ldapSearchScopeEnum
                    .getSeachControlsConstant());
              }

              if (StringUtils.isBlank(searchDn)) {
                searchResultIterator = ldap.search(
                    searchFilterObject, searchControls);
              } else {
                searchResultIterator = ldap.search(searchDn,
                    searchFilterObject, searchControls);
              }

              Map&lt;String, List&lt;String&gt;&gt; result = new HashMap&lt;String, List&lt;String&gt;&gt;();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L4831">4831</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L2224">2224</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          || equalsIgnoreCase(string, &quot;off&quot;)
          || equalsIgnoreCase(string, &quot;n&quot;)) {
        return false;
      }
      throw new RuntimeException(
          &quot;Invalid string to boolean conversion: '&quot; + string
              + &quot;' expecting true|false or t|f or yes|no or y|n case insensitive&quot;);

    }
    throw new RuntimeException(&quot;Cant convert object to boolean: &quot;
        + object.getClass());

  }

  /**
   * get the boolean value for an object
   *
   * @param object
   * @param defaultBoolean
   *            if object is null or empty
   * @return the boolean
   */
  public static boolean booleanValue(Object object, boolean defaultBoolean) {
    if (nullOrBlank(object)) {
      return defaultBoolean;
    }
    return booleanValue(object);
  }

  /**
   * get the Boolean value for an object
   *
   * @param object
   * @return the Boolean or null if null or empty
   */
  public static Boolean booleanObjectValue(Object object) {
    if (nullOrBlank(object)) {
      return null;
    }
    return booleanValue(object);
  }

  /**
   * is an object null or blank
   *
   * @param object
   * @return true if null or blank
   */
  public static boolean nullOrBlank(Object object) {
    // first handle blanks and nulls
    if (object == null) {
      return true;
    }
    if (object instanceof String &amp;&amp; isBlank(((String) object))) {
      return true;
    }
    return false;

  }

  /**
   * get a getter method object for a class, potentially in superclasses
   * @param theClass
   * @param fieldName
   * @param callOnSupers true if superclasses should be looked in for the getter
   * @param throwExceptionIfNotFound will throw runtime exception if not found
   * @return the getter object or null if not found (or exception if param is set)
   */
  public static Method getter(Class theClass, String fieldName, boolean callOnSupers,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2012">2012</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2563">2563</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        sqlTables, &quot;aa.ownerGroupId&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);
  
    StringBuilder sql;
    if (changedQuery) {
      sqlTables.append(&quot; and &quot;);
    } else {
      sqlTables.append(&quot; where &quot;);
    }
    sql = sqlTables.append(sqlWhereClause);
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (groupIdsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2055">2055</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2206">2206</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2606">2606</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2735">2735</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      .setCacheRegion(KLASS + &quot;.FindGroupAttributeDefNames&quot;);
  
    int maxAssignments = GrouperConfig.retrieveConfig().propertyValueInt(&quot;ws.findAttrAssignments.maxResultSize&quot;, 30000);
    
    //if -1, lets not check
    long size = -1;
    
    if (maxAssignments &gt;= 0) {
  
      size = byHqlStatic.createQuery(countPrefix + sql.toString()).uniqueResult(long.class);    
      
      //see if too many
      if (size &gt; maxAssignments) {
        throw new RuntimeException(&quot;Too many results: &quot; + size);
      }
      
    }
    
    Set&lt;AttributeDefName&gt; results = size == 0 ? new LinkedHashSet&lt;AttributeDefName&gt;() 
        : byHqlStatic.createQuery(selectPrefix + sql.toString()).listSet(AttributeDefName.class);
  
    //nothing to filter
    if (GrouperUtil.length(results) == 0) {
      return results;
    }
    
    //if the hql didnt filter, we need to do that here
    results = filterAttributeDefNames(grouperSession, results);
    
    //we should be down to the secure list
    return results;
      
  }

  /**
   * 
   * @param grouperSession
   * @param attibuteDefNames
   * @return the names which are ok to view
   */
  public Set&lt;AttributeDefName&gt; filterAttributeDefNames(GrouperSession grouperSession, Set&lt;AttributeDefName&gt; attibuteDefNames) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Group.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Group.html#L1566">1566</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Group.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Group.html#L5248">5248</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public boolean canReadField(Subject subj, Field f) 
    throws  IllegalArgumentException,
            SchemaException
  {
    GrouperValidator v = NotNullValidator.validate(subj);
    if (v.isInvalid()) {
      throw new IllegalArgumentException( &quot;subject: &quot; + v.getErrorMessage() );
    }
    v = NotNullValidator.validate(f);
    if (v.isInvalid()) {
      throw new IllegalArgumentException( &quot;field: &quot; + v.getErrorMessage() );
    }
    v = FieldTypeValidator.validate(f);
    if (v.isInvalid()) {
      throw new SchemaException( v.getErrorMessage() );
    }
    GroupType groupType = f.getGroupType(false);
    if (groupType != null &amp;&amp; !this.hasType(groupType)) {
      throw new SchemaException(E.INVALID_GROUP_TYPE + groupType.toString());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2012">2012</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2293">2293</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2563">2563</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        sqlTables, &quot;aa.ownerGroupId&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);
  
    StringBuilder sql;
    if (changedQuery) {
      sqlTables.append(&quot; and &quot;);
    } else {
      sqlTables.append(&quot; where &quot;);
    }
    sql = sqlTables.append(sqlWhereClause);
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (groupIdsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L251">251</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L832">832</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      }
      
      if (actionsSize &gt; 0) {
        sql.append(&quot; and pea.action in (&quot;);
        sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
        sql.append(&quot;) &quot;);
      }
      if (roleIdsSize &gt; 0) {
        sql.append(&quot; and pea.roleId in (&quot;);
        sql.append(HibUtils.convertToInClause(roleIds, byHqlStatic));
        sql.append(&quot;) &quot;);
      }
      if (attributeDefIdsSize &gt; 0) {
        sql.append(&quot; and pea.attributeDefId in (&quot;);
        sql.append(HibUtils.convertToInClause(attributeDefIds, byHqlStatic));
        sql.append(&quot;) &quot;);
      }
      if (attributeDefNameIdsSize &gt; 0) {
        sql.append(&quot; and pea.attributeDefNameId in (&quot;);
        sql.append(HibUtils.convertToInClause(attributeDefNameIds, byHqlStatic));
        sql.append(&quot;) &quot;);
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\membership\MembershipPathGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/membership/MembershipPathGroup.html#L463">463</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\membership\MembershipPathGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/membership/MembershipPathGroup.html#L491">491</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    grouperSession = GrouperSession.start(sessionSubject2);

    System.out.println(&quot;####### member #######&quot;);
    membershipPathGroup = MembershipPathGroup.analyze(endGroup, memberMember, Group.getDefaultList());

    System.out.println(membershipPathGroup.toString());

    System.out.println(&quot;####### groupPriv #######&quot;);
    membershipPathGroup = MembershipPathGroup.analyzePrivileges(privGroup, memberMember);
    
    System.out.println(membershipPathGroup.toString());
    
    membershipPathGroup = MembershipPathGroup.analyzePrivileges(privStem, memberMember);
    
    System.out.println(&quot;####### stemPriv #######&quot;);
    System.out.println(membershipPathGroup.toString());
    
    membershipPathGroup = MembershipPathGroup.analyzePrivileges(privAttributeDef, memberMember);
    
    System.out.println(&quot;####### attributeDefPriv #######&quot;);
    System.out.println(membershipPathGroup.toString());
    

    //########################## noncomposite as test.subject.3
    System.out.println(&quot;\n\n########################## noncomposite as test.subject.3\n&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L952">952</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1247">1247</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    sql = sqlTables.append(sqlWhereClause);
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }

    if (attributeDefType != null) {
      sql.append(&quot; and adn.attributeDefId = ad.id and ad.attributeDefTypeDb = :theAttributeDefType &quot;);
      byHqlStatic.setString(&quot;theAttributeDefType&quot;, attributeDefType.name());
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (groupIdsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L992">992</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1288">1288</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1609">1609</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1785">1785</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3049">3049</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3293">3293</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      .setCacheRegion(KLASS + &quot;.FindGroupAttributeAssignments&quot;);

    int maxAssignments = GrouperConfig.retrieveConfig().propertyValueInt(&quot;ws.findAttrAssignments.maxResultSize&quot;, 30000);
    
    //if -1, lets not check
    long size = -1;
    
    if (maxAssignments &gt;= 0) {

      size = byHqlStatic.createQuery(countPrefix + sql.toString()).uniqueResult(long.class);    
      
      //see if too many
      if (size &gt; maxAssignments) {
        throw new RuntimeException(&quot;Too many results: &quot; + size);
      }
      
    }
    
    Set&lt;AttributeAssign&gt; results = size == 0 ? new LinkedHashSet&lt;AttributeAssign&gt;() 
        : byHqlStatic.createQuery(selectPrefix + sql.toString()).listSet(AttributeAssign.class);

    //nothing to filter
    if (GrouperUtil.length(results) == 0) {
      return results;
    }
    
    //if the hql didnt filter, we need to do that here
    results = grouperSession.getAttributeDefResolver().postHqlFilterAttributeAssigns(grouperSessionSubject, results);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L597">597</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L702">702</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      .setCacheRegion(KLASS + &quot;.findPermissions&quot;);

    int maxAssignments = GrouperConfig.retrieveConfig().propertyValueInt(&quot;ws.findPermissions.maxResultSize&quot;, 30000);
    
    String sqlString = sql.toString();
    
    //if we did where and, then switch to where
    sqlString = sqlString.replaceAll(&quot;where\\s+and&quot;, &quot;where&quot;);
    sqlString = sqlString.replaceAll(&quot;where\\s*$&quot;, &quot;&quot;);
    
    Set&lt;PermissionEntry&gt; results = byHqlStatic.createQuery(selectPrefix + sqlString).listSet(PermissionEntry.class);

    int size = GrouperUtil.length(results);
    if (maxAssignments &gt;= 0) {

      //doesnt work on mysql i think due to hibernate and composite key
      //size = byHqlStatic.createQuery(countPrefix + sqlString).uniqueResult(long.class);    
      
      //see if too many
      if (size &gt; maxAssignments) {
        throw new RuntimeException(&quot;Too many results: &quot; + size);
      }
      
    }
    

    //nothing to filter
    if (size == 0) {
      return results;
    }
    
    //if the hql didnt filter, we need to do that here
    results = grouperSession.getAttributeDefResolver().postHqlFilterPermissions(grouperSessionSubject, results);
    
    //we should be down to the secure list
    return results;
  }

  /**
   * @see PermissionEntry#findRolePermissions(String attributeDefId, String attributeDefNameId, String ownerRoleId, String action, Boolean enabled)
   */
  public Set&lt;PermissionEntry&gt; findRolePermissions(String attributeDefId,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L6013">6013</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L2714">2714</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      return input.toString();
    }
    if (input instanceof Number) {
      DecimalFormat decimalFormat = new DecimalFormat(
          &quot;###################.###############&quot;);
      return decimalFormat.format(((Number) input).doubleValue());

    }

    return input.toString();
  }

  /**
   * Convert a timestamp into a string: yyyy/MM/dd HH:mm:ss.SSS
   * @param timestamp
   * @return the string representation
   */
  public synchronized static String timestampToString(Date timestamp) {
    if (timestamp == null) {
      return null;
    }
    return timestampFormat.format(timestamp);
  }

  /**
   * Convert a timestamp into a string: yyyy/MM/dd HH:mm:ss.SSS
   * @param timestamp
   * @return the string representation
   */
  public synchronized static String timestampToFileString(Date timestamp) {
    if (timestamp == null) {
      return null;
    }
    return timestampFileFormat.format(timestamp);
  }

  /**
   * get the timestamp format for this thread
   * if you call this make sure to synchronize on FastDateUtils.class
   * @return the timestamp format
   */
  synchronized static SimpleDateFormat dateFormat() {
    return dateFormat;
  }

  /**
   * get the timestamp format for this thread
   * if you call this make sure to synchronize on FastDateUtils.class
   * @return the timestamp format
   */
  synchronized static SimpleDateFormat dateFormat2() {
    return dateFormat2;
  }

  /**
   * convert a date to the standard string yyyymmdd
   * @param date
   * @return the string value
   */
  public static String stringValue(java.util.Date date) {
    synchronized (GrouperUtil.class) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\member\SearchStringEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/member/SearchStringEnum.html#L189">189</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\member\SortStringEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/member/SortStringEnum.html#L189">189</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      return SearchStringEnum.hasAccess(wheelOnly, allowOnlyGroupName);
    }
    
    /**
     * @see edu.internet2.middleware.grouper.member.SearchStringEnum#getIndex()
     */
    @Override
    public int getIndex() {
      return 4;
    }
  };
  
  /**
   * @return the field name for a particular search string
   */
  public abstract String getFieldName();
  
  /**
   * @return true if the user has access to a particular search string
   */
  public abstract boolean hasAccess();
  
  /**
   * @return the index
   */
  public abstract int getIndex();
  
  /**
   * @param wheelOnly
   * @param allowOnlyGroupName
   * @return boolean
   */
  private static boolean hasAccess(boolean wheelOnly, String allowOnlyGroupName) {
    GrouperSession session = GrouperSession.staticGrouperSession();
    Subject subject = session.getSubject();
    
    if (PrivilegeHelper.isWheelOrRoot(subject)) {
      return true;
    }
    
    if (wheelOnly) {
      return false;
    }
    
    if (GrouperUtil.isEmpty(allowOnlyGroupName)) {
      return true;
    }
    
    Group allowOnlyGroup = GrouperDAOFactory.getFactory().getGroup().findByName(allowOnlyGroupName, true, null);
    return allowOnlyGroup.hasMember(subject);
  }
  
  /**
   * @return get the default search string based on what this subject has access to or null if the subject doesn't have access to any.
   */
  public static SearchStringEnum getDefaultSearchString() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2055">2055</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2206">2206</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2336">2336</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2606">2606</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2735">2735</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      .setCacheRegion(KLASS + &quot;.FindGroupAttributeDefNames&quot;);
  
    int maxAssignments = GrouperConfig.retrieveConfig().propertyValueInt(&quot;ws.findAttrAssignments.maxResultSize&quot;, 30000);
    
    //if -1, lets not check
    long size = -1;
    
    if (maxAssignments &gt;= 0) {
  
      size = byHqlStatic.createQuery(countPrefix + sql.toString()).uniqueResult(long.class);    
      
      //see if too many
      if (size &gt; maxAssignments) {
        throw new RuntimeException(&quot;Too many results: &quot; + size);
      }
      
    }
    
    Set&lt;AttributeDefName&gt; results = size == 0 ? new LinkedHashSet&lt;AttributeDefName&gt;() 
        : byHqlStatic.createQuery(selectPrefix + sql.toString()).listSet(AttributeDefName.class);
  
    //nothing to filter
    if (GrouperUtil.length(results) == 0) {
      return results;
    }
    
    //if the hql didnt filter, we need to do that here
    results = filterAttributeDefNames(grouperSession, results);
    
    //we should be down to the secure list
    return results;
      
  }

  /**
   * 
   * @param grouperSession
   * @param attibuteDefNames
   * @return the names which are ok to view
   */
  public Set&lt;AttributeDefName&gt; filterAttributeDefNames(GrouperSession grouperSession, Set&lt;AttributeDefName&gt; attibuteDefNames) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3RegistryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3RegistryDAO.html#L208">208</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3RegistryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3RegistryDAO.html#L245">245</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public void addForeignKeys(Writer writer) throws GrouperDAOException {

    try {
      String driverClass = GrouperHibernateConfig.retrieveConfig().propertyValueString(&quot;hibernate.connection.driver_class&quot;);
      String connectionUrl = GrouperHibernateConfig.retrieveConfig().propertyValueString(&quot;hibernate.connection.url&quot;);
      
      driverClass = GrouperDdlUtils.convertUrlToDriverClassIfNeeded(connectionUrl, driverClass);
      
      Platform platform = PlatformFactory.createNewPlatformInstance(driverClass, connectionUrl);
      platform.setUsername(GrouperHibernateConfig.retrieveConfig().propertyValueString(&quot;hibernate.connection.username&quot;));
      platform.setPassword(GrouperHibernateConfig.retrieveConfig().propertyValueString(&quot;hibernate.connection.password&quot;));

      if (Hib3DAO.class.getResource(&quot;Hib3ForeignKeys.xml&quot;) == null) {
        throw new RuntimeException(&quot;Cannot find resource Hib3ForeignKeys.xml.&quot;);
      }
      Database model = new DatabaseIO().read(Hib3DAO.class.getResource(&quot;Hib3ForeignKeys.xml&quot;).toString());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L387">387</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L320">320</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbNamingAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbNamingAdapter.html#L331">331</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }
  }


  /**
   * Copies privileges of type priv on any subject for the given Subject subj1 to the given Subject subj2.
   * For instance, if subj1 has ADMIN privilege to Group x, this method will result with subj2
   * having ADMIN privilege to Group x.
   * @param s 
   * @param subj1
   * @param subj2
   * @param priv 
   * @throws InsufficientPrivilegeException 
   * @throws GrantPrivilegeException 
   * @throws SchemaException 
   */
  public void privilegeCopy(GrouperSession s, Subject subj1, Subject subj2, Privilege priv)
      throws InsufficientPrivilegeException, GrantPrivilegeException, SchemaException {
    GrouperSession.validate(s);
    
    Field f = priv.getField();

    Set&lt;Membership&gt; memberships = GrouperDAOFactory.getFactory().getMembership()
        .findAllImmediateByMemberAndField(MemberFinder.findBySubject(s, subj1, true).getUuid(), f, false);
    
    if (memberships.size() == 0) {
      return;
    }
        
    Member member = MemberFinder.findBySubject(s, subj2, true);
  
    Iterator&lt;Membership&gt; membershipsIter = memberships.iterator();
    while (membershipsIter.hasNext()) {
      Membership existingMembership = membershipsIter.next();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeAssignAction.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeAssignAction.html#L128">128</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeAssignActionSet.html#L170">170</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeAssignValue.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeAssignValue.html#L170">170</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeDefNameSet.html#L170">170</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeDefScope.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeDefScope.html#L168">168</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportRoleSet.html#L170">170</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public XmlExportAttributeAssignAction() {
    
  }

  /**
   * uuid
   * @return uuid
   */
  public String getUuid() {
    return this.uuid;
  }

  /**
   * uuid
   * @param uuid1
   */
  public void setUuid(String uuid1) {
    this.uuid = uuid1;
  }

  /**
   * createTime
   * @return createTime
   */
  public String getCreateTime() {
    return this.createTime;
  }

  /**
   * createTime
   * @param createTime1
   */
  public void setCreateTime(String createTime1) {
    this.createTime = createTime1;
  }

  /**
   * modifierTime
   * @return modifierTime
   */
  public String getModifierTime() {
    return this.modifierTime;
  }

  /**
   * modifierTime
   * @param modifierTime1
   */
  public void setModifierTime(String modifierTime1) {
    this.modifierTime = modifierTime1;
  }

  /**
   * hibernateVersionNumber
   * @return hibernateVersionNumber
   */
  public long getHibernateVersionNumber() {
    return this.hibernateVersionNumber;
  }

  /**
   * hibernateVersionNumber
   * @param hibernateVersionNumber1
   */
  public void setHibernateVersionNumber(long hibernateVersionNumber1) {
    this.hibernateVersionNumber = hibernateVersionNumber1;
  }

  /**
   * contextId
   * @return contextId
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * contextId
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }
  
  /**
   * convert to AttributeAssignAction
   * @return the AttributeAssignAction
   */
  public AttributeAssignAction toAttributeAssignAction() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportComposite.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportComposite.html#L166">166</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportMembership.html#L280">280</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public XmlExportComposite() {
    
  }

  /**
   * uuid
   * @return uuid
   */
  public String getUuid() {
    return this.uuid;
  }

  /**
   * uuid
   * @param uuid1
   */
  public void setUuid(String uuid1) {
    this.uuid = uuid1;
  }

  /**
   * creatorId
   * @return creatorId
   */
  public String getCreatorId() {
    return this.creatorId;
  }

  /**
   * creatorId
   * @param creatorId1
   */
  public void setCreatorId(String creatorId1) {
    this.creatorId = creatorId1;
  }

  /**
   * createTime
   * @return createTime
   */
  public String getCreateTime() {
    return this.createTime;
  }

  /**
   * createTime
   * @param createTime1
   */
  public void setCreateTime(String createTime1) {
    this.createTime = createTime1;
  }

  /**
   * hibernateVersionNumber
   * @return hibernateVersionNumber
   */
  public long getHibernateVersionNumber() {
    return this.hibernateVersionNumber;
  }

  /**
   * hibernateVersionNumber
   * @param hibernateVersionNumber1
   */
  public void setHibernateVersionNumber(long hibernateVersionNumber1) {
    this.hibernateVersionNumber = hibernateVersionNumber1;
  }

  /**
   * contextId
   * @return contextId
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * contextId
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }
  
  /**
   * convert to composite
   * @return the composite
   */
  public Composite toComposite() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Group.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Group.html#L5892">5892</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Stem.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Stem.html#L1092">1092</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }
  
  
  /**
   * Returns the alternate name for the group.  Used by hibernate.
   * @return the alternate name
   */
  public String getAlternateNameDb() {
    return this.alternateNameDb;
  }

  /**
   * Returns the alternate name for the group.  If multiple, this returns the first one
   * @return the alternate name
   */
  public String getAlternateName() {
    return this.alternateNameDb;
  }

  /**
   * Set the group's alternate name  Used by hibernate.
   * @param alternateName
   */
  public void setAlternateNameDb(String alternateName) {
    this.alternateNameDb = alternateName;
    this.alternateNames = null;
  }
  
  /** alternate names */
  private Set&lt;String&gt; alternateNames = null;
  
  /**
   * Returns the alternate names for the group.  Only one alternate name is supported
   * currently, so a Set of size 0 or 1 will be returned.
   * @return Set of alternate names.
   */
  public Set&lt;String&gt; getAlternateNames() {
    
    //lazy load this set
    if (this.alternateNames == null) {
      this.alternateNames = new LinkedHashSet&lt;String&gt;();
      if (!StringUtils.isBlank(this.alternateNameDb)) {
        this.alternateNames.add(this.alternateNameDb);
      }
      this.alternateNames = Collections.unmodifiableSet(this.alternateNames);
    }
    return this.alternateNames;
  }

  /**
   * Add an alternate name for this group.  Only one alternate name is supported
   * currently, so this will replace any existing alternate name.
   * This won't get saved until you call store().
   * @param alternateName
   */
  public void addAlternateName(String alternateName) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L589">589</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L505">505</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            + &quot; does not have admin on group: &quot; + group.getName());
      }
      
      Set&lt;Field&gt; fields = null;
      if (GrouperUtil.length(privileges) &gt; 0) {
        fields = new LinkedHashSet&lt;Field&gt;();
        for (Privilege privilege : privileges) {
          fields.add(privilege.getField());
        }
      }
      
      Set&lt;Object[]&gt; memberships = null;
      
      QuerySort querySort = new QuerySort(&quot;m.subjectIdDb&quot;, true);
      querySort.insertSortToBeginning(&quot;m.subjectSourceIdDb&quot;, true);
      QueryOptions queryOptions = new QueryOptions();
      queryOptions.sort(querySort);
  
      //see if there is paging
      if (queryPaging != null) {
        
        queryOptions.paging(queryPaging);
        //dont cache, changing the effective etc messes it up
        queryPaging.setCacheTotalCount(false);
        
        //lets get the members
        List&lt;Member&gt; members = GrouperDAOFactory.getFactory().getMembership().findAllMembersByGroupOwnerOptions(</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L930">930</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2000">2000</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    queryByValueAddTablesWhereClause(byHqlStatic, sqlTables, sqlWhereClause, attributeDefValueType, theValue);
    
    GrouperSession grouperSession = GrouperSession.staticGrouperSession();
    
    Subject grouperSessionSubject = grouperSession.getSubject();
    
    grouperSession.getAttributeDefResolver().hqlFilterAttrDefsWhereClause(
      grouperSessionSubject, byHqlStatic, 
      sqlTables, sqlWhereClause, &quot;adn.attributeDefId&quot;, AttributeDefPrivilege.ATTR_READ_PRIVILEGES);
    
    boolean changedQuery = grouperSession.getAccessResolver().hqlFilterGroupsWhereClause(
        grouperSessionSubject, byHqlStatic, 
        sqlTables, &quot;aa.ownerGroupId&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);

    StringBuilder sql;
    
    if (changedQuery) {
      sqlTables.append(&quot; and &quot;);
    } else {
      sqlTables.append(&quot; where &quot;);
    }
    
    sql = sqlTables.append(sqlWhereClause);
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }

    if (attributeDefType != null) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1683">1683</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2646">2646</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      AttributeDefValueType attributeDefValueType, Object theValue) {
    int attributeAssignIdsSize = GrouperUtil.length(attributeAssignIds);
    int groupIdsAndMemberIdsSize = GrouperUtil.length(groupIdsAndMemberIds);
    int actionsSize = GrouperUtil.length(actions);
    int attributeDefIdsSize = GrouperUtil.length(attributeDefIds);
    int attributeDefNameIdsSize = GrouperUtil.length(attributeDefNameIds);

    if (attributeAssignIdsSize == 0 &amp;&amp; groupIdsAndMemberIdsSize == 0 &amp;&amp; attributeDefIdsSize == 0 &amp;&amp; attributeDefNameIdsSize == 0) {
      throw new RuntimeException(&quot;Illegal query, you need to pass in attributeAssignIds and/or attributeDefId(s) and/or membershipId(s) [groupIds/Names subjectIds/Identifiers] and/or attributeDefNameIds&quot;);
    }
    
    //too many bind vars
    //note, each groupIdsAndMemberIds is a multikey with a groupId and memberId
    if (attributeAssignIdsSize + (groupIdsAndMemberIdsSize*2) + attributeDefIdsSize + attributeDefNameIdsSize + actionsSize &gt; 100) {
      throw new RuntimeException(&quot;Too many attributeAssignIdsSize &quot; + attributeAssignIdsSize 
          + &quot; groupIdsAndMemberIdsSize &quot; + groupIdsAndMemberIdsSize + &quot; or attributeDefIdsSize &quot; 
          + attributeDefIdsSize + &quot; or attributeDefNameIds &quot; + attributeDefNameIdsSize + &quot; or actionsSize &quot; + actionsSize );
    }
  
    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic();
  
    String selectPrefix = &quot;select distinct aa &quot;;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L525">525</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L413">413</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbNamingAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbNamingAdapter.html#L462">462</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      Membership.internal_delImmediateMembership(s, g, subj, f);
    } catch (MemberDeleteAlreadyDeletedException eMD) {
      throw new RevokePrivilegeAlreadyRevokedException( eMD.getMessage(), eMD );
    } catch (MemberDeleteException eMD) {
      throw new RevokePrivilegeException( eMD.getMessage(), eMD );
    }
  }


  /**
   * @see edu.internet2.middleware.grouper.privs.AccessAdapter#revokeAllPrivilegesForSubject(edu.internet2.middleware.grouper.GrouperSession, edu.internet2.middleware.subject.Subject)
   */
  public void revokeAllPrivilegesForSubject(GrouperSession grouperSession, Subject subject) {
    GrouperSession.validate(grouperSession);
    
    // right now this method only gets executed as the root subject.
    // so we're not doing any privilege checking just to save on performance.
    if (!SubjectHelper.eq(SubjectFinder.findRootSubject(), grouperSession.getSubject())) {
      throw new InsufficientPrivilegeException();
    }
    
    Member member = MemberFinder.findBySubject(grouperSession, subject, true);
    Set&lt;Membership&gt; memberships = GrouperDAOFactory.getFactory().getMembership()
        .findAllImmediateByMemberAndFieldType(member.getUuid(), FieldType.ACCESS.getType(), false);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L788">788</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L863">863</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>                String thisAttributeDefId = ruleDefinition.getAttributeAssignType().getOwnerAttributeDefId();
                
                Stem stem = null;
                if (!StringUtils.isBlank(ruleDefinition.getCheck().getCheckOwnerId())) {
                  stem = StemFinder.findByUuid(rootSession, ruleDefinition.getCheck().getCheckOwnerId(), false);
                } else if (!StringUtils.isBlank(ruleDefinition.getCheck().getCheckOwnerName())) {
                  stem = StemFinder.findByName(rootSession, ruleDefinition.getCheck().getCheckOwnerName(), false);
                }

                if (stem == null) {
                  throw new RuntimeException(&quot;Stem doesnt exist in rule! &quot; + ruleDefinition);
                }

                Stem.Scope stemScope = Stem.Scope.valueOfIgnoreCase(ruleDefinition.getCheck().getCheckStemScope(), true);
                
                //find the members which apply
                Set&lt;PermissionEntry&gt; permissionEntries = GrouperDAOFactory.getFactory().getPermissionEntry().findAllPermissionsNotInStem(thisAttributeDefId, stem,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L111">111</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L345">345</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  SQL_SIMPLE {
    
    /**
     * 
     * @see edu.internet2.middleware.grouper.app.loader.GrouperLoaderType#attributeRequired(java.lang.String)
     */
    @Override
    public boolean attributeRequired(String attributeName) {
      return StringUtils.equals(GrouperLoader.GROUPER_LOADER_DB_NAME, attributeName)
          || StringUtils.equals(GrouperLoader.GROUPER_LOADER_QUERY, attributeName)
          || StringUtils.equals(GrouperLoader.GROUPER_LOADER_SCHEDULE_TYPE, attributeName);
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.app.loader.GrouperLoaderType#attributeOptional(java.lang.String)
     */
    @Override
    public boolean attributeOptional(String attributeName) {
      return StringUtils.equals(GrouperLoader.GROUPER_LOADER_PRIORITY, attributeName)
          || StringUtils.equals(GrouperLoader.GROUPER_LOADER_INTERVAL_SECONDS, attributeName)
          || StringUtils.equals(GrouperLoader.GROUPER_LOADER_AND_GROUPS, attributeName)
          || StringUtils.equals(GrouperLoader.GROUPER_LOADER_QUARTZ_CRON, attributeName);
    }
    
    /**
     * sync up a group membership based on query and db
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    @Override
    public void runJob(LoaderJobBean loaderJobBean) {
      
      GrouperContext.createNewDefaultContext(GrouperEngineBuiltin.LOADER, false, true);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1409">1409</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1576">1576</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (attributeDefType != null) {
      sql.append(&quot; and adn.attributeDefId = ad.id and ad.attributeDefTypeDb = :theAttributeDefType &quot;);
      byHqlStatic.setString(&quot;theAttributeDefType&quot;, attributeDefType.name());
    }
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefAssignToIdsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\membership\MembershipPathGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/membership/MembershipPathGroup.html#L463">463</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\membership\MembershipPathGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/membership/MembershipPathGroup.html#L491">491</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\membership\MembershipPathGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/membership/MembershipPathGroup.html#L519">519</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    grouperSession = GrouperSession.start(sessionSubject2);

    System.out.println(&quot;####### member #######&quot;);
    membershipPathGroup = MembershipPathGroup.analyze(endGroup, memberMember, Group.getDefaultList());

    System.out.println(membershipPathGroup.toString());

    System.out.println(&quot;####### groupPriv #######&quot;);
    membershipPathGroup = MembershipPathGroup.analyzePrivileges(privGroup, memberMember);
    
    System.out.println(membershipPathGroup.toString());
    
    membershipPathGroup = MembershipPathGroup.analyzePrivileges(privStem, memberMember);
    
    System.out.println(&quot;####### stemPriv #######&quot;);
    System.out.println(membershipPathGroup.toString());
    
    membershipPathGroup = MembershipPathGroup.analyzePrivileges(privAttributeDef, memberMember);
    
    System.out.println(&quot;####### attributeDefPriv #######&quot;);
    System.out.println(membershipPathGroup.toString());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeAssign.html#L438">438</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeAssignAction.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeAssignAction.html#L130">130</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeAssignActionSet.html#L172">172</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeAssignValue.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeAssignValue.html#L172">172</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeDefNameSet.html#L172">172</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeDefScope.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeDefScope.html#L170">170</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportRoleSet.html#L172">172</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  


  /**
   * uuid
   * @return uuid
   */
  public String getUuid() {
    return this.uuid;
  }

  /**
   * uuid
   * @param uuid1
   */
  public void setUuid(String uuid1) {
    this.uuid = uuid1;
  }

  /**
   * createTime
   * @return createTime
   */
  public String getCreateTime() {
    return this.createTime;
  }

  /**
   * createTime
   * @param createTime1
   */
  public void setCreateTime(String createTime1) {
    this.createTime = createTime1;
  }

  /**
   * modifierTime
   * @return modifierTime
   */
  public String getModifierTime() {
    return this.modifierTime;
  }

  /**
   * modifierTime
   * @param modifierTime1
   */
  public void setModifierTime(String modifierTime1) {
    this.modifierTime = modifierTime1;
  }

  /**
   * hibernateVersionNumber
   * @return hibernateVersionNumber
   */
  public long getHibernateVersionNumber() {
    return this.hibernateVersionNumber;
  }

  /**
   * hibernateVersionNumber
   * @param hibernateVersionNumber1
   */
  public void setHibernateVersionNumber(long hibernateVersionNumber1) {
    this.hibernateVersionNumber = hibernateVersionNumber1;
  }

  /**
   * contextId
   * @return contextId
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * contextId
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }
  
  /**
   * convert to AttributeAssign
   * @return the AttributeAssign
   */
  public AttributeAssign toAttributeAssign() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1305">1305</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1825">1825</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>              membershipAddDaemonVetoThisStemHasMembership(ruleDefinition, ruleEngine);
              break;
            
            default:
              if (!StringUtils.isBlank(ruleDefinition.getRunDaemon()) &amp;&amp; ruleDefinition.isRunDaemonBoolean()) {
                throw new RuntimeException(&quot;This rule is explicitly set to run a daemon, but it is not implemented&quot;);
              }
          }
          
          break;
          
        default:
          if (!StringUtils.isBlank(ruleDefinition.getRunDaemon()) &amp;&amp; ruleDefinition.isRunDaemonBoolean()) {
            throw new RuntimeException(&quot;This rule is explicitly set to run a daemon, but it is not implemented&quot;);
          }
      }
      
      
    }

    
    /**
     * @see RuleCheckType#checkKey(RuleDefinition)
     */
    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      RuleCheck ruleCheck = ruleDefinition.getCheck();
      if (StringUtils.isBlank(ruleCheck.getCheckOwnerId()) &amp;&amp; StringUtils.isBlank(ruleCheck.getCheckOwnerName())) {
        //if this is assigned to a group
        if (!StringUtils.isBlank(ruleDefinition.getAttributeAssignType().getOwnerGroupId())) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L891">891</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1969">1969</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      AttributeDefType attributeDefType, AttributeDefValueType attributeDefValueType, Object theValue) {
      
    int attributeAssignIdsSize = GrouperUtil.length(attributeAssignIds);
    int groupIdsSize = GrouperUtil.length(groupIds);
    int actionsSize = GrouperUtil.length(actions);
    int attributeDefIdsSize = GrouperUtil.length(attributeDefIds);
    int attributeDefNameIdsSize = GrouperUtil.length(attributeDefNameIds);
    
    if (attributeAssignIdsSize == 0 &amp;&amp; groupIdsSize == 0 &amp;&amp; attributeDefIdsSize == 0 &amp;&amp; attributeDefNameIdsSize == 0) {
      throw new RuntimeException(&quot;Illegal query, you need to pass in attributeAssignIds and/or attributeDefId(s) and/or groupId(s) and/or groupNames and/or attributeDefNameIds&quot;);
    }
    
    //too many bind vars
    if (attributeAssignIdsSize + groupIdsSize + attributeDefIdsSize + attributeDefNameIdsSize + actionsSize &gt; 100) {
      throw new RuntimeException(&quot;Too many attributeAssignIdsSize &quot; + attributeAssignIdsSize 
          + &quot; groupIdsSize &quot; + groupIdsSize + &quot; or attributeDefIdsSize &quot; 
          + attributeDefIdsSize + &quot; or attributeDefNameIds &quot; + attributeDefNameIdsSize + &quot; or actionsSize &quot; + actionsSize );
    }

    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic();

    String selectPrefix = &quot;select distinct aa &quot;;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1199">1199</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2129">2129</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      AttributeDefValueType attributeDefValueType, Object theValue) {
      
    int attributeAssignIdsSize = GrouperUtil.length(attributeAssignIds);
    int memberIdsSize = GrouperUtil.length(memberIds);
    int actionsSize = GrouperUtil.length(actions);
    int attributeDefIdsSize = GrouperUtil.length(attributeDefIds);
    int attributeDefNameIdsSize = GrouperUtil.length(attributeDefNameIds);
    
    if (attributeAssignIdsSize == 0 &amp;&amp; memberIdsSize == 0 &amp;&amp; attributeDefIdsSize == 0 &amp;&amp; attributeDefNameIdsSize == 0) {
      throw new RuntimeException(&quot;Illegal query, you need to pass in attributeAssignIds and/or attributeDefId(s) and/or memberId(s) [subjectIds or subjectIdentifiers] and/or attributeDefNameIds&quot;);
    }
    
    //too many bind vars
    if (attributeAssignIdsSize + memberIdsSize + attributeDefIdsSize + attributeDefNameIdsSize + actionsSize &gt; 100) {
      throw new RuntimeException(&quot;Too many attributeAssignIdsSize &quot; + attributeAssignIdsSize 
          + &quot; memberIdsSize &quot; + memberIdsSize + &quot; or attributeDefIdsSize &quot; 
          + attributeDefIdsSize + &quot; or attributeDefNameIds &quot; + attributeDefNameIdsSize + &quot; or actionsSize &quot; + actionsSize );
    }
  
    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic();
  
    String selectPrefix = &quot;select distinct aa &quot;;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1355">1355</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2775">2775</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      Object theValue) {
      
    int attributeAssignIdsSize = GrouperUtil.length(attributeAssignIds);
    int attributeDefAssignToIdsSize = GrouperUtil.length(attributeDefAssignToIds);
    int actionsSize = GrouperUtil.length(actions);
    int attributeDefIdsSize = GrouperUtil.length(attributeDefIds);
    int attributeDefNameIdsSize = GrouperUtil.length(attributeDefNameIds);
    
    if (attributeAssignIdsSize == 0 &amp;&amp; attributeDefAssignToIdsSize == 0 &amp;&amp; attributeDefIdsSize == 0 &amp;&amp; attributeDefNameIdsSize == 0) {
      throw new RuntimeException(&quot;Illegal query, you need to pass in attributeAssignIds and/or attributeDefId(s) and/or attributeDefAssignToId(s) and/or attributeDefNameIds&quot;);
    }
    
    //too many bind vars
    if (attributeAssignIdsSize + attributeDefAssignToIdsSize + attributeDefIdsSize + attributeDefNameIdsSize + actionsSize &gt; 100) {
      throw new RuntimeException(&quot;Too many attributeAssignIdsSize &quot; + attributeAssignIdsSize 
          + &quot; attributeDefAssignToIdsSize &quot; + attributeDefAssignToIdsSize + &quot; or attributeDefIdsSize &quot; 
          + attributeDefIdsSize + &quot; or attributeDefNameIds &quot; + attributeDefNameIdsSize + &quot; or actionsSize &quot; + actionsSize );
    }

    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic();

    String selectPrefix = &quot;select distinct aa &quot;;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1507">1507</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2246">2246</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      Object theValue) {
    
    int attributeAssignIdsSize = GrouperUtil.length(attributeAssignIds);
    int membershipIdsSize = GrouperUtil.length(membershipIds);
    int actionsSize = GrouperUtil.length(actions);
    int attributeDefIdsSize = GrouperUtil.length(attributeDefIds);
    int attributeDefNameIdsSize = GrouperUtil.length(attributeDefNameIds);
    
    if (attributeAssignIdsSize == 0 &amp;&amp; membershipIdsSize == 0 &amp;&amp; attributeDefIdsSize == 0 &amp;&amp; attributeDefNameIdsSize == 0) {
      throw new RuntimeException(&quot;Illegal query, you need to pass in attributeAssignIds and/or attributeDefId(s) and/or membershipId(s) and/or attributeDefNameIds&quot;);
    }
    
    //too many bind vars
    if (attributeAssignIdsSize + membershipIdsSize + attributeDefIdsSize + attributeDefNameIdsSize + actionsSize &gt; 100) {
      throw new RuntimeException(&quot;Too many attributeAssignIdsSize &quot; + attributeAssignIdsSize 
          + &quot; membershipIdsSize &quot; + membershipIdsSize + &quot; or attributeDefIdsSize &quot; 
          + attributeDefIdsSize + &quot; or attributeDefNameIds &quot; + attributeDefNameIdsSize + &quot; or actionsSize &quot; + actionsSize );
    }
  
    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic();
  
    String selectPrefix = &quot;select distinct aa &quot;;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2520">2520</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3191">3191</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      Collection&lt;String&gt; stemIds, Collection&lt;String&gt; actions, Boolean enabled) {
      
    int attributeAssignIdsSize = GrouperUtil.length(attributeAssignIds);
    int stemIdsSize = GrouperUtil.length(stemIds);
    int actionsSize = GrouperUtil.length(actions);
    int attributeDefIdsSize = GrouperUtil.length(attributeDefIds);
    int attributeDefNameIdsSize = GrouperUtil.length(attributeDefNameIds);
    
    if (attributeAssignIdsSize == 0 &amp;&amp; stemIdsSize == 0 &amp;&amp; attributeDefIdsSize == 0 &amp;&amp; attributeDefNameIdsSize == 0) {
      throw new RuntimeException(&quot;Illegal query, you need to pass in attributeAssignIds and/or attributeDefId(s) and/or stemId(s) and/or stemName(s) and/or attributeDefNameIds&quot;);
    }
    
    //too many bind vars
    if (attributeAssignIdsSize + stemIdsSize + attributeDefIdsSize + attributeDefNameIdsSize + actionsSize &gt; 100) {
      throw new RuntimeException(&quot;Too many attributeAssignIdsSize &quot; + attributeAssignIdsSize 
          + &quot; stemIdsSize &quot; + stemIdsSize + &quot; or attributeDefIdsSize &quot; 
          + attributeDefIdsSize + &quot; or attributeDefNameIds &quot; + attributeDefNameIdsSize + &quot; or actionsSize &quot; + actionsSize );
    }
  
    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic();
  
    String selectPrefix = &quot;select distinct adn &quot;;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDef.html#L104">104</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITField.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITField.html#L93">93</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroup.html#L110">110</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITStem.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITStem.html#L94">94</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  private String sourceId;
  
  /**
   * @return source id
   */
  public String getSourceId() {
    return sourceId;
  }

  /**
   * set source id
   * @param sourceId
   */
  public void setSourceId(String sourceId) {
    this.sourceId = sourceId;
  }
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#clone()
   */
  @Override
  public GrouperAPI clone() {
    return GrouperUtil.clone(this, CLONE_FIELDS);
  }

  /**
   * @return context id
   */
  public String getContextId() {
    return contextId;
  }

  /**
   * set context id
   * @param contextId
   */
  public void setContextId(String contextId) {
    this.contextId = contextId;
  }

  /**
   * @return id
   */
  public String getId() {
    return id;
  }

  /**
   * set id
   * @param id
   */
  public void setId(String id) {
    this.id = id;
  }

  /**
   * @return name
   */
  public String getName() {
    return name;
  }
  
  /**
   * @return name
   */
  public String getNameDb() {
    return name;
  }

  /**
   * Set name
   * @param name
   */
  public void setNameDb(String name) {
    this.name = name;
  }
  
  /**
   * @return stem id
   */
  public String getStemId() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\ldap\LdapSession.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/ldap/LdapSession.html#L271">271</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\ldap\LdapSession.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/ldap/LdapSession.html#L361">361</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      return (List&lt;R&gt;)callbackLdapSession(ldapServerId, new LdapHandler() {
        
        public Object callback(LdapHandlerBean ldapHandlerBean) throws NamingException {

          Ldap ldap = ldapHandlerBean.getLdap();
          
          Iterator&lt;SearchResult&gt; searchResultIterator = null;
          
          SearchFilter searchFilterObject = new SearchFilter(filter);
          String[] attributeArray = new String[]{attributeName};
          
          SearchControls searchControls = ldap.getLdapConfig().getSearchControls(attributeArray);
          
          if (ldapSearchScope != null) {
            searchControls.setSearchScope(ldapSearchScope.getSeachControlsConstant());
          }
          
          if (StringUtils.isBlank(searchDn)) {
            searchResultIterator = ldap.search(
                searchFilterObject, searchControls);
          } else {
            searchResultIterator = ldap.search(searchDn,
                searchFilterObject, searchControls);
          }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefNameSet.html#L124">124</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITRoleSet.html#L125">125</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  private String sourceId;
  
  /**
   * @return source id
   */
  public String getSourceId() {
    return sourceId;
  }

  /**
   * set source id
   * @param sourceId
   */
  public void setSourceId(String sourceId) {
    this.sourceId = sourceId;
  }
  
  /**
   * depth - 0 for self records, 1 for immediate memberships, &gt; 1 for effective 
   */
  private int depth;
  
  /** whether there will be notifications for roles with permission changes when this object is saved or updated */ 
  private boolean notificationsForRolesWithPermissionChangesOnSaveOrUpdate = false;
  
  /**
   * @return boolean
   */
  public boolean getNotificationsForRolesWithPermissionChangesOnSaveOrUpdate() {
    return notificationsForRolesWithPermissionChangesOnSaveOrUpdate;
  }
  
  /**
   * @param notificationsForRolesWithPermissionChangesOnSaveOrUpdate
   */
  public void setNotificationsForRolesWithPermissionChangesOnSaveOrUpdate(boolean notificationsForRolesWithPermissionChangesOnSaveOrUpdate) {
    this.notificationsForRolesWithPermissionChangesOnSaveOrUpdate = notificationsForRolesWithPermissionChangesOnSaveOrUpdate;
  }
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#clone()
   */
  @Override
  public GrouperAPI clone() {
    return GrouperUtil.clone(this, CLONE_FIELDS);
  }

  /**
   * @return context id
   */
  public String getContextId() {
    return contextId;
  }

  /**
   * set context id
   * @param contextId
   */
  public void setContextId(String contextId) {
    this.contextId = contextId;
  }

  /**
   * @return id
   */
  public String getId() {
    return id;
  }

  /**
   * set id
   * @param id
   */
  public void setId(String id) {
    this.id = id;
  }

  /**
   * @return parentAttrDefNameSetId
   */
  public String getParentAttrDefNameSetId() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L1462">1462</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L1499">1499</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public static String jsonConvertTo(Object object, boolean includeObjectNameWrapper) {

    if (object == null) {
      throw new NullPointerException();
    }
//    Gson gson = new GsonBuilder().create();
//    String json = gson.toJson(object);

//    JSONObject jsonObject = net.sf.json.JSONObject.fromObject( object );
//    String json = jsonObject.toString();

    JsonConfig jsonConfig = new JsonConfig();
    jsonConfig.setJsonPropertyFilter( new PropertyFilter(){
       public boolean apply( Object source, String name, Object value ) {
         //json-lib cannot handle maps where the key is not a string
         if( value != null &amp;&amp; value instanceof Map ){
           Map map = (Map)value;
           if (map.size() &gt; 0 &amp;&amp; !(map.keySet().iterator().next() instanceof String)) {
             return true;
           }
         }
         return value == null;
       }
    });
    JSONObject jsonObject = JSONObject.fromObject( object, jsonConfig );
    String json = jsonObject.toString();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssignActionSet.html#L441">441</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\permissions\role\RoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/permissions/role/RoleSet.html#L440">440</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\stem\StemSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/stem/StemSet.html#L362">362</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    this.type = AttributeAssignActionType.valueOfIgnoreCase(type1, false);
  }

  /**
   * @return depth
   */
  public int getDepth() {
    return depth;
  }

  /**
   * set depth
   * @param depth
   */
  public void setDepth(int depth) {
    this.depth = depth;
  }

  /**
   * context id of the transaction
   * @return context id
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * save or update this object
   */
  public void saveOrUpdate() {
    GrouperDAOFactory.getFactory().getAttributeAssignActionSet().saveOrUpdate(this);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleThen.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleThen.html#L246">246</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleThenEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleThenEnum.html#L1014">1014</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      Map&lt;String, Object&gt; variableMap =  new HashMap&lt;String, Object&gt;();

      
      Subject actAsSubject = ruleDefinition.getActAs().subject(true);
      boolean hasAccessToEl = RuleEngine.hasAccessToElApi(actAsSubject);

      ruleDefinition.addElVariables(variableMap, rulesBean, hasAccessToEl);
      
      if (logDataForThisDefinition != null) {
        logDataForThisDefinition.append(&quot;, EL variables: &quot;);
        for (String varName : variableMap.keySet()) {
          logDataForThisDefinition.append(varName);
          Object value = variableMap.get(varName);
          if (value instanceof String) {
            logDataForThisDefinition.append(&quot;(&quot;).append(value).append(&quot;)&quot;);
          }
          logDataForThisDefinition.append(&quot;,&quot;);
        }
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L9282">9282</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L6078">6078</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * &lt;p&gt;Introspects the &lt;code&gt;Throwable&lt;/code&gt; to obtain the cause.&lt;/p&gt;
   *
   * &lt;ol&gt;
   * &lt;li&gt;Try known exception types.&lt;/li&gt;
   * &lt;li&gt;Try the supplied array of method names.&lt;/li&gt;
   * &lt;li&gt;Try the field 'detail'.&lt;/li&gt;
   * &lt;/ol&gt;
   *
   * &lt;p&gt;A &lt;code&gt;null&lt;/code&gt; set of method names means use the default set.
   * A &lt;code&gt;null&lt;/code&gt; in the set of method names will be ignored.&lt;/p&gt;
   *
   * @param throwable  the throwable to introspect for a cause, may be null
   * @param methodNames  the method names, null treated as default set
   * @return the cause of the &lt;code&gt;Throwable&lt;/code&gt;,
   *  &lt;code&gt;null&lt;/code&gt; if none found or null throwable input
   * @since 1.0
   */
  public static Throwable getCause(Throwable throwable, String[] methodNames) {
      if (throwable == null) {
          return null;
      }
      Throwable cause = getCauseUsingWellKnownTypes(throwable);
      if (cause == null) {
          if (methodNames == null) {
              methodNames = CAUSE_METHOD_NAMES;
          }
          for (int i = 0; i &lt; methodNames.length; i++) {
              String methodName = methodNames[i];
              if (methodName != null) {
                  cause = getCauseUsingMethodName(throwable, methodName);
                  if (cause != null) {
                      break;
                  }
              }
          }

          if (cause == null) {
              cause = getCauseUsingFieldName(throwable, &quot;detail&quot;);
          }
      }
      return cause;
  }

  /**
   * &lt;p&gt;Finds a &lt;code&gt;Throwable&lt;/code&gt; by method name.&lt;/p&gt;
   *
   * @param throwable  the exception to examine
   * @param methodName  the name of the method to find and invoke
   * @return the wrapped exception, or &lt;code&gt;null&lt;/code&gt; if not found
   */
  private static Throwable getCauseUsingMethodName(Throwable throwable, String methodName) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\BySqlStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/BySqlStatic.html#L167">167</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\BySqlStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/BySqlStatic.html#L250">250</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          boolean isInt = int.class.equals(returnClassType);
          boolean isPrimitive = isInt;
          if (isInt || Integer.class.equals(returnClassType)) {
            BigDecimal bigDecimal = resultSet.getBigDecimal(1);
            if (bigDecimal != null) {
              result = (T)(Object)bigDecimal.intValue();
            }
          } else if (String.class.equals(returnClassType)) {
            result = (T)resultSet.getString(1);
          } else {
            throw new RuntimeException(&quot;Unexpected type: &quot; + returnClassType);
          }
          
          if (result == null &amp;&amp; isPrimitive) {
            throw new NullPointerException(&quot;expecting primitive (&quot; + returnClassType.getSimpleName() 
                + &quot;), but received null&quot;);
          }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L276">276</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L929">929</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        RuleUtils.ruleCheckTypeName(), RuleCheckType.membershipAdd.name());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleIfConditionEnumName(), RuleIfConditionEnum.groupHasNoImmediateEnabledMembership.name());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleIfOwnerIdName(), mustBeInGroup.getId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleThenEnumName(), RuleThenEnum.veto.name());
    
    //key which would be used in UI messages file if applicable
    attributeValueDelegate.assignValue(
        RuleUtils.ruleThenEnumArg0Name(), vetoKey);
    
    //error message (if key in UI messages file not there)
    attributeValueDelegate.assignValue(
        RuleUtils.ruleThenEnumArg1Name(), vetoMessage);

    //should be valid
    String isValidString = attributeValueDelegate.retrieveValueString(
        RuleUtils.ruleValidName());

    if (!StringUtils.equals(&quot;T&quot;, isValidString)) {
      throw new RuntimeException(isValidString);
    }
    
    return attributeAssign;

  }

  /**
   * make sure stem privileges are inherited in a attributeDef
   * @param actAs
   * @param stem
   * @param stemScope ONE or SUB
   * @param subjectToAssign
   * @param privileges can use Privilege.getInstances() to convert from string
   * @return the assignment in case there are edits
   */
  public static AttributeAssign inheritAttributeDefPrivileges(Subject actAs, Stem stem, Scope stemScope, </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\ddl\GrouperDdl.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/ddl/GrouperDdl.html#L8823">8823</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\ddl\GrouperDdl.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/ddl/GrouperDdl.html#L8940">8940</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\ddl\GrouperDdl.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/ddl/GrouperDdl.html#L9053">9053</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        &quot;grouper_perms_role_v: shows all permissions assigned to users due to the users being in a role, and the role being assigned the permission&quot;,
        GrouperUtil.toSet(&quot;role_name&quot;, 
            &quot;subject_source_id&quot;, 
            &quot;subject_id&quot;,
            &quot;action&quot;, 
            &quot;attribute_def_name_name&quot;,
            &quot;attribute_def_name_disp_name&quot;,
            &quot;role_display_name&quot;,
            &quot;attribute_assign_delegatable&quot;,
            &quot;enabled&quot;,
            &quot;enabled_time&quot;,
            &quot;disabled_time&quot;,
            &quot;role_id&quot;,
            &quot;attribute_def_id&quot;,
            &quot;member_id&quot;, 
            &quot;attribute_def_name_id&quot;,
            &quot;action_id&quot;,
            &quot;membership_depth&quot;,
            &quot;role_set_depth&quot;,
            &quot;attr_def_name_set_depth&quot;,
            &quot;attr_assign_action_set_depth&quot;,
            &quot;membership_id&quot;,
            &quot;attribute_assign_id&quot;,
            &quot;permission_type&quot;,
            &quot;assignment_notes&quot;,
            &quot;immediate_mship_enabled_time&quot;,
            &quot;immediate_mship_disabled_time&quot;,
            &quot;disallowed&quot;
            ),
        GrouperUtil.toSet(&quot;role_name: name of the role that the user is in and that has the permission&quot;,
            &quot;subject_source_id: source id of the subject which is in the role and thus has the permission&quot;,
            &quot;subject_id: subject id of the subject which is in the role and thus has the permission&quot;,
            &quot;action: the action associated with the attribute assignment (default is assign)&quot;,
            &quot;attribute_def_name_name: name of the attribute definition name which is assigned to the group&quot;,
            &quot;attribute_def_name_disp_name: display name of the attribute definition name assigned to the attribute&quot;,
            &quot;role_display_name: display name of role the subject is in, and that the permissions are assigned to&quot;,
            &quot;attribute_assign_delegatable: if this assignment is delegatable or grantable: TRUE, FALSE, GRANT&quot;,
            &quot;enabled: if this assignment is enabled: T, F&quot;,
            &quot;enabled_time: the time (seconds since 1970) that this assignment will be enabled&quot;,
            &quot;disabled_time: the time (seconds since 1970) that this assignment will be disabled&quot;,
            &quot;role_id: id of role the subject is in, and that the permissions are assigned to&quot;,
            &quot;attribute_def_id: id of the attribute definition&quot;,
            &quot;member_id: id of the subject in the members table&quot;,
            &quot;attribute_def_name_id: id of the attribute definition name&quot;,
            &quot;action_id: id of the attribute assign action&quot;,
            &quot;membership_depth: depth of membership, 0 is immediate&quot;,
            &quot;role_set_depth: depth of role hierarchy, 0 is immediate&quot;,
            &quot;attr_def_name_set_depth: depth of attribute def name set hierarchy, 0 is immediate&quot;,
            &quot;attr_assign_action_set_depth: depth of action hierarchy, 0 is immediate&quot;,
            &quot;membership_id: id of the underlying membership&quot;,
            &quot;attribute_assign_id: id of the underlying attribute assign&quot;,
            &quot;permission_type: role or role_subject for assignment to role or to role subject pair&quot;,
            &quot;assignment_notes: notes on this assignment&quot;,
            &quot;immediate_mship_enabled_time: time this membership was enabled&quot;,
            &quot;immediate_mship_disabled_time: time this membership will be disabled&quot;,
            &quot;disallowed: if permission is disallowed from a wider allow, null means false&quot;
        ),</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L136">136</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L294">294</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L401">401</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L568">568</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public void update(final Collection&lt;?&gt; collection) throws GrouperDAOException {
    if (collection == null) {
      return;
    }
    try {
      GrouperTransactionType grouperTransactionTypeToUse = 
        (GrouperTransactionType)ObjectUtils.defaultIfNull(this.grouperTransactionType, 
            GrouperTransactionType.READ_WRITE_OR_USE_EXISTING);
      
      HibernateSession.callbackHibernateSession(
          grouperTransactionTypeToUse, AuditControl.WILL_NOT_AUDIT,
          new HibernateHandler() {
  
            public Object callback(HibernateHandlerBean hibernateHandlerBean)
                throws GrouperDAOException {
              HibernateSession hibernateSession = hibernateHandlerBean.getHibernateSession();
              
              GrouperUtil.assertion(ByObjectStatic.this.cacheable == null, &quot;Cant set cacheable here&quot;);
              GrouperUtil.assertion(ByObjectStatic.this.cacheRegion == null, &quot;Cant set cacheRegion here&quot;);
              
              ByObject byObject = hibernateSession.byObject();
              ByObjectStatic.this.copyFieldsTo(byObject);
              byObject.update(collection);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L1880">1880</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L3262">3262</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>            hib3GrouploaderLog.setGroupUuid(groupUuid);
            hib3GrouploaderLog.setHost(GrouperUtil.hostname());
            hib3GrouploaderLog.setJobMessage(errorMessage);
            hib3GrouploaderLog.setJobName(jobName);
            hib3GrouploaderLog.setAndGroupNames(grouperLoaderAndGroups);
            hib3GrouploaderLog.setJobScheduleIntervalSeconds(grouperLoaderIntervalSeconds);
            hib3GrouploaderLog.setJobSchedulePriority(grouperLoaderPriority);
            hib3GrouploaderLog.setJobScheduleQuartzCron(grouperLoaderQuartzCron);
            hib3GrouploaderLog.setJobScheduleType(grouperLoaderScheduleType);
            hib3GrouploaderLog.setJobType(grouperLoaderType);
            hib3GrouploaderLog.setStatus(GrouperLoaderStatus.CONFIG_ERROR.name());
            hib3GrouploaderLog.store();
            
          } catch (Exception e2) {
            LOG.error(&quot;Problem logging to loader db log&quot;, e2);
          }
        }
        
        
      }
    } catch (Exception e) {
      throw new RuntimeException(e);
    } finally {
      GrouperSession.stopQuietly(grouperSession);
    }
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByHql.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByHql.html#L513">513</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByHqlStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByHqlStatic.html#L230">230</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  public ByHql setScalar(String bindVarName, Object value) {
    
    if (value instanceof Integer) {
      this.setInteger(bindVarName, (Integer)value);
    } else if (value instanceof String) {
      this.setString(bindVarName, (String)value);
    } else if (value instanceof Long) {
      this.setLong(bindVarName, (Long)value);
    } else if (value instanceof Date) {
      this.setTimestamp(bindVarName, (Date)value);
    } else {
      throw new RuntimeException(&quot;Unexpected value: &quot; + value + &quot;, &quot; + (value == null ? null : value.getClass()));
    }
    
    return this;
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L997">997</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1292">1292</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1613">1613</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1789">1789</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3297">3297</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3589">3589</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    long size = -1;
    
    if (maxAssignments &gt;= 0) {

      size = byHqlStatic.createQuery(countPrefix + sql.toString()).uniqueResult(long.class);    
      
      //see if too many
      if (size &gt; maxAssignments) {
        throw new RuntimeException(&quot;Too many results: &quot; + size);
      }
      
    }
    
    Set&lt;AttributeAssign&gt; results = size == 0 ? new LinkedHashSet&lt;AttributeAssign&gt;() 
        : byHqlStatic.createQuery(selectPrefix + sql.toString()).listSet(AttributeAssign.class);

    //nothing to filter
    if (GrouperUtil.length(results) == 0) {
      return results;
    }
    
    //if the hql didnt filter, we need to do that here
    results = grouperSession.getAttributeDefResolver().postHqlFilterAttributeAssigns(grouperSessionSubject, results);
    
    //if looking for assignments on assignments, do that now
    if (includeAssignmentsOnAssignments) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignAction.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignAction.html#L90">90</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefName.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefName.html#L99">99</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  private String name;
  
  /** sourceId */
  private String sourceId;
  
  /**
   * @return source id
   */
  public String getSourceId() {
    return sourceId;
  }

  /**
   * set source id
   * @param sourceId
   */
  public void setSourceId(String sourceId) {
    this.sourceId = sourceId;
  }
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#clone()
   */
  @Override
  public GrouperAPI clone() {
    return GrouperUtil.clone(this, CLONE_FIELDS);
  }

  /**
   * @return context id
   */
  public String getContextId() {
    return contextId;
  }

  /**
   * set context id
   * @param contextId
   */
  public void setContextId(String contextId) {
    this.contextId = contextId;
  }

  /**
   * @return id
   */
  public String getId() {
    return id;
  }

  /**
   * set id
   * @param id
   */
  public void setId(String id) {
    this.id = id;
  }
  
  /**
   * @return attributeDefId
   */
  public String getAttributeDefId() {
    return attributeDefId;
  }

  /**
   * @param attributeDefId
   */
  public void setAttributeDefId(String attributeDefId) {
    this.attributeDefId = attributeDefId;
  }

  /**
   * @return name
   */
  public String getName() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITGroupSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroupSet.html#L1158">1158</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L906">906</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }
  
  /**
   * @return pitOwnerGroup
   */
  public PITGroup getOwnerPITGroup() {
    if (pitOwnerGroup == null &amp;&amp; ownerGroupId != null) {
      pitOwnerGroup = GrouperDAOFactory.getFactory().getPITGroup().findById(ownerGroupId, true);
    }
    
    return pitOwnerGroup;
  }
  
  /**
   * @return pitOwnerAttributeDef
   */
  public PITAttributeDef getOwnerPITAttributeDef() {
    if (pitOwnerAttributeDef == null &amp;&amp; ownerAttrDefId != null) {
      pitOwnerAttributeDef = GrouperDAOFactory.getFactory().getPITAttributeDef().findById(ownerAttrDefId, true);
    }
    
    return pitOwnerAttributeDef;
  }
  
  /**
   * @return pitOwnerStem
   */
  public PITStem getOwnerPITStem() {
    if (pitOwnerStem == null &amp;&amp; ownerStemId != null) {
      pitOwnerStem = GrouperDAOFactory.getFactory().getPITStem().findById(ownerStemId, true);
    }
    
    return pitOwnerStem;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L978">978</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1030">1030</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1083">1083</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1131">1131</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        RuleCheckType.flattenedMembershipRemove.name());
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumName(), RuleThenEnum.sendEmail.name());
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg0Name(), emailToValue);
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg1Name(), emailSubjectValue);
    
    //the to, subject, or body could be text with EL variables, or could be a template.  If template, it is
    //read from the classpath from package: grouperRulesEmailTemplates/theTemplateName.txt
    //or you could configure grouper.properties to keep them in an external folder, not in the classpath
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg2Name(), emailBodyValue);
    
    //should be valid
    String isValidString = attributeAssign.getAttributeValueDelegate().retrieveValueString(
        RuleUtils.ruleValidName());

    if (!StringUtils.equals(&quot;T&quot;, isValidString)) {
      throw new RuntimeException(isValidString);
    }
    
    return attributeAssign;
 
  }
  
  /**
   * 
   * @param actAsSubject
   * @param ruleStem
   * @param stemScope
   * @param emailToValue
   * @param emailSubjectValue
   * @param emailBodyValue
   * @return the assignment in case there are edits
   */
  public static AttributeAssign emailOnFlattenedMembershipAddFromStem(Subject actAsSubject, Stem ruleStem,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\usdu\USDU.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/usdu/USDU.html#L84">84</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\AccessPrivilege.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/AccessPrivilege.html#L169">169</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  private static Map&lt;String, Privilege&gt; list2priv = new HashMap&lt;String, Privilege&gt;();
  static {
    list2priv.put(Field.FIELD_NAME_ADMINS, AccessPrivilege.ADMIN);
    list2priv.put(Field.FIELD_NAME_OPTINS, AccessPrivilege.OPTIN);
    list2priv.put(Field.FIELD_NAME_OPTOUTS, AccessPrivilege.OPTOUT);
    list2priv.put(Field.FIELD_NAME_READERS, AccessPrivilege.READ);
    list2priv.put(Field.FIELD_NAME_UPDATERS, AccessPrivilege.UPDATE);
    list2priv.put(Field.FIELD_NAME_VIEWERS, AccessPrivilege.VIEW);
    list2priv.put(Field.FIELD_NAME_GROUP_ATTR_READERS, AccessPrivilege.GROUP_ATTR_READ);
    list2priv.put(Field.FIELD_NAME_GROUP_ATTR_UPDATERS, AccessPrivilege.GROUP_ATTR_UPDATE);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssign.html#L2093">2093</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3StemDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3StemDAO.html#L386">386</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      for (Field field : fields) {
        if (group.getTypeOfGroup() != null &amp;&amp; group.getTypeOfGroup().supportsField(field)) {
          GroupSet groupSet = new GroupSet();
          groupSet.setId(GrouperUuid.getUuid());
          groupSet.setCreatorId(GrouperSession.staticGrouperSession().getMemberUuid());
          groupSet.setDepth(0);
          groupSet.setMemberGroupId(group.getUuid());
          groupSet.setOwnerGroupId(group.getUuid());
          groupSet.setParentId(groupSet.getId());
          groupSet.setFieldId(field.getUuid());
          GrouperDAOFactory.getFactory().getGroupSet().save(groupSet);
        }
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3169">3169</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3214">3214</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      StringBuilder sql = new StringBuilder(&quot;select ms, m from MembershipEntry as ms, Member as m, Field as f where  &quot;
          + &quot; ms.ownerGroupId   = :owner &quot;
          + &quot; and  ms.memberUuid  = m.uuid   &quot;
          + &quot; and  ms.fieldId  = f.uuid   &quot;
          + &quot; and  f.typeString  = 'access'   &quot;
          );
      
      ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic()
        .setCacheable(true)
        .setCacheRegion(KLASS)
        .setString(&quot;owner&quot;, groupId)
        .options(queryOptions);
  
      HibUtils.convertFieldsToSqlInString(fields, byHqlStatic, sql, &quot;ms.fieldId&quot;);
      HibUtils.convertSourcesToSqlInString(sources, byHqlStatic, sql, &quot;m.subjectSourceIdDb&quot;);
      
      if (membershipType != null) {
        sql.append(&quot;and  ms.type &quot;).append(membershipType.queryClause());
      }
      
      if (enabled != null) {
        sql.append(&quot; and ms.enabledDb = '&quot; + (enabled ? 'T' : 'F') + &quot;'&quot;);
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\membership\MembershipPathGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/membership/MembershipPathGroup.html#L411">411</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\membership\MembershipPathGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/membership/MembershipPathGroup.html#L437">437</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    System.out.println(&quot;########################## Non composite\n&quot;);
    System.out.println(&quot;####### member #######&quot;);
    System.out.println(membershipPathGroup.toString());

    membershipPathGroup = MembershipPathGroup.analyzePrivileges(privGroup, memberMember);
    
    System.out.println(&quot;####### groupPriv #######&quot;);
    System.out.println(membershipPathGroup.toString());
    
    membershipPathGroup = MembershipPathGroup.analyzePrivileges(privStem, memberMember);
    
    System.out.println(&quot;####### stemPriv #######&quot;);
    System.out.println(membershipPathGroup.toString());
    
    membershipPathGroup = MembershipPathGroup.analyzePrivileges(privAttributeDef, memberMember);
    
    System.out.println(&quot;####### attributeDefPriv #######&quot;);
    System.out.println(membershipPathGroup.toString());
    
    //########################## noncomposite as test.subject.1
    System.out.println(&quot;\n\n########################## noncomposite as test.subject.1\n&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleThenEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleThenEnum.html#L332">332</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleThenEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleThenEnum.html#L454">454</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleThenEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleThenEnum.html#L576">576</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  reassignGroupPrivilegesIfFromGroup {

    /**
     * @see RuleThenEnum#validate(RuleDefinition)
     */
    @Override
    public String validate(RuleDefinition ruleDefinition) {

      if (!StringUtils.isBlank(ruleDefinition.getThen().getThenEnumArg2())) {
        return &quot;ruleThenEnumArg2 should not be entered for this ruleThenEnum: &quot; + this.name();
      }

      if (!StringUtils.isBlank(ruleDefinition.getThen().getThenEnumArg1())) {
        return &quot;ruleThenEnumArg1 should not be entered for this ruleThenEnum: &quot; + this.name();
      }

      if (!StringUtils.isBlank(ruleDefinition.getThen().getThenEnumArg1())) {
        return &quot;ruleThenEnumArg0 should not be entered for this ruleThenEnum: &quot; + this.name();
      }

      return null;
    }
    
    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleThenEnum#fireRule(edu.internet2.middleware.grouper.rules.RuleDefinition, edu.internet2.middleware.grouper.rules.RuleEngine, edu.internet2.middleware.grouper.rules.beans.RulesBean)
     */
    @Override
    public Object fireRule(RuleDefinition ruleDefinition, RuleEngine ruleEngine,
        RulesBean rulesBean, StringBuilder logDataForThisDefinition) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3054">3054</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3589">3589</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    long size = -1;
    
    if (maxAssignments &gt;= 0) {
  
      size = byHqlStatic.createQuery(countPrefix + sql.toString()).uniqueResult(long.class);    
      
      //see if too many
      if (size &gt; maxAssignments) {
        throw new RuntimeException(&quot;Too many results: &quot; + size);
      }
      
    }
    
    Set&lt;AttributeAssign&gt; results = size == 0 ? new LinkedHashSet&lt;AttributeAssign&gt;() 
        : byHqlStatic.createQuery(selectPrefix + sql.toString()).listSet(AttributeAssign.class);
  
    //nothing to filter
    if (GrouperUtil.length(results) == 0) {
      return results;
    }
    
    //if the hql didnt filter, we need to do that here
    results = grouperSession.getAttributeDefResolver().postHqlFilterAttributeAssigns(grouperSessionSubject, results);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PermissionEntryDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PermissionEntryDAO.html#L864">864</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3PITPermissionAllViewDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3PITPermissionAllViewDAO.html#L150">150</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      .setCacheRegion(KLASS + &quot;.findRolePermissions&quot;);

    int maxAssignments = GrouperConfig.retrieveConfig().propertyValueInt(&quot;ws.findPermissions.maxResultSize&quot;, 30000);
    
    String sqlString = sql.toString();
    
    //if we did where and, then switch to where
    sqlString = sqlString.replaceAll(&quot;where\\s+and&quot;, &quot;where&quot;);
    
    Set&lt;PermissionEntry&gt; results = byHqlStatic.createQuery(selectPrefix + sqlString).listSet(PermissionEntry.class);

    int size = GrouperUtil.length(results);
    if (maxAssignments &gt;= 0) {

      //doesnt work on mysql i think due to hibernate and composite key
      //size = byHqlStatic.createQuery(countPrefix + sqlString).uniqueResult(long.class);    
      
      //see if too many
      if (size &gt; maxAssignments) {
        throw new RuntimeException(&quot;Too many results: &quot; + size);
      }
      
    }
    

    //nothing to filter
    if (size == 0) {
      return results;
    }
    
    //if the hql didnt filter, we need to do that here
    results = grouperSession.getAttributeDefResolver().postHqlFilterPermissions(grouperSessionSubject, results);
    
    //we should be down to the secure list
    return results;
      
  }


}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L978">978</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1030">1030</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1083">1083</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1131">1131</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1191">1191</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1251">1251</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        RuleCheckType.flattenedMembershipRemove.name());
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumName(), RuleThenEnum.sendEmail.name());
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg0Name(), emailToValue);
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg1Name(), emailSubjectValue);
    
    //the to, subject, or body could be text with EL variables, or could be a template.  If template, it is
    //read from the classpath from package: grouperRulesEmailTemplates/theTemplateName.txt
    //or you could configure grouper.properties to keep them in an external folder, not in the classpath
    attributeAssign.getAttributeValueDelegate().assignValue(
        RuleUtils.ruleThenEnumArg2Name(), emailBodyValue);
    
    //should be valid
    String isValidString = attributeAssign.getAttributeValueDelegate().retrieveValueString(
        RuleUtils.ruleValidName());

    if (!StringUtils.equals(&quot;T&quot;, isValidString)) {
      throw new RuntimeException(isValidString);
    }
    
    return attributeAssign;
 
  }
  
  /**
   * 
   * @param actAsSubject
   * @param ruleStem
   * @param stemScope
   * @param emailToValue
   * @param emailSubjectValue
   * @param emailBodyValue
   * @return the assignment in case there are edits
   */
  public static AttributeAssign emailOnFlattenedMembershipAddFromStem(Subject actAsSubject, Stem ruleStem,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L9326">9326</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L6147">6147</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * &lt;p&gt;Finds a &lt;code&gt;Throwable&lt;/code&gt; by method name.&lt;/p&gt;
   *
   * @param throwable  the exception to examine
   * @param methodName  the name of the method to find and invoke
   * @return the wrapped exception, or &lt;code&gt;null&lt;/code&gt; if not found
   */
  private static Throwable getCauseUsingMethodName(Throwable throwable, String methodName) {
      Method method = null;
      try {
          method = throwable.getClass().getMethod(methodName, (Class[])null);
      } catch (NoSuchMethodException ignored) {
      } catch (SecurityException ignored) {
      }

      if (method != null &amp;&amp; Throwable.class.isAssignableFrom(method.getReturnType())) {
          try {
              return (Throwable) method.invoke(throwable, EMPTY_OBJECT_ARRAY);
          } catch (IllegalAccessException ignored) {
          } catch (IllegalArgumentException ignored) {
          } catch (InvocationTargetException ignored) {
          }
      }
      return null;
  }

  /**
   * &lt;p&gt;Finds a &lt;code&gt;Throwable&lt;/code&gt; by field name.&lt;/p&gt;
   *
   * @param throwable  the exception to examine
   * @param fieldName  the name of the attribute to examine
   * @return the wrapped exception, or &lt;code&gt;null&lt;/code&gt; if not found
   */
  private static Throwable getCauseUsingFieldName(Throwable throwable, String fieldName) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportGroup.html#L277">277</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportStem.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportStem.html#L262">262</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * modifierId
   * @param modifierId1
   */
  public void setModifierId(String modifierId1) {
    this.modifierId = modifierId1;
  }

  /**
   * modifierTime
   * @return modifierTime
   */
  public String getModifierTime() {
    return this.modifierTime;
  }

  /**
   * modifierTime
   * @param modifierTime1
   */
  public void setModifierTime(String modifierTime1) {
    this.modifierTime = modifierTime1;
  }

  /**
   * displayExtension
   * @return displayExtension
   */
  public String getDisplayExtension() {
    return this.displayExtension;
  }

  /**
   * displayExtension
   * @param displayExtension1
   */
  public void setDisplayExtension(String displayExtension1) {
    this.displayExtension = displayExtension1;
  }

  /**
   * extension
   * @return extension
   */
  public String getExtension() {
    return this.extension;
  }

  /**
   * extension
   * @param extension1
   */
  public void setExtension(String extension1) {
    this.extension = extension1;
  }

  /**
   * description
   * @return description
   */
  public String getDescription() {
    return this.description;
  }

  /**
   * description
   * @param description1
   */
  public void setDescription(String description1) {
    this.description = description1;
  }

  /**
   * hibernateVersionNumber
   * @return hibernateVersionNumber
   */
  public long getHibernateVersionNumber() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssignActionSet.html#L442">442</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\AttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDefNameSet.html#L462">462</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\permissions\role\RoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/permissions/role/RoleSet.html#L441">441</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\stem\StemSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/stem/StemSet.html#L363">363</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  /**
   * @return depth
   */
  public int getDepth() {
    return depth;
  }

  /**
   * set depth
   * @param depth
   */
  public void setDepth(int depth) {
    this.depth = depth;
  }

  /**
   * context id of the transaction
   * @return context id
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * when created
   * @return timestamp
   */
  public Timestamp getCreatedOn() {
    return this.createdOnDb == null ? null : new Timestamp(this.createdOnDb);
  }

  /**
   * when created
   * @return timestamp
   */
  public Long getCreatedOnDb() {
    return this.createdOnDb;
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Timestamp getLastUpdated() {
    return this.lastUpdatedDb == null ? null : new Timestamp(this.lastUpdatedDb);
  }

  /**
   * when last updated
   * @return timestamp
   */
  public Long getLastUpdatedDb() {
    return this.lastUpdatedDb;
  }

  /**
   * save or update this object
   */
  public void saveOrUpdate() {
    GrouperDAOFactory.getFactory().getAttributeAssignActionSet().saveOrUpdate(this);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\audit\AuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditEntry.html#L988">988</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogEntry.html#L801">801</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    this.serverUserName = GrouperUtil.truncateAscii(this.serverUserName, 50);
    this.string01 = GrouperUtil.truncateAscii(this.string01, 4000);
    this.string02 = GrouperUtil.truncateAscii(this.string02, 4000);
    this.string03 = GrouperUtil.truncateAscii(this.string03, 4000);
    this.string04 = GrouperUtil.truncateAscii(this.string04, 4000);
    this.string05 = GrouperUtil.truncateAscii(this.string05, 4000);
    this.string06 = GrouperUtil.truncateAscii(this.string06, 4000);
    this.string07 = GrouperUtil.truncateAscii(this.string07, 4000);
    this.string08 = GrouperUtil.truncateAscii(this.string08, 4000);
    this.userIpAddress = GrouperUtil.truncateAscii(this.userIpAddress, 50);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L779">779</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L695">695</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>                MultiKey privilegeAssignTypeKey = new MultiKey(member.getSubjectSourceId(), member.getSubjectId(), group.getId(), membership.getFieldId());
    
                PrivilegeAssignType privilegeAssignType = privilegeAssignTypeMap.get(privilegeAssignTypeKey);
                if (privilegeAssignType == null) {
                  throw new RuntimeException(&quot;Why is result not there???&quot;);
                }
                privilegeContainerImpl.setPrivilegeAssignType(privilegeAssignType);
                privilegeSubjectContainerImpl.getPrivilegeContainers().put(privilegeName, privilegeContainerImpl);
                
              }
            }
          }
        }
      }
      
      
      return results;
    } catch (RuntimeException e) {
      exception = e;
      LOG.error(GrouperUtil.mapToString(debugLog), e);
      throw e;
    } finally {
      if (LOG.isDebugEnabled() &amp;&amp; exception == null) {
        LOG.debug(GrouperUtil.mapToString(debugLog));
      }
    }
  }


} // public class GrouperAccessAdapter </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L776">776</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\GrouperLoaderType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/GrouperLoaderType.html#L913">913</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapTypeName(), attributeName);
      }

      /**
       * 
       * @see edu.internet2.middleware.grouper.app.loader.GrouperLoaderType#attributeOptional(java.lang.String)
       */
      @Override
      public boolean attributeOptional(String attributeName) {
        return StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSearchDnName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSearchScopeName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSourceIdName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapAndGroupsName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapPriorityName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapGroupsLikeName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapSubjectIdTypeName(), attributeName)
            || StringUtils.equals(LoaderLdapUtils.grouperLoaderLdapExtraAttributesName(), attributeName)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2171">2171</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2820">2820</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    sql = sqlTables.append(&quot; where &quot;).append(sqlWhereClause);
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (memberIdsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\userData\GrouperUserDataApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/userData/GrouperUserDataApi.html#L1069">1069</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\userData\GrouperUserDataApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/userData/GrouperUserDataApi.html#L1740">1740</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public static void favoriteAttributeDefNameAdd(final String userDataGroupName, final Subject subjectToAddTo, final AttributeDefName attributeDefName) {
    
    GrouperSession.callbackGrouperSession(
        GrouperSession.staticGrouperSession().internal_getRootSession(), new GrouperSessionHandler() {
      
      @Override
      public Object callback(GrouperSession grouperSession) throws GrouperSessionException {
        if (attributeDefName == null) {
          throw new NullPointerException(&quot;Why is attributeDefName null?&quot;);
        }
        
        //check security
        if (!attributeDefName.getAttributeDef().getPrivilegeDelegate().canAttrView(subjectToAddTo)) {
          throw new InsufficientPrivilegeException(&quot;Subject: &quot; + GrouperUtil.subjectToString(subjectToAddTo) 
              + &quot; does not have view on attributeDef &quot; + attributeDefName.getAttributeDef().getName()
              + &quot; for attributeDefName: &quot; + attributeDefName.getName());
        }
        
        GrouperUserDataType.favoriteAttributeDefName.add(userDataGroupName, subjectToAddTo, attributeDefName.getId());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L738">738</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\changeLog\ChangeLogType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/changeLog/ChangeLogType.html#L706">706</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    this.labelInt05 = GrouperUtil.truncateAscii(this.labelInt05, 50);
    this.labelString01 = GrouperUtil.truncateAscii(this.labelString01, 50);
    this.labelString02 = GrouperUtil.truncateAscii(this.labelString02, 50);
    this.labelString03 = GrouperUtil.truncateAscii(this.labelString03, 50);
    this.labelString04 = GrouperUtil.truncateAscii(this.labelString04, 50);
    this.labelString05 = GrouperUtil.truncateAscii(this.labelString05, 50);
    this.labelString06 = GrouperUtil.truncateAscii(this.labelString06, 50);
    this.labelString07 = GrouperUtil.truncateAscii(this.labelString07, 50);
    this.labelString08 = GrouperUtil.truncateAscii(this.labelString08, 50);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L2971">2971</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3024">3024</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    StringBuilder sql = new StringBuilder(&quot;select ms, m from MembershipEntry as ms, Member as m where  &quot;
        + &quot; ms.ownerAttrDefId   = :owner &quot;
        + &quot; and  ms.memberUuid  = m.uuid   &quot;
        );

    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic()
      .setCacheable(true)
      .setCacheRegion(KLASS)
      .setString(&quot;owner&quot;, attributeDefId)
      .options(queryOptions);

    HibUtils.convertFieldsToSqlInString(fields, byHqlStatic, sql, &quot;ms.fieldId&quot;);
    HibUtils.convertSourcesToSqlInString(sources, byHqlStatic, sql, &quot;m.subjectSourceIdDb&quot;);
    
    if (membershipType != null) {
      sql.append(&quot;and  ms.type &quot;).append(membershipType.queryClause());
    }
    
    if (enabled != null) {
      sql.append(&quot; and ms.enabledDb = '&quot; + (enabled ? 'T' : 'F') + &quot;'&quot;);
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L178">178</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L229">229</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        batch.add(groupSet);
        logDetail(&quot;Adding self groupSet for &quot; + group.getName() + &quot; for field &quot; + field.getTypeString() + &quot; / &quot; + field.getName());

        if (batch.size() % batchSize == 0 || !groupsAndFieldsIter.hasNext()) {
          if (saveUpdates) {
            GrouperDAOFactory.getFactory().getGroupSet().saveBatch(batch);
          }
          batch.clear();
        }
        
        processedCount++;
      }
      
      if (groupsAndFields.size() &gt; 0 &amp;&amp; saveUpdates) {
        showStatus(&quot;Done making &quot; + totalCount + &quot; updates&quot;);
      }
    } finally {
      stopStatusThread();
    }
  }
  
  /**
   * Add missing self group sets for groups with custom fields
   */
  public void addMissingSelfGroupSetsForGroupsWithCustomFields() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\permissions\limits\impl\PermissionLimitIpOnNetworkRealm.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/permissions/limits/impl/PermissionLimitIpOnNetworkRealm.html#L38">38</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\permissions\limits\impl\PermissionLimitIpOnNetworks.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/permissions/limits/impl/PermissionLimitIpOnNetworks.html#L37">37</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>public class PermissionLimitIpOnNetworkRealm extends PermissionLimitBase {

  /**
   * @see PermissionLimitInterface#allowPermission(PermissionEntry, AttributeAssign, Set, Map, Set)
   */
  public boolean allowPermission(PermissionEntry permissionEntry,
      AttributeAssign limitAssignment, Set&lt;AttributeAssignValue&gt; limitAssignmentValues,
      Map&lt;String, Object&gt; limitEnvVars, Set&lt;PermissionLimitBean&gt; permissionLimitBeans) {
    
    String ipAddress = (String)limitEnvVars.get(&quot;ipAddress&quot;);
    String errorMessage = &quot;You must pass in an env var with name 'ipAddress' which is a string which looks like: 1.2.3.4&quot;;

    if (GrouperUtil.isBlank(ipAddress)) {
      throw new RuntimeException(errorMessage);
    }
    
    //get what the limit is
    String theLimit = null;
    if (GrouperUtil.length(limitAssignmentValues) == 1) {
      theLimit = limitAssignmentValues.iterator().next().getValueString();
    }

    if (StringUtils.isBlank(theLimit)) {
      throw new RuntimeException(&quot;There is an ip on network realm limit assigned (assignment id: &quot; + limitAssignment.getId() </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\bench\XmlImportEmpty.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/bench/XmlImportEmpty.html#L70">70</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\bench\XmlUpdateEmpty.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/bench/XmlUpdateEmpty.html#L70">70</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  protected XmlImportEmpty() {
    super();
  } // protected XmlImportEmpty()

  // PUBLIC INSTANCE METHODS //

  /**
   * @since 1.1.0
   */
  public void init() 
    throws GrouperException 
  {
    try {
      GrouperSession  s         = GrouperSession.start( SubjectFinder.findRootSubject() );
      XmlExporter     exporter  = new XmlExporter( s, new Properties() );
      Writer          w         = new StringWriter();
      exporter.export(w);
      this.xml                  = w.toString();
      this.importer             = new XmlImporter( s, new Properties() );
    }
    catch (Exception e) {
      throw new GrouperException(e.getMessage());
    }
  } // public void init()

  /**
   * @since 1.1.0
   */
  public void run() 
    throws GrouperException 
  {
    try {
      this.importer.load( XmlReader.getDocumentFromString(this.xml) );</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\GrouperSession.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/GrouperSession.html#L231">231</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\GrouperSession.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/GrouperSession.html#L297">297</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public static GrouperSession startBySubjectIdAndSource(final String subjectId, final String sourceId, 
      boolean addToThreadLocal) {

    Subject subject = null;
    
    GrouperSession grouperSession = GrouperSession.staticGrouperSession(false);
    boolean startedSession = false;
    
    try {
      
      if (grouperSession == null) {
        grouperSession = GrouperSession.startRootSession(false);
        startedSession = true;
      }
      
      if (!PrivilegeHelper.isWheelOrRoot(grouperSession.getSubject())) {
        grouperSession = grouperSession.internal_getRootSession();
      }
      
      subject = (Subject)GrouperSession.callbackGrouperSession(grouperSession, new GrouperSessionHandler() {

        /**
         * 
         */
        @Override
        public Object callback(GrouperSession grouperSession)
            throws GrouperSessionException {

          if (StringUtils.isBlank(sourceId)) {
            return SubjectFinder.findById(subjectId, true);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L2976">2976</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3077">3077</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic()
      .setCacheable(true)
      .setCacheRegion(KLASS)
      .setString(&quot;owner&quot;, attributeDefId)
      .options(queryOptions);

    HibUtils.convertFieldsToSqlInString(fields, byHqlStatic, sql, &quot;ms.fieldId&quot;);
    HibUtils.convertSourcesToSqlInString(sources, byHqlStatic, sql, &quot;m.subjectSourceIdDb&quot;);
    
    if (membershipType != null) {
      sql.append(&quot;and  ms.type &quot;).append(membershipType.queryClause());
    }
    
    if (enabled != null) {
      sql.append(&quot; and ms.enabledDb = '&quot; + (enabled ? 'T' : 'F') + &quot;'&quot;);
    }
    byHqlStatic.createQuery(sql.toString());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L2979">2979</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3224">3224</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      .setString(&quot;owner&quot;, attributeDefId)
      .options(queryOptions);

    HibUtils.convertFieldsToSqlInString(fields, byHqlStatic, sql, &quot;ms.fieldId&quot;);
    HibUtils.convertSourcesToSqlInString(sources, byHqlStatic, sql, &quot;m.subjectSourceIdDb&quot;);
    
    if (membershipType != null) {
      sql.append(&quot;and  ms.type &quot;).append(membershipType.queryClause());
    }
    
    if (enabled != null) {
      sql.append(&quot; and ms.enabledDb = '&quot; + (enabled ? 'T' : 'F') + &quot;'&quot;);
    }
    byHqlStatic.createQuery(sql.toString());

    Set&lt;Object[]&gt; mships = byHqlStatic
      .listSet(Object[].class);
    return mships;
  }

  /**
   * @see edu.internet2.middleware.grouper.internal.dao.MembershipDAO#findAllByAttributeDefOwnerOptions(java.lang.String, java.util.Collection, edu.internet2.middleware.grouper.membership.MembershipType, java.util.Collection, java.util.Set, java.lang.Boolean, edu.internet2.middleware.grouper.internal.dao.QueryOptions)
   */
  public Set&lt;Object[]&gt; findAllByAttributeDefOwnerOptions(String attributeDefId,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3121">3121</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3221">3221</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic()
      .setCacheable(true)
      .setCacheRegion(KLASS)
      .setString(&quot;owner&quot;, groupId)
      .options(queryOptions);
  
    HibUtils.convertFieldsToSqlInString(fields, byHqlStatic, sql, &quot;ms.fieldId&quot;);
    HibUtils.convertSourcesToSqlInString(sources, byHqlStatic, sql, &quot;m.subjectSourceIdDb&quot;);
    
    if (membershipType != null) {
      sql.append(&quot;and  ms.type &quot;).append(membershipType.queryClause());
    }
    
    if (enabled != null) {
      sql.append(&quot; and ms.enabledDb = '&quot; + (enabled ? 'T' : 'F') + &quot;'&quot;);
    }
    
    byHqlStatic.createQuery(sql.toString());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\db\GrouperLoaderResultset.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/db/GrouperLoaderResultset.html#L433">433</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\db\GrouperLoaderResultset.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/db/GrouperLoaderResultset.html#L696">696</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    String groupParentFolderNameTemp = requireTopStemAsStemFromConfigGroup ? (GrouperUtil.parentStemNameFromName(groupName) + &quot;:&quot;) : &quot;&quot;;
    if (!StringUtils.isBlank(groupParentFolderNameTemp) &amp;&amp; !groupParentFolderNameTemp.endsWith(&quot;:&quot;)) {
      groupParentFolderNameTemp += &quot;:&quot;;
    }
    final String groupParentFolderName = groupParentFolderNameTemp;

    
    Map&lt;String, List&lt;String&gt;&gt; resultMap = null;
    try {

      resultMap = (Map&lt;String, List&lt;String&gt;&gt;) LdapSession.callbackLdapSession(
          ldapServerId, new LdapHandler() {

            public Object callback(LdapHandlerBean ldapHandlerBean)
                throws NamingException {

              Ldap ldap = ldapHandlerBean.getLdap();

              Iterator&lt;SearchResult&gt; searchResultIterator = null;

              List&lt;String&gt; attributesList = new ArrayList&lt;String&gt;();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L399">399</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L470">470</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        logDetail(&quot;Adding groupSet for ownerStemId = &quot; + mship.getOwnerStemId() + 
            &quot;, memberGroupId = &quot; + mship.getMemberSubjectId() + &quot; for field &quot; + field.getTypeString() + &quot; / &quot; + field.getName());

        if (batch.size() % batchSize == 0 || !mshipsIter.hasNext()) {
          if (saveUpdates) {
            // We're not doing batch inserts here because the onPostSave 
            // of one groupSet insert might insert another groupSet in a child 
            // transaction that the parent transaction needs to know about
            // for the next batch insert.
            GrouperDAOFactory.getFactory().getGroupSet().save(batch);
          }
          batch.clear();
        }
        
        processedCount++;
      }
      
      if (mships.size() &gt; 0 &amp;&amp; saveUpdates) {
        showStatus(&quot;Done making &quot; + totalCount + &quot; updates&quot;);
      }
    } finally {
      stopStatusThread();
    }
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByHql.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByHql.html#L120">120</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByHqlStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByHqlStatic.html#L103">103</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    if (this.bindVarNameParams != null) {
      int index = 0;
      int size = this.bindVarNameParams().size();
      for (HibernateParam hibernateParam : this.bindVarNameParams()) {
        result.append(&quot;Bind var[&quot;).append(index++).append(&quot;]: '&quot;);
        result.append(hibernateParam);
        if (index!=size-1) {
          result.append(&quot;, &quot;);
        }
      }
    }
    return result.toString();
  }
  
  /**
   * cache region for cache
   */
  private String cacheRegion = null;

  /**
   * map of params to attach to the query.
   * access this with the bindVarNameParams method
   */
  private List&lt;HibernateParam&gt; bindVarNameParams = null;

  /**
   * query to execute
   */
  private String query = null;

  /**
   * if we are sorting, paging, resultSize, etc 
   */
  private QueryOptions queryOptions = null;

  /**
   * set the query to run
   * @param theHqlQuery
   * @return this object for chaining
   */
  public ByHql createQuery(String theHqlQuery) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2020">2020</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2301">2301</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2571">2571</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2702">2702</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    sql = sqlTables.append(sqlWhereClause);
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (groupIdsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\MembershipFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/MembershipFinder.html#L1691">1691</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\MembershipFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/MembershipFinder.html#L2427">2427</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          .findAllMembersByStemOwnerAndFieldAndType(stem.getUuid(), f,
              MembershipType.IMMEDIATE.getTypeString(), null, true).iterator();

      while (it.hasNext()) {
        try {
          subjs.add(new LazySubject(it.next()));
        } catch (GrouperException gre) {
          if (gre.getCause() instanceof MemberNotFoundException) {
            throw (MemberNotFoundException) gre.getCause();
          }
          if (gre.getCause() instanceof SubjectNotFoundException) {
            throw (SubjectNotFoundException) gre.getCause();
          }
        }
      }
    } catch (MemberNotFoundException eMNF) {
      String msg = &quot;internal_findStemSubjectsImmediateOnly: &quot; + eMNF.getMessage();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L558">558</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L604">604</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public static AttributeAssign groupIntersection(Subject actAs, Group ruleGroup, Group mustBeInGroup) {
    AttributeAssign attributeAssign = ruleGroup
      .getAttributeDelegate().addAttribute(RuleUtils.ruleAttributeDefName()).getAttributeAssign();

    AttributeValueDelegate attributeValueDelegate = attributeAssign.getAttributeValueDelegate();

    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectSourceIdName(), actAs.getSourceId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectIdName(), actAs.getId());
    
    //note &quot;mustBeInGroup&quot; is the group (e.g. employees)
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckOwnerIdName(), mustBeInGroup.getId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckTypeName(),
        RuleCheckType.membershipRemove.name());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleIfConditionEnumName(),
        RuleIfConditionEnum.thisGroupHasImmediateEnabledMembership.name());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L770">770</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L816">816</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      AttributeDef permissionToAssignRule, Group mustBeInGroup, int daysInFutureToDisable) {

    //add a rule on stem:permission saying if you are out of stem:employee, 
    //then put disabled date on assignments to permission, or from roles which have the permission
    AttributeAssign attributeAssign = permissionToAssignRule
      .getAttributeDelegate().addAttribute(RuleUtils.ruleAttributeDefName()).getAttributeAssign();
    
    AttributeValueDelegate attributeValueDelegate = attributeAssign.getAttributeValueDelegate();
    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectSourceIdName(), actAs.getSourceId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectIdName(), actAs.getId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckOwnerIdName(), mustBeInGroup.getId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckTypeName(), 
        RuleCheckType.membershipRemove.name());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleIfConditionEnumName(), 
        RuleIfConditionEnum.thisPermissionDefHasNoEndDateAssignment.name());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\AttributeDefScopeDelegate.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDefScopeDelegate.html#L214">214</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\AttributeDefScopeDelegate.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDefScopeDelegate.html#L241">241</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      String scopeString) {
    
    //make sure you can admin the constraint scope
    GrouperSession grouperSession = GrouperSession.staticGrouperSession();
    if (!PrivilegeHelper.canAttrAdmin(grouperSession, this.attributeDef, grouperSession.getSubject())) {
      throw new RuntimeException(&quot;Cannot attr_admin attributeDef: &quot; + this.attributeDef.getName());
    }

    Set&lt;AttributeDefScope&gt; attributeDefScopes = new HashSet&lt;AttributeDefScope&gt;();
    for (AttributeDefScope attributeDefScope : this.retrieveAttributeDefScopes()) {
      if (GrouperUtil.equals(attributeDefScopeType, attributeDefScope.getAttributeDefScopeType())
          &amp;&amp; StringUtils.equals(StringUtils.trimToNull(scopeString), StringUtils.trimToNull(attributeDefScope.getScopeString()))) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1085">1085</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3726">3726</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3848">3848</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>          + &quot; stemIdsSize &quot; + stemIdsSize + &quot; or attributeDefIdsSize &quot; 
          + attributeDefIdsSize + &quot; or attributeDefNameIds &quot; + attributeDefNameIdsSize 
          + &quot; or actionsSize &quot; + actionsSize + &quot; or ownerAttributeAssignIdsSize &quot; + ownerAttributeAssignIdsSize
          + &quot; or ownerAttributeDefIdsSize &quot; + ownerAttributeDefIdsSize 
          + &quot; ownerAttributeDefNameIdsSize &quot; + ownerAttributeDefNameIdsSize
          + &quot; or ownerActionsSize &quot; + ownerActionsSize);
    }

    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic();

    String selectPrefix = &quot;select distinct aa &quot;;
    String countPrefix = &quot;select count(distinct aa) &quot;;

    StringBuilder sqlTables = new StringBuilder(&quot; from AttributeAssign aa, AttributeDefName adn, AttributeAssign ownerAa, AttributeDefName ownerAdn &quot;);

    if (attributeDefType != null) {
      sqlTables.append(&quot;, AttributeDef ad &quot;);
    }

    if (actionsSize &gt; 0) {
      sqlTables.append(&quot;, AttributeAssignAction aaa &quot;);
    }

    if (ownerActionsSize &gt; 0) {
      sqlTables.append(&quot;, AttributeAssignAction ownerAaa &quot;);
    }

    StringBuilder sqlWhereClause = new StringBuilder(
    		&quot; aa.attributeDefNameId = adn.id and ownerAa.attributeDefNameId = ownerAdn.id and aa.ownerAttributeAssignId = ownerAa.id &quot;);

    sqlWhereClause.append(&quot; and aa.attributeAssignTypeDb = 'stem_asgn' &quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Membership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Membership.html#L1270">1270</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Membership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Membership.html#L2714">2714</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    GrouperSession s, Stem ns, Subject subj, Field f, String uuid)
    throws  MemberAddException  {
    try {
      GrouperSession.validate(s);
      Member member = MemberFinder.internal_findReadableMemberBySubject(s, subj, true);
      
      Membership ms = new Membership();
      
      //if we are assigning the uuid
      if (!StringUtils.isBlank(uuid)) {
        ms.setImmediateMembershipId(uuid);
      }
      
      ms.setCreatorUuid(s.getMemberUuid());
      ms.setFieldId(FieldFinder.findFieldId(f.getName(), f.getType().toString(), true));
      ms.setMemberUuid(member.getUuid());
      ms.setOwnerStemId(ns.getUuid());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L341">341</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L470">470</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        logDetail(&quot;Adding groupSet for ownerGroupId = &quot; + mship.getOwnerGroupId() + 
            &quot;, memberGroupId = &quot; + mship.getMemberSubjectId() + &quot; for field &quot; + field.getTypeString() + &quot; / &quot; + field.getName());

        if (batch.size() % batchSize == 0 || !mshipsIter.hasNext()) {
          if (saveUpdates) {
            // We're not doing batch inserts here because the onPostSave 
            // of one groupSet insert might insert another groupSet in a child 
            // transaction that the parent transaction needs to know about
            // for the next batch insert.
            GrouperDAOFactory.getFactory().getGroupSet().save(batch);
          }
          batch.clear();
        }
        
        processedCount++;
      }
      
      if (mships.size() &gt; 0 &amp;&amp; saveUpdates) {
        showStatus(&quot;Done making &quot; + totalCount + &quot; updates&quot;);
      }
    } finally {
      stopStatusThread();
    }
  }
  
  /**
   * Add missing group sets for immediate memberships where the owner is a stem
   */
  public void addMissingImmediateGroupSetsForStemOwners() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L188">188</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L346">346</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L635">635</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      update((Collection)object);
      return;
    }
    try {
      GrouperTransactionType grouperTransactionTypeToUse = 
        (GrouperTransactionType)ObjectUtils.defaultIfNull(this.grouperTransactionType, 
            GrouperTransactionType.READ_WRITE_OR_USE_EXISTING);
      
      HibernateSession.callbackHibernateSession(
          grouperTransactionTypeToUse, AuditControl.WILL_NOT_AUDIT,
          new HibernateHandler() {
  
            public Object callback(HibernateHandlerBean hibernateHandlerBean)
                throws GrouperDAOException {
              HibernateSession hibernateSession = hibernateHandlerBean.getHibernateSession();
              
              GrouperUtil.assertion(ByObjectStatic.this.cacheable == null, 
                  &quot;Cant set cacheable here&quot;);
              GrouperUtil.assertion(ByObjectStatic.this.cacheRegion == null, 
                  &quot;Cant set cacheRegion here&quot;);
              
              ByObject byObject = hibernateSession.byObject();
              ByObjectStatic.this.copyFieldsTo(byObject);
              byObject.update(object);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hooks\examples\GroupTypeSecurityHook.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hooks/examples/GroupTypeSecurityHook.html#L262">262</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hooks\examples\GroupTypeTupleIncludeExcludeHook.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hooks/examples/GroupTypeTupleIncludeExcludeHook.html#L118">118</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }
  
  /**
   * 
   * @param attributeName
   * @return the group name from the config file
   */
  public static String groupNameFromAndGroupAttributeName(String attributeName) {
    int i=0;
    while (true) {
      String propertyName = &quot;grouperIncludeExclude.requireGroup.name.&quot; + i;
      String propertyValue = GrouperConfig.retrieveConfig().propertyValueString(propertyName);
      if (StringUtils.isBlank(propertyValue)) {
        break;
      }
      if (StringUtils.equals(attributeName, propertyValue)) {
        //this is the right index, get the group name
        return GrouperConfig.retrieveConfig().propertyValueString(&quot;grouperIncludeExclude.requireGroup.group.&quot; + i);
      }
      i++;
    }
    throw new RuntimeException(&quot;Cant find config entry for andGroup attribute name: &quot; + attributeName 
        + &quot;, e.g. config name: grouperIncludeExclude.requireGroup.name.{i}&quot;);  }

  /**
   * 
   * @see edu.internet2.middleware.grouper.hooks.GroupTypeTupleHooks#groupTypeTuplePostDelete(edu.internet2.middleware.grouper.hooks.beans.HooksContext, edu.internet2.middleware.grouper.hooks.beans.HooksGroupTypeTupleBean)
   */
  @Override
  public void groupTypeTuplePostDelete(HooksContext hooksContext,
      HooksGroupTypeTupleBean postDeleteBean) {
    groupTypeTupleHelper(postDeleteBean, &quot;removing type&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Membership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Membership.html#L1286">1286</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Membership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Membership.html#L2730">2730</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      ms.setOwnerStemId(ns.getUuid());
      ms.setMember(member);

      GrouperDAOFactory.getFactory().getMembership().save(ms);
      
      return ms;
      
    } catch (MembershipAlreadyExistsException eIS) {
      throw new MemberAddAlreadyExistsException( eIS.getMessage(), eIS );
    } catch (IllegalStateException eIS) {
      throw new MemberAddException( eIS.getMessage(), eIS );
    }    
    catch (InsufficientPrivilegeException eIP)  {
      throw new MemberAddException(eIP.getMessage(), eIP);
    }
    catch (MemberNotFoundException eMNF)        {
      throw new MemberAddException( eMNF.getMessage(), eMNF );
    }
  }

  /**
   * 
   * @param s
   * @param g
   * @param subj
   * @param f
   * @return the deleted membership
   * @throws MemberDeleteException
   */
  public static Membership internal_delImmediateMembership(GrouperSession s, Group g, Subject subj, Field f)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Membership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Membership.html#L1458">1458</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Membership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Membership.html#L2774">2774</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          Iterator itHas = dao.findAllByStemOwnerAndFieldAndType(ns.getUuid(), f, 
              MembershipType.IMMEDIATE.getTypeString(), false).iterator();
          while (itHas.hasNext()) {
            ms = (Membership) itHas.next() ;
            ms.delete();
          }
          
          return null;
        }
        catch (MemberNotFoundException eMNF) {
          throw new GrouperSessionException(new MemberDeleteException( eMNF.getMessage(), eMNF ));
        }
        catch (MembershipNotFoundException eMSNF) {
          throw new GrouperSessionException(new MemberDeleteException( eMSNF.getMessage(), eMSNF ));
        }
      }
      
    });
  }

  /**
   * 
   * @param s
   * @param g
   * @param type
   * @throws MemberDeleteException
   * @throws SchemaException
   */
  public static void internal_deleteAllFieldType(GrouperSession s, Group g, FieldType type) </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssignActionSet.html#L510">510</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\attr\AttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDefNameSet.html#L530">530</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\permissions\role\RoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/permissions/role/RoleSet.html#L509">509</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\stem\StemSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/stem/StemSet.html#L431">431</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    GrouperDAOFactory.getFactory().getAttributeAssignActionSet().delete(this);
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOnDb(Long createdOn1) {
    this.createdOnDb = createdOn1;
  }

  /**
   * when created
   * @param createdOn1
   */
  public void setCreatedOn(Timestamp createdOn1) {
    this.createdOnDb = createdOn1 == null ? null : createdOn1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdated(Timestamp lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1 == null ? null : lastUpdated1.getTime();
  }

  /**
   * when last updated
   * @param lastUpdated1
   */
  public void setLastUpdatedDb(Long lastUpdated1) {
    this.lastUpdatedDb = lastUpdated1;
  }

  /**
   * @see edu.internet2.middleware.grouper.grouperSet.GrouperSet#__getId()
   */
  public String __getId() {
    return this.getId();
  }

  /**
   * @see edu.internet2.middleware.grouper.grouperSet.GrouperSet#__getIfHasElementId()
   */
  public String __getIfHasElementId() {
    return this.getIfHasAttrAssignActionId();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\AttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDef.html#L1932">1932</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Stem.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Stem.html#L3309">3309</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public void onPostUpdate(HibernateSession hibernateSession) {
    
    if (this.dbVersionDifferentFields().contains(FIELD_NAME)) {
      GrouperSession.callbackGrouperSession(GrouperSession.staticGrouperSession().internal_getRootSession(), new GrouperSessionHandler() {
  
        /**
         * @see edu.internet2.middleware.grouper.misc.GrouperSessionHandler#callback(edu.internet2.middleware.grouper.GrouperSession)
         */
        public Object callback(GrouperSession rootSession) throws GrouperSessionException {

          // need to potentially update attribute def name in rules
          Set&lt;RuleDefinition&gt; definitions = RuleEngine.ruleEngine().getRuleDefinitions();
          for (RuleDefinition definition : definitions) {
            if (definition.getCheck() != null &amp;&amp; definition.getCheck().checkTypeEnum() != null &amp;&amp; 
                definition.getCheck().checkTypeEnum().isCheckOwnerTypeAttributeDef(definition) &amp;&amp; AttributeDef.this.dbVersion().getName().equals(definition.getCheck().getCheckOwnerName())) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\filter\GroupNameFilter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/filter/GroupNameFilter.html#L151">151</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\filter\StemNameAnyFilter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/filter/StemNameAnyFilter.html#L122">122</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      results = GrouperDAOFactory.getFactory().getGroup().findAllByApproximateNameSecure(this.name, getStringForScope(this.ns), queryOptions, this.typeOfGroups);
    }
    return results;
  } // public Set getResults(s)


  /**
   * true or null for ascending, false for descending.  If you pass true or false, must pass a sort string
   * @return the ascending
   */
  public Boolean getAscending() {
    return this.ascending;
  }


  /**
   * page number 1 indexed if paging
   * @return the pageNumber
   */
  public Integer getPageNumber() {
    return this.pageNumber;
  }


  /**
   * page size if paging
   * @return the pageSize
   */
  public Integer getPageSize() {
    return this.pageSize;
  }


  /**
   * must be an hql query field, e.g. can sort on name, displayName, extension, displayExtension
   * @return the sortString
   */
  public String getSortString() {
    return this.sortString;
  }


  /**
   * true or null for ascending, false for descending.  If you pass true or false, must pass a sort string
   * @param ascending1 the ascending to set
   */
  public void setAscending(Boolean ascending1) {
    this.ascending = ascending1;
  }


  /**
   * page number 1 indexed if paging
   * @param pageNumber1 the pageNumber to set
   */
  public void setPageNumber(Integer pageNumber1) {
    this.pageNumber = pageNumber1;
  }


  /**
   * page size if paging
   * @param pageSize1 the pageSize to set
   */
  public void setPageSize(Integer pageSize1) {
    this.pageSize = pageSize1;
  }


  /**
   * must be an hql query field, e.g. can sort on name, displayName, extension, displayExtension
   * @param sortString1 the sortString to set
   */
  public void setSortString(String sortString1) {
    this.sortString = sortString1;
  }

}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Group.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Group.html#L3872">3872</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Stem.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Stem.html#L1277">1277</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  } 

  /**
   * Grant privilege to a subject on this group.  This
   * will throw an exception if the privilege already exists
   * &lt;pre class=&quot;eg&quot;&gt;
   * try {
   *   g.grantPriv(subj, AccessPrivilege.ADMIN);
   * }
   * catch (GrantPrivilegeException e0) {
   *   // Not privileged to grant this privilege
   * }
   * catch (InsufficientPrivilegeException e1) {
   *   // Unable to grant this privilege
   * }
   * &lt;/pre&gt;
   * @param   subj  Grant privilege to this subject.
   * @param   priv  Grant this privilege.
   * @throws  GrantPrivilegeException
   * @throws  InsufficientPrivilegeException
   * @throws  SchemaException
   */
  public void grantPriv(Subject subj, Privilege priv)
    throws  GrantPrivilegeException,
            InsufficientPrivilegeException,
            SchemaException {
    
    grantPriv(subj, priv, true);
    
  }
  
  /**
   * Grant privilege to a subject on this group.
   * &lt;pre class=&quot;eg&quot;&gt;
   * try {
   *   g.grantPriv(subj, AccessPrivilege.ADMIN);
   * }
   * catch (GrantPrivilegeException e0) {
   *   // Not privileged to grant this privilege
   * }
   * catch (InsufficientPrivilegeException e1) {
   *   // Unable to grant this privilege
   * }
   * &lt;/pre&gt;
   * @param   subj  Grant privilege to this subject.
   * @param   priv  Grant this privilege.
   * @param exceptionIfAlreadyMember if false, and subject is already a member,
   * then dont throw a MemberAddException if the member is already in the group
   * @throws  GrantPrivilegeException
   * @throws  InsufficientPrivilegeException
   * @throws  SchemaException
   * @return false if it already existed, true if it didnt already exist
   */
  public boolean grantPriv(final Subject subj, final Privilege priv, final boolean exceptionIfAlreadyMember)
    throws  GrantPrivilegeException,
            InsufficientPrivilegeException,
            SchemaException {
    return internal_grantPriv(subj, priv, exceptionIfAlreadyMember, null);
  }
  
  /**
   * Grant privilege to a subject on this group.
   * &lt;pre class=&quot;eg&quot;&gt;
   * try {
   *   g.grantPriv(subj, AccessPrivilege.ADMIN);
   * }
   * catch (GrantPrivilegeException e0) {
   *   // Not privileged to grant this privilege
   * }
   * catch (InsufficientPrivilegeException e1) {
   *   // Unable to grant this privilege
   * }
   * &lt;/pre&gt;
   * @param   subj  Grant privilege to this subject.
   * @param   priv  Grant this privilege.
   * @param exceptionIfAlreadyMember if false, and subject is already a member,
   * then dont throw a MemberAddException if the member is already in the group
   * @param uuid
   * @throws  GrantPrivilegeException
   * @throws  InsufficientPrivilegeException
   * @throws  SchemaException
   * @return false if it already existed, true if it didnt already exist
   */
  public boolean internal_grantPriv(final Subject subj, final Privilege priv, final boolean exceptionIfAlreadyMember, final String uuid)
    throws  GrantPrivilegeException,
            InsufficientPrivilegeException,
            SchemaException {
    final StopWatch sw = new StopWatch();
    sw.start();

    final String errorMessageSuffix = &quot;, group name: &quot; + this.name </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2020">2020</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2171">2171</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2301">2301</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2571">2571</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2702">2702</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2820">2820</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    sql = sqlTables.append(sqlWhereClause);
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (groupIdsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L341">341</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\misc\AddMissingGroupSets.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/misc/AddMissingGroupSets.html#L399">399</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        logDetail(&quot;Adding groupSet for ownerGroupId = &quot; + mship.getOwnerGroupId() + 
            &quot;, memberGroupId = &quot; + mship.getMemberSubjectId() + &quot; for field &quot; + field.getTypeString() + &quot; / &quot; + field.getName());

        if (batch.size() % batchSize == 0 || !mshipsIter.hasNext()) {
          if (saveUpdates) {
            // We're not doing batch inserts here because the onPostSave 
            // of one groupSet insert might insert another groupSet in a child 
            // transaction that the parent transaction needs to know about
            // for the next batch insert.
            GrouperDAOFactory.getFactory().getGroupSet().save(batch);
          }
          batch.clear();
        }
        
        processedCount++;
      }
      
      if (mships.size() &gt; 0 &amp;&amp; saveUpdates) {
        showStatus(&quot;Done making &quot; + totalCount + &quot; updates&quot;);
      }
    } finally {
      stopStatusThread();
    }
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L616">616</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L532">532</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            group.getId(), membershipType, fields, null, true, queryOptions);
        
        if (LOG.isDebugEnabled()) {
          debugLog.put(&quot;membersSize&quot;, GrouperUtil.length(members));
          
        }
        
        //ok, if there are results...
        if (GrouperUtil.length(members) &gt; 0) {
          
          //lets get the memberships for these members
          List&lt;String&gt; memberIds = new ArrayList&lt;String&gt;();
          for (Member member : members) {
            memberIds.add(member.getUuid());
          }
          queryOptions = new QueryOptions();
          queryOptions.sort(querySort);
          //note, we arent paging here... we paged the members
          memberships = GrouperDAOFactory.getFactory().getMembership().findAllByGroupOwnerOptions(</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L370">370</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L397">397</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public void revokePriv(GrouperSession grouperSession, AttributeDef attributeDef, Privilege priv)
      throws InsufficientPrivilegeException,
      RevokePrivilegeException,
      SchemaException {
    //note, no need for GrouperSession inverse of control
    GrouperSession.validate(grouperSession);
    Field f = priv.getField();
    if (!FieldType.ATTRIBUTE_DEF.equals(f.getType())) {
      throw new SchemaException(E.FIELD_INVALID_TYPE + f.getType());
    }
    if ( !attributeDef.getPrivilegeDelegate().canAttrAdmin( grouperSession.getSubject() ) ) {
      throw new InsufficientPrivilegeException(&quot;Subject &quot; 
          + GrouperUtil.subjectToString(grouperSession.getSubject()) 
          + &quot; cannot admin attributeDef: &quot; + attributeDef.getName());
    }
    try {
      Membership.internal_deleteAllField(grouperSession, attributeDef, f);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L2198">2198</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L2252">2252</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        Set&lt;RulesMembershipBean&gt; theRulesMembershipBeans = new HashSet&lt;RulesMembershipBean&gt;();
        
        Group group = null;
        if (!StringUtils.isBlank(ruleDefinition.getIfCondition().getIfOwnerId())) {
          group = GroupFinder.findByUuid(rootSession, ruleDefinition.getIfCondition().getIfOwnerId(), false);
        } else if (!StringUtils.isBlank(ruleDefinition.getIfCondition().getIfOwnerName())) {
          group = GroupFinder.findByName(rootSession, ruleDefinition.getIfCondition().getIfOwnerName(), false);
        }
  
        if (group == null) {
          throw new RuntimeException(&quot;Group doesnt exist in rule! &quot; + ruleDefinition);
        }
  
        //find the members which apply
        Set&lt;Member&gt; memberOrphans = GrouperDAOFactory.getFactory().getMembership().findAllMembersInOneGroupNotOtherAndType(thisGroupId, group.getUuid(), </pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\AttributeDefName.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/AttributeDefName.html#L805">805</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Group.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Group.html#L7250">7250</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Stem.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Stem.html#L4118">4118</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (!StringUtils.equals(this.attributeDefId, other.attributeDefId)) {
      return true;
    }
    if (!StringUtils.equals(StringUtils.trimToNull(this.description), StringUtils.trimToNull(other.description))) {
      return true;
    }
    if (!StringUtils.equals(this.displayExtension, other.displayExtension)) {
      return true;
    }
    if (!StringUtils.equals(this.displayName, other.displayName)) {
      return true;
    }
    if (!StringUtils.equals(this.extension, other.extension)) {
      return true;
    }
    if (!StringUtils.equals(this.id, other.id)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3080">3080</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3124">3124</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      .setString(&quot;owner&quot;, attributeDefId)
      .options(queryOptions);

    HibUtils.convertFieldsToSqlInString(fields, byHqlStatic, sql, &quot;ms.fieldId&quot;);
    HibUtils.convertSourcesToSqlInString(sources, byHqlStatic, sql, &quot;m.subjectSourceIdDb&quot;);
    
    if (membershipType != null) {
      sql.append(&quot;and  ms.type &quot;).append(membershipType.queryClause());
    }
    
    if (enabled != null) {
      sql.append(&quot; and ms.enabledDb = '&quot; + (enabled ? 'T' : 'F') + &quot;'&quot;);
    }
    
    byHqlStatic.createQuery(sql.toString());

    List&lt;Member&gt; members = byHqlStatic
      .list(Member.class);
    return members;
  }

  /**
   * generally you will order by m.subjectSourceIdDb, m.subjectIdDb, and page to the first 100
   * @see edu.internet2.middleware.grouper.internal.dao.MembershipDAO#findAllMembersByGroupOwnerOptions(java.lang.String, edu.internet2.middleware.grouper.membership.MembershipType, java.util.Collection, java.util.Set, java.lang.Boolean, edu.internet2.middleware.grouper.internal.dao.QueryOptions)
   */
  public List&lt;Member&gt; findAllMembersByGroupOwnerOptions(String groupId,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssignActionSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssignActionSet.html#L359">359</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITAttributeDefNameSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeDefNameSet.html#L357">357</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITGroupSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITGroupSet.html#L1031">1031</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\PITMembership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITMembership.html#L829">829</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITRoleSet.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITRoleSet.html#L358">358</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    return (PITAttributeAssignActionSet)this.dbVersion;
  }
  
  /**
   * take a snapshot of the data since this is what is in the db
   */
  @Override
  public void dbVersionReset() {
    //lets get the state from the db so we know what has changed
    this.dbVersion = GrouperUtil.clone(this, DB_VERSION_FIELDS);
  }


  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#dbVersionDifferentFields()
   */
  @Override
  public Set&lt;String&gt; dbVersionDifferentFields() {
    if (this.dbVersion == null) {
      throw new RuntimeException(&quot;State was never stored from db&quot;);
    }
    //easier to unit test if everything is ordered
    Set&lt;String&gt; result = GrouperUtil.compareObjectFields(this, this.dbVersion,
        DB_VERSION_FIELDS, null);
    return result;
  }
  
  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#onPreDelete(edu.internet2.middleware.grouper.hibernate.HibernateSession)
   */
  @Override
  public void onPreDelete(HibernateSession hibernateSession) {
    super.onPreDelete(hibernateSession);

    if (this.isActive()) {
      throw new RuntimeException(&quot;Cannot delete active point in time action set object with id=&quot; + this.getId());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L152">152</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L319">319</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            ruleDefinition.getAttributeAssignType().getOwnerAttributeDefId(), false, true);
        
        int daysFrom = GrouperUtil.intValue(ruleDefinition.getCheck().getCheckArg0(), -1); 
        int daysTo = GrouperUtil.intValue(ruleDefinition.getCheck().getCheckArg1(), -1); 
        
        Timestamp disabledFrom = daysFrom &lt; 0 ? null : 
          new Timestamp(System.currentTimeMillis() + daysFrom * 24 * 60 * 60 * 1000);
        Timestamp disabledTo = daysTo &lt; 0 ? null : 
          new Timestamp(System.currentTimeMillis() + daysTo * 24 * 60 * 60 * 1000);
        
        //lets get the memberships that are of issue.  Note, if someone has
        //two memberships which are both eligible, there will be both returned...
        //probably rare but should fix at some point
        Set&lt;PermissionEntry&gt; permissionEntries = GrouperDAOFactory.getFactory().getPermissionEntry()</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L2328">2328</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L2404">2404</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>            String thisAttributeDefId = ruleDefinition.getAttributeAssignType().getOwnerAttributeDefId();
            
            Group group = null;
            if (!StringUtils.isBlank(ruleDefinition.getCheck().getCheckOwnerId())) {
              group = GroupFinder.findByUuid(rootSession, ruleDefinition.getCheck().getCheckOwnerId(), false);
            } else if (!StringUtils.isBlank(ruleDefinition.getCheck().getCheckOwnerName())) {
              group = GroupFinder.findByName(rootSession, ruleDefinition.getCheck().getCheckOwnerName(), false);
            }

            if (group == null) {
              throw new RuntimeException(&quot;Group doesnt exist in rule! &quot; + ruleDefinition);
            }

            //find the members which apply
            Set&lt;PermissionEntry&gt; permissionEntries = GrouperDAOFactory</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\audit\AuditEntry.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditEntry.html#L1250">1250</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\audit\AuditType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/audit/AuditType.html#L894">894</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public boolean xmlDifferentUpdateProperties(AuditEntry other) {
    if (!StringUtils.equals(this.contextId, other.contextId)) {
      return true;
    }
    if (!GrouperUtil.equals(this.createdOnDb, other.createdOnDb)) {
      return true;
    }
    if (!GrouperUtil.equals(this.getHibernateVersionNumber(), other.getHibernateVersionNumber())) {
      return true;
    }
    if (!GrouperUtil.equals(this.lastUpdatedDb, other.lastUpdatedDb)) {
      return true;
    }
    return false;
  }

  /**
   * @see edu.internet2.middleware.grouper.xml.export.XmlImportableBase#xmlGetId()
   */
  public String xmlGetId() {
    return this.getId();
  }

  /**
   * @see edu.internet2.middleware.grouper.xml.export.XmlImportableBase#xmlSaveBusinessProperties(java.lang.Object)
   */
  public AuditEntry xmlSaveBusinessProperties(AuditEntry existingRecord) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\finder\PITAttributeDefFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/finder/PITAttributeDefFinder.html#L145">145</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\finder\PITAttributeDefFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/finder/PITAttributeDefFinder.html#L185">185</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    Set&lt;PITAttributeDef&gt; pitAttributeDefs = findByName(name, exceptionIfNotFound, orderByStartTime);
    Set&lt;PITAttributeDef&gt; pitAttributeDefsInRange = new LinkedHashSet&lt;PITAttributeDef&gt;();

    for (PITAttributeDef pitAttributeDef : pitAttributeDefs) {
      if (pointInTimeFrom != null) {
        if (!pitAttributeDef.isActive() &amp;&amp; pitAttributeDef.getEndTime().before(pointInTimeFrom)) {
          continue;
        }
      }
      
      if (pointInTimeTo != null) {
        if (pitAttributeDef.getStartTime().after(pointInTimeTo)) {
          continue;
        }
      }
      
      pitAttributeDefsInRange.add(pitAttributeDef);
    }
    
    if (pitAttributeDefsInRange.size() == 0) {
      if (exceptionIfNotFound) {
        throw new AttributeDefNotFoundException(&quot;Point in time attribute def with name &quot; + name + &quot; does not exist in the given date range.&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\finder\PITAttributeDefNameFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/finder/PITAttributeDefNameFinder.html#L145">145</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\finder\PITAttributeDefNameFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/finder/PITAttributeDefNameFinder.html#L185">185</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    Set&lt;PITAttributeDefName&gt; pitAttributeDefNames = findByName(name, exceptionIfNotFound, orderByStartTime);
    Set&lt;PITAttributeDefName&gt; pitAttributeDefNamesInRange = new LinkedHashSet&lt;PITAttributeDefName&gt;();

    for (PITAttributeDefName pitAttributeDefName : pitAttributeDefNames) {
      if (pointInTimeFrom != null) {
        if (!pitAttributeDefName.isActive() &amp;&amp; pitAttributeDefName.getEndTime().before(pointInTimeFrom)) {
          continue;
        }
      }
      
      if (pointInTimeTo != null) {
        if (pitAttributeDefName.getStartTime().after(pointInTimeTo)) {
          continue;
        }
      }
      
      pitAttributeDefNamesInRange.add(pitAttributeDefName);
    }
    
    if (pitAttributeDefNamesInRange.size() == 0) {
      if (exceptionIfNotFound) {
        throw new AttributeDefNameNotFoundException(&quot;Point in time attribute def name with name &quot; + name + &quot; does not exist in the given date range.&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\pit\finder\PITGroupFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/finder/PITGroupFinder.html#L164">164</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\finder\PITGroupFinder.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/finder/PITGroupFinder.html#L204">204</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    Set&lt;PITGroup&gt; pitGroups = findByName(name, exceptionIfNotFound, orderByStartTime);
    Set&lt;PITGroup&gt; pitGroupsInRange = new LinkedHashSet&lt;PITGroup&gt;();

    for (PITGroup pitGroup : pitGroups) {
      if (pointInTimeFrom != null) {
        if (!pitGroup.isActive() &amp;&amp; pitGroup.getEndTime().before(pointInTimeFrom)) {
          continue;
        }
      }
      
      if (pointInTimeTo != null) {
        if (pitGroup.getStartTime().after(pointInTimeTo)) {
          continue;
        }
      }
      
      pitGroupsInRange.add(pitGroup);
    }
    
    if (pitGroupsInRange.size() == 0) {
      if (exceptionIfNotFound) {
        throw new GroupNotFoundException(&quot;Point in time group with name &quot; + name + &quot; does not exist in the given date range.&quot;);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\beans\RulesMembershipBean.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/beans/RulesMembershipBean.html#L163">163</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\beans\RulesPrivilegeBean.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/beans/RulesPrivilegeBean.html#L224">224</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      result.append(&quot;membership: &quot;).append(this.membership.toString()).append(&quot;, &quot;);
    }
    if (this.subject != null) {
      result.append(&quot;subject: &quot;).append(GrouperUtil.subjectToString(this.subject)).append(&quot;, &quot;);
    }
    if (this.member != null) {
      result.append(&quot;member: &quot;).append(this.member).append(&quot;, &quot;);
    }
    return result.toString();
  }

  /**
   * @see edu.internet2.middleware.grouper.rules.beans.RulesBean#getStem()
   */
  @Override
  public Stem getStem() {
    if (this.stem == null) {
      Group theGroup = this.getGroup();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleElUtils.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleElUtils.html#L189">189</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleThenEnum.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleThenEnum.html#L217">217</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    RuntimeException runtimeException = null;
    
    boolean result = false;
    
    //first assign disabled dates on individual assignments
    for (PermissionEntry permissionEntry : GrouperUtil.nonNull(permissionEntries)) {
      if (permissionEntry.isImmediatePermission() &amp;&amp; permissionEntry.getPermissionType() == PermissionType.role_subject) {
        
        try {
          Role role = GroupFinder.findByUuid(GrouperSession.staticGrouperSession(), permissionEntry.getRoleId(), true);
          
          //get this once
          if (member == null) {
            member = MemberFinder.findByUuid(GrouperSession.staticGrouperSession(), permissionEntry.getMemberId(), true);
          }
          
          AttributeDefName attributeDefName = AttributeDefNameFinder.findById(permissionEntry.getAttributeDefNameId(), true);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\userData\GrouperUserDataApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/userData/GrouperUserDataApi.html#L410">410</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\userData\GrouperUserDataApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/userData/GrouperUserDataApi.html#L849">849</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public static void favoriteGroupAdd(final String userDataGroupName, final Subject subjectToAddTo, final Group group) {
    
    GrouperSession.callbackGrouperSession(
        GrouperSession.staticGrouperSession().internal_getRootSession(), new GrouperSessionHandler() {
      
      @Override
      public Object callback(GrouperSession grouperSession) throws GrouperSessionException {
        if (group == null) {
          throw new NullPointerException(&quot;Why is group null?&quot;);
        }
        
        //check security
        if (!group.canHavePrivilege(subjectToAddTo, AccessPrivilege.VIEW.getName(), false)) {
          throw new InsufficientPrivilegeException(&quot;Subject: &quot; + GrouperUtil.subjectToString(subjectToAddTo) 
              + &quot; does not have view on group &quot; + group.getName());
        }
        
        GrouperUserDataType.favoriteGroup.add(userDataGroupName, subjectToAddTo, group.getUuid());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L3450">3450</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L11159">11159</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  public static void methodsHelper(Class&lt;?&gt; theClass, Class&lt;?&gt; superclassToStopAt,
      boolean includeSuperclassToStopAt,
      boolean includeStaticMethods, Class&lt;? extends Annotation&gt; markerAnnotation,
      boolean includeAnnotation, Set&lt;Method&gt; methodSet) {
    theClass = unenhanceClass(theClass);
    Method[] methods = theClass.getDeclaredMethods();
    if (length(methods) != 0) {
      for (Method method : methods) {
        // if not static, then continue
        if (!includeStaticMethods
            &amp;&amp; Modifier.isStatic(method.getModifiers())) {
          continue;
        }
        // if checking for annotation
        if (markerAnnotation != null
            &amp;&amp; (includeAnnotation != method
                .isAnnotationPresent(markerAnnotation))) {
          continue;
        }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\gsh\addMember.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/gsh/addMember.html#L82">82</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\gsh\delMember.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/gsh/delMember.html#L82">82</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      GrouperShell.error(i, eMA);
    }
    catch (SubjectNotFoundException eSNF)       {
      GrouperShell.error(i, eSNF); 
    }
    catch (SubjectNotUniqueException eSNU)      {
      GrouperShell.error(i, eSNU); 
    }
    return false;
  } // public static boolean invoke(i, stack, group, subjId)

  /**
   * Add a member.
   * &lt;p/&gt;
   * @param   i           BeanShell interpreter.
   * @param   stack       BeanShell call stack.
   * @param   group       Add {@link Member} to {@link Group} with this name.
   * @param   subjId      Add {@link Subject} with this &lt;i&gt;subject id&lt;/i&gt; as a member.
   * @param   field
   * @return  True if succeeds.
   * @throws  GrouperShellException
   * @since   0.0.1
   */
  public static boolean invoke(
    Interpreter i, CallStack stack, String group, String subjId, Field field
  ) 
    throws  GrouperShellException
  {
    GrouperShell.setOurCommand(i, true);
    try {
      GrouperSession  s     = GrouperShell.getSession(i);
      Group           g     = GroupFinder.findByName(s, group, true);
      Subject         subj  = SubjectFinder.findByIdOrIdentifier(subjId, true);
      g.addMember(subj, field);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L138">138</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L189">189</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      return;
    }
    try {
      GrouperTransactionType grouperTransactionTypeToUse = 
        (GrouperTransactionType)ObjectUtils.defaultIfNull(this.grouperTransactionType, 
            GrouperTransactionType.READ_WRITE_OR_USE_EXISTING);
      
      HibernateSession.callbackHibernateSession(
          grouperTransactionTypeToUse, AuditControl.WILL_NOT_AUDIT,
          new HibernateHandler() {
  
            public Object callback(HibernateHandlerBean hibernateHandlerBean)
                throws GrouperDAOException {
              HibernateSession hibernateSession = hibernateHandlerBean.getHibernateSession();
              
              GrouperUtil.assertion(ByObjectStatic.this.cacheable == null, &quot;Cant set cacheable here&quot;);
              GrouperUtil.assertion(ByObjectStatic.this.cacheRegion == null, &quot;Cant set cacheRegion here&quot;);
              
              ByObject byObject = hibernateSession.byObject();
              ByObjectStatic.this.copyFieldsTo(byObject);
              byObject.update(collection);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L296">296</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L347">347</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      return;
    }
    try {
      GrouperTransactionType grouperTransactionTypeToUse = 
        (GrouperTransactionType)ObjectUtils.defaultIfNull(this.grouperTransactionType, 
            GrouperTransactionType.READ_WRITE_OR_USE_EXISTING);
      
      HibernateSession.callbackHibernateSession(
          grouperTransactionTypeToUse, AuditControl.WILL_NOT_AUDIT,
          new HibernateHandler() {
  
            public Object callback(HibernateHandlerBean hibernateHandlerBean)
                throws GrouperDAOException {
              HibernateSession hibernateSession = hibernateHandlerBean.getHibernateSession();
              
              GrouperUtil.assertion(ByObjectStatic.this.cacheable == null, &quot;Cant set cacheable here&quot;);
              GrouperUtil.assertion(ByObjectStatic.this.cacheRegion == null, &quot;Cant set cacheRegion here&quot;);
              
              ByObject byObject = hibernateSession.byObject();
              ByObjectStatic.this.copyFieldsTo(byObject);
              byObject.saveOrUpdate(collection);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L570">570</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L636">636</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      return;
    }
    try {
      GrouperTransactionType grouperTransactionTypeToUse = 
        (GrouperTransactionType)ObjectUtils.defaultIfNull(this.grouperTransactionType, 
            GrouperTransactionType.READ_WRITE_OR_USE_EXISTING);
      
      HibernateSession.callbackHibernateSession(
          grouperTransactionTypeToUse, AuditControl.WILL_NOT_AUDIT,
          new HibernateHandler() {
  
            public Object callback(HibernateHandlerBean hibernateHandlerBean)
                throws GrouperDAOException {
              HibernateSession hibernateSession = hibernateHandlerBean.getHibernateSession();
              
              GrouperUtil.assertion(ByObjectStatic.this.cacheable == null, &quot;Cant set cacheable here&quot;);
              GrouperUtil.assertion(ByObjectStatic.this.cacheRegion == null, &quot;Cant set cacheRegion here&quot;);
              
              ByObject byObject = hibernateSession.byObject();
              ByObjectStatic.this.copyFieldsTo(byObject);
              byObject.delete(collection);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L994">994</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3925">3925</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>                  null, null, false, false, false, null, null, false, false, false, null);
              
              //lets sort these by member
              Set&lt;Object[]&gt; sortedResults = new LinkedHashSet&lt;Object[]&gt;();
              
              for (Member member : members) {
                Iterator&lt;Object[]&gt; iterator = tempResults.iterator();
                while(iterator.hasNext()) {
                  
                  Object[] tempResult = iterator.next();
                  //if the member is the same, put it in the sortedResults, and remove
                  if (StringUtils.equals(((Member)tempResult[2]).getUuid(), member.getUuid())) {
                    
                    sortedResults.add(tempResult);
                    iterator.remove();
                    
                  }
                }
              }
              return sortedResults;
              
            }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L87">87</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L319">319</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      .getAttributeDelegate().addAttribute(RuleUtils.ruleAttributeDefName()).getAttributeAssign();
  
    AttributeValueDelegate attributeValueDelegate = attributeAssign.getAttributeValueDelegate();
    
    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectSourceIdName(), actAs.getSourceId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectIdName(), actAs.getId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckTypeName(), RuleCheckType.attributeDefCreate.name());
    
    //can be SUB or ONE for if in this folder, or in this and all subfolders
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckStemScopeName(), stemScope.name());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleThenEnumName(), RuleThenEnum.reassignAttributeDefPrivilegesIfFromGroup.name());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L374">374</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L1289">1289</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      .getAttributeDelegate().addAttribute(RuleUtils.ruleAttributeDefName()).getAttributeAssign();
    
    AttributeValueDelegate attributeValueDelegate = attributeAssign.getAttributeValueDelegate();
  
    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectSourceIdName(), actAs.getSourceId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectIdName(), actAs.getId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckTypeName(), RuleCheckType.stemCreate.name());
    
    //can be SUB or ONE for if should be in all descendants or just on children
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckStemScopeName(), stemScope.name());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleThenEnumName(), RuleThenEnum.assignStemPrivilegeToStemId.name());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L560">560</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L607">607</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L775">775</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleApi.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleApi.html#L821">821</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      .getAttributeDelegate().addAttribute(RuleUtils.ruleAttributeDefName()).getAttributeAssign();

    AttributeValueDelegate attributeValueDelegate = attributeAssign.getAttributeValueDelegate();

    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectSourceIdName(), actAs.getSourceId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleActAsSubjectIdName(), actAs.getId());
    
    //note &quot;mustBeInGroup&quot; is the group (e.g. employees)
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckOwnerIdName(), mustBeInGroup.getId());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleCheckTypeName(),
        RuleCheckType.membershipRemove.name());
    attributeValueDelegate.assignValue(
        RuleUtils.ruleIfConditionEnumName(),
        RuleIfConditionEnum.thisGroupHasImmediateEnabledMembership.name());</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GenerateFieldConstants.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GenerateFieldConstants.html#L86">86</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GenerateFieldConstants.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GenerateFieldConstants.html#L116">116</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      System.out.print(&quot;  private static final Set&lt;String&gt; DB_VERSION_FIELDS = GrouperUtil.toSet(\n      &quot;);
      
      for (int i=0;i&lt;fieldNames.size();i++) {
        System.out.print(&quot;FIELD_&quot; + GrouperUtil.oracleStandardNameFromJava(fieldNames.get(i)));
        if (i!=fieldNames.size()-1) {
          System.out.print(&quot;, &quot;);

          //put a newline every once and a while
          if ((i+1) % 4 == 0) {
            System.out.print(&quot;\n      &quot;);
          }
        } else {
          //else end it
          System.out.println(&quot;);&quot;);
        }
      }
      System.out.print(&quot;\n&quot;);
      
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\loader\db\GrouperLoaderDb.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/db/GrouperLoaderDb.html#L69">69</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\loader\ldap\GrouperLoaderLdapServer.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/loader/ldap/GrouperLoaderLdapServer.html#L436">436</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }
  
  /**
   * user to login to db
   * @return the user
   */
  public String getUser() {
    return this.user;
  }

  
  /**
   * user to login to db
   * @param user1 the user to set
   */
  public void setUser(String user1) {
    this.user = user1;
  }

  
  /**
   * pass to login to db
   * @return the pass
   */
  public String getPass() {
    return this.pass;
  }

  
  /**
   * pass to login to db
   * @param pass1 the pass to set
   */
  public void setPass(String pass1) {
    this.pass = pass1;
  }

  
  /**
   * url of the db to login to
   * @return the url
   */
  public String getUrl() {
    return this.url;
  }

  
  /**
   * url of the db to login to
   * @param url1 the url to set
   */
  public void setUrl(String url1) {
    this.url = url1;
  }

  
  /**
   * db driver to use to login
   * @return the driver
   */
  public String getDriver() {
    return this.driver;
  }

  
  /**
   * db driver to use to login
   * @param driver1 the driver to set
   */
  public void setDriver(String driver1) {
    this.driver = driver1;
  }

  /**
   * empty constructor
   */
  public GrouperLoaderDb() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\attr\assign\AttributeAssignAction.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/attr/assign/AttributeAssignAction.html#L678">678</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\pit\PITAttributeAssign.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/pit/PITAttributeAssign.html#L571">571</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    return (AttributeAssignAction)this.dbVersion;
  }
  
  /**
   * take a snapshot of the data since this is what is in the db
   */
  @Override
  public void dbVersionReset() {
    //lets get the state from the db so we know what has changed
    this.dbVersion = GrouperUtil.clone(this, DB_VERSION_FIELDS);
  }


  /**
   * @see edu.internet2.middleware.grouper.GrouperAPI#dbVersionDifferentFields()
   */
  @Override
  public Set&lt;String&gt; dbVersionDifferentFields() {
    if (this.dbVersion == null) {
      throw new RuntimeException(&quot;State was never stored from db&quot;);
    }
    //easier to unit test if everything is ordered
    Set&lt;String&gt; result = GrouperUtil.compareObjectFields(this, this.dbVersion,
        DB_VERSION_FIELDS, null);
    return result;
  }

  /**
   * 
   * @see java.lang.Object#equals(java.lang.Object)
   */
  @Override
  public boolean equals(Object other) {
    if (this == other) {
      return true;
    }
    if (!(other instanceof AttributeAssignAction)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\filter\GroupNameFilter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/filter/GroupNameFilter.html#L154">154</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\filter\StemNameAnyFilter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/filter/StemNameAnyFilter.html#L125">125</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\filter\StemsInStemFilter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/filter/StemsInStemFilter.html#L156">156</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  } // public Set getResults(s)


  /**
   * true or null for ascending, false for descending.  If you pass true or false, must pass a sort string
   * @return the ascending
   */
  public Boolean getAscending() {
    return this.ascending;
  }


  /**
   * page number 1 indexed if paging
   * @return the pageNumber
   */
  public Integer getPageNumber() {
    return this.pageNumber;
  }


  /**
   * page size if paging
   * @return the pageSize
   */
  public Integer getPageSize() {
    return this.pageSize;
  }


  /**
   * must be an hql query field, e.g. can sort on name, displayName, extension, displayExtension
   * @return the sortString
   */
  public String getSortString() {
    return this.sortString;
  }


  /**
   * true or null for ascending, false for descending.  If you pass true or false, must pass a sort string
   * @param ascending1 the ascending to set
   */
  public void setAscending(Boolean ascending1) {
    this.ascending = ascending1;
  }


  /**
   * page number 1 indexed if paging
   * @param pageNumber1 the pageNumber to set
   */
  public void setPageNumber(Integer pageNumber1) {
    this.pageNumber = pageNumber1;
  }


  /**
   * page size if paging
   * @param pageSize1 the pageSize to set
   */
  public void setPageSize(Integer pageSize1) {
    this.pageSize = pageSize1;
  }


  /**
   * must be an hql query field, e.g. can sort on name, displayName, extension, displayExtension
   * @param sortString1 the sortString to set
   */
  public void setSortString(String sortString1) {
    this.sortString = sortString1;
  }

}</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2012">2012</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3242">3242</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        sqlTables, &quot;aa.ownerGroupId&quot;, AccessPrivilege.ATTRIBUTE_READ_PRIVILEGES);
  
    StringBuilder sql;
    if (changedQuery) {
      sqlTables.append(&quot; and &quot;);
    } else {
      sqlTables.append(&quot; where &quot;);
    }
    sql = sqlTables.append(sqlWhereClause);
    
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Membership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Membership.html#L2865">2865</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\Membership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Membership.html#L2878">2878</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\Membership.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/Membership.html#L2891">2891</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          ChangeLogLabels.PRIVILEGE_ADD.privilegeName.name(), AccessPrivilege.listToPriv(this.getField().getName()).getName(), 
          ChangeLogLabels.PRIVILEGE_ADD.fieldId.name(), this.getFieldId(), 
          ChangeLogLabels.PRIVILEGE_ADD.memberId.name(), this.getMemberUuid(),
          ChangeLogLabels.PRIVILEGE_ADD.subjectId.name(), this.getMember().getSubjectId(),
          ChangeLogLabels.PRIVILEGE_ADD.sourceId.name(), this.getMember().getSubjectSourceId(),
          ChangeLogLabels.PRIVILEGE_ADD.privilegeType.name(), FieldType.ACCESS.getType(),</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L568">568</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAttrDefAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAttrDefAdapter.html#L484">484</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>       debugLog.put(&quot;groupName&quot;, group.getName());
       if (GrouperUtil.length(privileges) &gt; 0) {
         debugLog.put(&quot;privileges&quot;, GrouperUtil.collectionToString(privileges));
       }
       if (membershipType != null) {
         debugLog.put(&quot;membershipType&quot;, membershipType.name());
       }
       debugLog.put(&quot;additionalMembersSize&quot;, GrouperUtil.length(additionalMembers));
       if (queryPaging != null) {
         debugLog.put(&quot;queryPaging&quot;, queryPaging);
       }
    }
    Exception exception = null;
    try {
      //note, no need for GrouperSession inverse of control
      GrouperSession.validate(grouperSession);
  
      ///check privs
      if (!grouperSession.getMember().hasAdmin(group)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeDef.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeDef.html#L566">566</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportAttributeDefName.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportAttributeDefName.html#L260">260</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\xml\export\XmlExportGroup.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/xml/export/XmlExportGroup.html#L317">317</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * extension
   * @return extension
   */
  public String getExtension() {
    return this.extension;
  }

  /**
   * extension
   * @param extension1
   */
  public void setExtension(String extension1) {
    this.extension = extension1;
  }

  /**
   * description
   * @return description
   */
  public String getDescription() {
    return this.description;
  }

  /**
   * description
   * @param description1
   */
  public void setDescription(String description1) {
    this.description = description1;
  }

  /**
   * hibernateVersionNumber
   * @return hibernateVersionNumber
   */
  public long getHibernateVersionNumber() {
    return this.hibernateVersionNumber;
  }

  /**
   * hibernateVersionNumber
   * @param hibernateVersionNumber1
   */
  public void setHibernateVersionNumber(long hibernateVersionNumber1) {
    this.hibernateVersionNumber = hibernateVersionNumber1;
  }

  /**
   * contextId
   * @return contextId
   */
  public String getContextId() {
    return this.contextId;
  }

  /**
   * contextId
   * @param contextId1
   */
  public void setContextId(String contextId1) {
    this.contextId = contextId1;
  }
  
  /**
   * convert to attributeDef
   * @return the attributeDef
   */
  public AttributeDef toAttributeDef() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\gsh\addMember.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/gsh/addMember.html#L82">82</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\app\gsh\delMember.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/gsh/delMember.html#L82">82</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\app\gsh\hasMember.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/app/gsh/hasMember.html#L73">73</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      GrouperShell.error(i, eMA);
    }
    catch (SubjectNotFoundException eSNF)       {
      GrouperShell.error(i, eSNF); 
    }
    catch (SubjectNotUniqueException eSNU)      {
      GrouperShell.error(i, eSNU); 
    }
    return false;
  } // public static boolean invoke(i, stack, group, subjId)

  /**
   * Add a member.
   * &lt;p/&gt;
   * @param   i           BeanShell interpreter.
   * @param   stack       BeanShell call stack.
   * @param   group       Add {@link Member} to {@link Group} with this name.
   * @param   subjId      Add {@link Subject} with this &lt;i&gt;subject id&lt;/i&gt; as a member.
   * @param   field
   * @return  True if succeeds.
   * @throws  GrouperShellException
   * @since   0.0.1
   */
  public static boolean invoke(
    Interpreter i, CallStack stack, String group, String subjId, Field field
  ) 
    throws  GrouperShellException
  {
    GrouperShell.setOurCommand(i, true);
    try {
      GrouperSession  s     = GrouperShell.getSession(i);
      Group           g     = GroupFinder.findByName(s, group, true);
      Subject         subj  = SubjectFinder.findByIdOrIdentifier(subjId, true);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\filter\GroupNameFilter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/filter/GroupNameFilter.html#L154">154</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\filter\GroupsInStemFilter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/filter/GroupsInStemFilter.html#L166">166</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\filter\StemNameAnyFilter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/filter/StemNameAnyFilter.html#L125">125</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\filter\StemsInStemFilter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/filter/StemsInStemFilter.html#L156">156</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  } // public Set getResults(s)


  /**
   * true or null for ascending, false for descending.  If you pass true or false, must pass a sort string
   * @return the ascending
   */
  public Boolean getAscending() {
    return this.ascending;
  }


  /**
   * page number 1 indexed if paging
   * @return the pageNumber
   */
  public Integer getPageNumber() {
    return this.pageNumber;
  }


  /**
   * page size if paging
   * @return the pageSize
   */
  public Integer getPageSize() {
    return this.pageSize;
  }


  /**
   * must be an hql query field, e.g. can sort on name, displayName, extension, displayExtension
   * @return the sortString
   */
  public String getSortString() {
    return this.sortString;
  }


  /**
   * true or null for ascending, false for descending.  If you pass true or false, must pass a sort string
   * @param ascending1 the ascending to set
   */
  public void setAscending(Boolean ascending1) {
    this.ascending = ascending1;
  }


  /**
   * page number 1 indexed if paging
   * @param pageNumber1 the pageNumber to set
   */
  public void setPageNumber(Integer pageNumber1) {
    this.pageNumber = pageNumber1;
  }


  /**
   * page size if paging
   * @param pageSize1 the pageSize to set
   */
  public void setPageSize(Integer pageSize1) {
    this.pageSize = pageSize1;
  }


  /**
   * must be an hql query field, e.g. can sort on name, displayName, extension, displayExtension
   * @param sortString1 the sortString to set
   */
  public void setSortString(String sortString1) {
    this.sortString = sortString1;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L138">138</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L347">347</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L636">636</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      return;
    }
    try {
      GrouperTransactionType grouperTransactionTypeToUse = 
        (GrouperTransactionType)ObjectUtils.defaultIfNull(this.grouperTransactionType, 
            GrouperTransactionType.READ_WRITE_OR_USE_EXISTING);
      
      HibernateSession.callbackHibernateSession(
          grouperTransactionTypeToUse, AuditControl.WILL_NOT_AUDIT,
          new HibernateHandler() {
  
            public Object callback(HibernateHandlerBean hibernateHandlerBean)
                throws GrouperDAOException {
              HibernateSession hibernateSession = hibernateHandlerBean.getHibernateSession();
              
              GrouperUtil.assertion(ByObjectStatic.this.cacheable == null, &quot;Cant set cacheable here&quot;);
              GrouperUtil.assertion(ByObjectStatic.this.cacheRegion == null, &quot;Cant set cacheRegion here&quot;);
              
              ByObject byObject = hibernateSession.byObject();
              ByObjectStatic.this.copyFieldsTo(byObject);
              byObject.update(collection);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L189">189</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L296">296</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L403">403</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\hibernate\ByObjectStatic.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/hibernate/ByObjectStatic.html#L570">570</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      return;
    }
    try {
      GrouperTransactionType grouperTransactionTypeToUse = 
        (GrouperTransactionType)ObjectUtils.defaultIfNull(this.grouperTransactionType, 
            GrouperTransactionType.READ_WRITE_OR_USE_EXISTING);
      
      HibernateSession.callbackHibernateSession(
          grouperTransactionTypeToUse, AuditControl.WILL_NOT_AUDIT,
          new HibernateHandler() {
  
            public Object callback(HibernateHandlerBean hibernateHandlerBean)
                throws GrouperDAOException {
              HibernateSession hibernateSession = hibernateHandlerBean.getHibernateSession();
              
              GrouperUtil.assertion(ByObjectStatic.this.cacheable == null, 
                  &quot;Cant set cacheable here&quot;);
              GrouperUtil.assertion(ByObjectStatic.this.cacheRegion == null, 
                  &quot;Cant set cacheRegion here&quot;);
              
              ByObject byObject = hibernateSession.byObject();
              ByObjectStatic.this.copyFieldsTo(byObject);
              byObject.update(object);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1413">1413</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L1581">1581</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2022">2022</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2173">2173</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2303">2303</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2573">2573</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2704">2704</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2822">2822</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {
      sql.append(&quot; and adn.attributeDefId = aaa.attributeDefId and aaa.nameDb in (&quot;);
      sql.append(HibUtils.convertToInClause(actions, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (attributeDefAssignToIdsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3029">3029</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3077">3077</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic()
        .setCacheable(true)
        .setCacheRegion(KLASS)
        .setString(&quot;owner&quot;, attributeDefId)
        .options(queryOptions);

      HibUtils.convertFieldsToSqlInString(fields, byHqlStatic, sql, &quot;ms.fieldId&quot;);
      HibUtils.convertSourcesToSqlInString(sources, byHqlStatic, sql, &quot;m.subjectSourceIdDb&quot;);
      
      if (membershipType != null) {
        sql.append(&quot;and  ms.type &quot;).append(membershipType.queryClause());
      }
      
      if (enabled != null) {
        sql.append(&quot; and ms.enabledDb = '&quot; + (enabled ? 'T' : 'F') + &quot;'&quot;);
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3121">3121</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3MembershipDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3MembershipDAO.html#L3176">3176</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    ByHqlStatic byHqlStatic = HibernateSession.byHqlStatic()
      .setCacheable(true)
      .setCacheRegion(KLASS)
      .setString(&quot;owner&quot;, groupId)
      .options(queryOptions);
  
    HibUtils.convertFieldsToSqlInString(fields, byHqlStatic, sql, &quot;ms.fieldId&quot;);
    HibUtils.convertSourcesToSqlInString(sources, byHqlStatic, sql, &quot;m.subjectSourceIdDb&quot;);
    
    if (membershipType != null) {
      sql.append(&quot;and  ms.type &quot;).append(membershipType.queryClause());
    }
    
    if (enabled != null) {
      sql.append(&quot; and ms.enabledDb = '&quot; + (enabled ? 'T' : 'F') + &quot;'&quot;);
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L234">234</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L518">518</a></td></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L640">640</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1497">1497</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  membershipDisabledDate {

    /**
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#checkKey(edu.internet2.middleware.grouper.rules.RuleDefinition)
     */
    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      RuleCheck ruleCheck = ruleDefinition.getCheck();
      if (StringUtils.isBlank(ruleCheck.getCheckOwnerId()) &amp;&amp; StringUtils.isBlank(ruleCheck.getCheckOwnerName())) {
        //if this is assigned to a group
        if (!StringUtils.isBlank(ruleDefinition.getAttributeAssignType().getOwnerGroupId())) {

          //clone so we dont edit the object
          ruleCheck = ruleCheck.clone();
          //set the owner to this group
          ruleCheck.setCheckOwnerId(ruleDefinition.getAttributeAssignType().getOwnerGroupId());
        } else {
          LOG.error(&quot;Not sure why no check owner if not assigned to group&quot;);
        }
      }
      return ruleCheck;
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#addElVariables(edu.internet2.middleware.grouper.rules.RuleDefinition, java.util.Map, edu.internet2.middleware.grouper.rules.beans.RulesBean, boolean)
     */
    @Override
    public void addElVariables(RuleDefinition ruleDefinition,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L2293">2293</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\internal\dao\hib3\Hib3AttributeAssignDAO.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/internal/dao/hib3/Hib3AttributeAssignDAO.html#L3242">3242</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        sqlTables, &quot;ime.ownerGroupId&quot;, AccessPrivilege.READ_PRIVILEGES);
  
    StringBuilder sql;
    if (changedQuery) {
      sqlTables.append(&quot; and &quot;);
    } else {
      sqlTables.append(&quot; where &quot;);
    }
    sql = sqlTables.append(sqlWhereClause);
  
    if (enabled != null &amp;&amp; enabled) {
      sql.append(&quot; and aa.enabledDb = 'T' &quot;);
    }
    if (enabled != null &amp;&amp; !enabled) {
      sql.append(&quot; and aa.enabledDb = 'F' &quot;);
    }
    if (attributeAssignIdsSize &gt; 0) {
      sql.append(&quot; and aa.id in (&quot;);
      sql.append(HibUtils.convertToInClause(attributeAssignIds, byHqlStatic));
      sql.append(&quot;) &quot;);
    }
    if (actionsSize &gt; 0) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbAccessAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbAccessAdapter.html#L427">427</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\privs\GrouperNonDbNamingAdapter.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/privs/GrouperNonDbNamingAdapter.html#L371">371</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      PrivilegeHelper.dispatch(s, g, s.getSubject(), f.getWritePriv());
      
      Membership copiedMembership = existingMembership.clone();
      copiedMembership.setMemberUuid(member.getUuid());
      copiedMembership.setMember(member);
      copiedMembership.setCreatorUuid(s.getMemberUuid());
      copiedMembership.setCreateTimeLong(new Date().getTime());
      copiedMembership.setImmediateMembershipId(GrouperUuid.getUuid());
      copiedMembership.setHibernateVersionNumber(-1L);
      GrouperDAOFactory.getFactory().getMembership().save(copiedMembership);
    }
    
  }


  // public boolean hasPriv(s, g, subj, priv)
  
  /**
   * Revoke this privilege from everyone on this group.
   * &lt;pre class=&quot;eg&quot;&gt;
   * try {
   *   ap.revokePriv(s, g, AccessPrivilege.ADMIN);
   * }
   * catch (InsufficientPrivilegeException eIP) {
   *   // Not privileged to revoke the privilege
   * }
   * catch (RevokePrivilegeException eRP) {
   *   // Unable to revoke the privilege
   * }
   * &lt;/pre&gt;
   * @param   s     Revoke privilege in this session context.
   * @param   g     Revoke privilege on this group.
   * @param   priv  Revoke this privilege.   
   * @throws  InsufficientPrivilegeException
   * @throws  RevokePrivilegeException
   * @throws  SchemaException
   */
  public void revokePriv(GrouperSession s, Group g, Privilege priv)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L239">239</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\rules\RuleCheckType.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/rules/RuleCheckType.html#L1329">1329</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    @Override
    public RuleCheck checkKey(RuleDefinition ruleDefinition) {
      RuleCheck ruleCheck = ruleDefinition.getCheck();
      if (StringUtils.isBlank(ruleCheck.getCheckOwnerId()) &amp;&amp; StringUtils.isBlank(ruleCheck.getCheckOwnerName())) {
        //if this is assigned to a group
        if (!StringUtils.isBlank(ruleDefinition.getAttributeAssignType().getOwnerGroupId())) {

          //clone so we dont edit the object
          ruleCheck = ruleCheck.clone();
          //set the owner to this group
          ruleCheck.setCheckOwnerId(ruleDefinition.getAttributeAssignType().getOwnerGroupId());
        } else {
          LOG.error(&quot;Not sure why no check owner if not assigned to group&quot;);
        }
      }
      return ruleCheck;
    }

    /**
     * 
     * @see edu.internet2.middleware.grouper.rules.RuleCheckType#addElVariables(edu.internet2.middleware.grouper.rules.RuleDefinition, java.util.Map, edu.internet2.middleware.grouper.rules.beans.RulesBean, boolean)
     */
    @Override
    public void addElVariables(RuleDefinition ruleDefinition,</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>edu\internet2\middleware\grouper\util\GrouperUtil.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtil.html#L9352">9352</a></td></tr>
<tr class="b">
<td>edu\internet2\middleware\grouper\util\GrouperUtilElSafe.java</td>
<td><a href="./xref/edu/internet2/middleware/grouper/util/GrouperUtilElSafe.html#L6122">6122</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>  }

  /**
   * &lt;p&gt;Finds a &lt;code&gt;Throwable&lt;/code&gt; by field name.&lt;/p&gt;
   *
   * @param throwable  the exception to examine
   * @param fieldName  the name of the attribute to examine
   * @return the wrapped exception, or &lt;code&gt;null&lt;/code&gt; if not found
   */
  private static Throwable getCauseUsingFieldName(Throwable throwable, String fieldName) {
      Field field = null;
      try {
          field = throwable.getClass().getField(fieldName);
      } catch (NoSuchFieldException ignored) {
      } catch (SecurityException ignored) {
      }

      if (field != null &amp;&amp; Throwable.class.isAssignableFrom(field.getType())) {
          try {
              return (Throwable) field.get(throwable);
          } catch (IllegalAccessException ignored) {
          } catch (IllegalArgumentException ignored) {
          }
      }
      return null;
  }

  /**
   * &lt;p&gt;Finds a &lt;code&gt;Throwable&lt;/code&gt; for known types.&lt;/p&gt;
   *
   * &lt;p&gt;Uses &lt;code&gt;instanceof&lt;/code&gt; checks to examine the exception,
   * looking for well known types which could contain chained or
   * wrapped exceptions.&lt;/p&gt;
   *
   * @param throwable  the exception to examine
   * @return the wrapped exception, or &lt;code&gt;null&lt;/code&gt; if not found
   */
  private static Throwable getCauseUsingWellKnownTypes(Throwable throwable) {</pre></div></td></tr></table></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2014
                        <a href="http://www.internet2.edu/">Internet2</a>.
            All Rights Reserved.      
                    
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
