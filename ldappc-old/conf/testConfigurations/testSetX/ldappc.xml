<?xml version="1.0" encoding="utf-8"?>

<!-- 
    * See ldappcTemplate.xml for documentation regarding how to use these
    * elements
-->
<ldappc>
    <grouper><!-- 0 or 1 allowed -->
        <group-queries><!-- exactly 1 required -->

            <subordinate-stem-queries><!-- 0 or 1 allowed-->
                <stem-list><!-- exactly 1 required -->
                    <stem></stem><!-- 1 or more required -->
                </stem-list>
            </subordinate-stem-queries>

            <!-- 
            <attribute-matching-queries><!- - 0 or 1 allowed - ->
                <attribute-list><!- - exactly 1 required - ->
                    <attribute name="" value="" /><!- - 1 or more required - ->
                </attribute-list>
            </attribute-matching-queries>
             -->

        </group-queries>

        <groups structure="flat" root-dn="ou=testgrouper,dc=example,dc=edu" ldap-object-class="groupOfUniqueNames"
            ldap-rdn-attribute="cn" grouper-attribute="name"><!-- 0 or 1 allowed -->


            <!-- 
            <group-members-dn-list list-object-class="" list-attribute="" />
             -->
            <group-members-dn-list list-attribute="uniqueMember" list-empty-value="" /><!-- 0 or 1 allowed -->

            <group-members-name-list list-object-class="eduMember"
                list-attribute="hasMember"><!-- 0 or 1 allowed -->
                <source-subject-name-mapping><!-- Exactly 1 required -->
                    <source-subject-name-map source="qsuob"
                        subject-attribute="LOGINID" /><!-- 1 or more required -->
                    <source-subject-name-map source="g:gsa"
                        subject-attribute="name" /><!-- 1 or more required -->
                </source-subject-name-mapping>
            </group-members-name-list>

            <!-- 
            <group-attribute-mapping ldap-object-class=""><!- - 0 or 1 allowed - ->
                <group-attribute-map group-attribute=""
                    ldap-attribute="" /><!- - 1 or more required - ->
            </group-attribute-mapping>
             -->

        </groups>

        <memberships><!--  0 or 1 allowed -->

            <member-groups-list list-object-class="eduPerson" list-attribute="isMemberOf"
                naming-attribute="name" /><!-- exactly 1 required -->

        </memberships>

    </grouper>

    <signet><!-- 0 or 1 allowed -->

        <permissions-listing stored-as="string" 
            string-object-class="eduPerson"
            string-attribute="eduPersonEntitlement"
            string-prefix="urn:mace:uchicago.edu:permission" /><!-- Exactly 1 required -->

        <!-- 
        <permissions-queries><!- - 0 or 1 allowed - ->

            <subsystem-queries><!- - 0 or 1 allowed - ->
                <subsystem-list><!- - Exactly 1 required - ->
                    <subsystem id="" /><!- - 1 or more required - ->
                </subsystem-list>
            </subsystem-queries>

            <function-queries><!- - 0 or 1 allowed - ->
                <function-list><!- - Exactly 1 required - ->
                    <function id="" /><!- - 1 or more required - ->
                </function-list>
            </function-queries>

        </permissions-queries>
         -->

    </signet>

    <source-subject-identifiers><!-- exactly 1 required -->
        <!-- Next line is for standard built-in database:
        <source-subject-identifier source="qsuob" subject-attribute="LOGINID">
         -->
        <!-- Next line is for quickstart demo database: -->
        <source-subject-identifier source="jdbc" subject-attribute="LOGINID">
            <!-- 1 or more required -->
            <ldap-search base="dc=example,dc=edu" scope="subtree_scope" filter="(ou={0})" />
            <!-- exactly 1 required -->
        </source-subject-identifier>

        <!-- Next line is for standard built-in database:
        <source-subject-identifier source="signet" subject-attribute="LOGINID">
         -->
        <!-- Next line is for quickstart demo database: -->
        <source-subject-identifier source="local" subject-attribute="LOGINID">
            <!-- 1 or more required -->
            <ldap-search base="ou=testSignetSubjects,ou=testgrouper,dc=example,dc=edu" 
                    scope="subtree_scope" filter="(uid={0})" />
            <!-- exactly 1 required -->
        </source-subject-identifier>
    </source-subject-identifiers>

    <ldap><!-- Exactly 1 required -->
        <context><!-- Exactly 1 required -->
            <parameter-list><!-- 0 or 1 allowed -->
                <!-- 1 or more <parameter> elements are required within <parameter-list> -->
                <parameter name="initial_context_factory" value="com.sun.jndi.ldap.LdapCtxFactory" />
                <parameter name="provider_url" value="ldap://localhost:389" />
                <parameter name="security_authentication" value="simple" />
                <!-- Samples when not getting from ldappc.properties file: -->
                <!--
                <parameter name="security_principal" value="cn=manager, dc=sgif, dc=org" />
                <parameter name="security_credentials" value="xxx" />
                 -->
                <parameter name="security_principal" value="cn=manager,dc=example,dc=edu" />
                <parameter name="security_credentials" value="123" />
            </parameter-list>
        </context>
    </ldap>

</ldappc>
