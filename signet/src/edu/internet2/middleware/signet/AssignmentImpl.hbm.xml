<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 2.0//EN"
          "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd">
<hibernate-mapping>
	<class
		name="edu.internet2.middleware.signet.AssignmentImpl"
		table="Assignment"
		lazy="true">
		
		<meta attribute="class-description">
			@author Andy Cohen
		</meta>
		
<!--
		NOTE: The following ID declaration must be used on HSQL.
-->
		<id name="numericId" type="int" column="assignmentID">
			<generator class="native"/>
		</id>

<!-- 
		NOTE: The following ID declaration, while correct,
		fails on HSQL, which has no "numeric" datatype.
		
		FURTHER NOTE: TEST THIS SOMEHOW ON SYBASE, AND SEE IF THERE'S
		SOME WAY TO SPECIFY A DECIMAL PRECISION OF (12,0) WITHOUT
		FORCING THE DATATYPE TO NUMERIC, WHICH NOT EVERY DB SUPPORTS.
		<id name="numericId" type="big_decimal" unsaved-value="null"> 
       		<column name="assignmentID" sql-type="numeric(12,0)"/> 
       		<generator class="native"/> 
    	</id>
-->
    	
		<timestamp name="modifyDatetime"/>
		
		<property
			name="grantorId" column="grantorID"/>
		<property
			name="grantorTypeId" column="grantorTypeID"/>
		<property
			name="granteeId" column="granteeID" />
		<property
			name="granteeTypeId" column="granteeTypeID" />
			
<!--
		<many-to-one name="grantor" class="edu.internet2.middleware.signet.PrivilegedSubjectImpl" cascade="save-update" not-null="true">
			<column name="grantorID"/>
			<column name="grantorTypeID"/>
		</many-to-one>
		
		<many-to-one
			name="grantee"
			class="edu.internet2.middleware.signet.PrivilegedSubjectImpl"
			cascade="save-update"
			not-null="true">
			
			<column name="granteeID"/>
			<column name="granteeTypeID"/>
		</many-to-one>
-->
		
		<many-to-one
			name="function"
			class="edu.internet2.middleware.signet.FunctionImpl"
			cascade="save-update"
			not-null="true">
			
			<column name="subsystemID"/>
			<column name="functionID"/>
		</many-to-one>

		<many-to-one
			name="scope"
			class="edu.internet2.middleware.signet.TreeNodeImpl"
			cascade="save-update"
			not-null="true">
			
			<column name="scopeTreeID"/>
			<column name="scopeNodeID"/>
		</many-to-one>
		
		<property name="status" type="edu.internet2.middleware.signet.StatusType" not-null="true">
			<meta attribute="use-in-tostring">true</meta>
		</property>
		<property
			name="grantable"
			column="canGrant"
			type="boolean"
			not-null="true"/>
		<property
			name="grantOnly"
			type="boolean"
			not-null="true"/>
			
		<property name="effectiveDate" type="timestamp" not-null="true"/>
		<property name="createDatetime" type="timestamp" not-null="true"/>
		<property name="createDbAccount" type="string" not-null="true"/>
		<property name="createUserID" type="string" not-null="false"/>
		<property name="createContext" type="string" not-null="false"/>
		<property name="modifyDbAccount" type="string" not-null="true"/>
		<property name="modifyUserID" type="string" not-null="false"/>
		<property name="modifyContext" type="string" not-null="false"/>
		<property name="comment" type="string" not-null="false"/>
	</class>
</hibernate-mapping>
