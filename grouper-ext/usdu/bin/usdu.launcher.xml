<project name="Unresolvable Subject Deletion Utility"
         default="usdu"
         basedir=".">

	<!-- please be aware that available ant tasks are limited to Launcher.SUPPORTED_ANT_TASKS -->

	<property name="grouper.home" value="@GROUPER_HOME@" />
	<property name="grouper.conf" value="@GROUPER_CONF@" />
	<property name="grouper.ext" value="@GROUPER_EXT_LIB@" />
	<property name="grouper.lib" value="@GROUPER_HOME@/lib" />
	<property name="grouper.jar" value="${grouper.home}/dist/lib/grouper.jar" />

	<property environment="env" />

	<!-- base classpath -->
	<path id="base.path">
		<!-- preserve your classpath -->
		<pathelement path="${env.CLASSPATH}" />
		<!-- grouper conf directory -->
		<pathelement path="${grouper.conf}" />
		<!-- grouper 3rd party libraries -->
		<fileset dir="${grouper.lib}" includes="*.jar" />
		<!-- grouper extension libraries -->
		<fileset dir="${grouper.ext}" includes="*.jar" />
	</path>

	<!-- is grouper.jar present ?-->
	<available file="${grouper.jar}" property="grouper.jar.present" />

	<!-- if grouper.jar is present, use it -->
	<target name="classpath-jar" if="grouper.jar.present">
		<path id="usdu.classpath">
			<path refid="base.path" />
			<pathelement path="${grouper.jar}" />
		</path>
	</target>

	<!-- if grouper.jar is not present, use build classes -->
	<target name="classpath-classes" unless="grouper.jar.present">
		<path id="usdu.classpath">
			<path refid="base.path" />
			<pathelement path="${grouper.home}/build/grouper" />
		</path>
	</target>

	<!-- jvm args -->
	<jvmargset id="base.jvm.args">
		<jvmarg value="-Xmx@USDU_MEM_MAX@" />
		<jvmarg value="-Xms@USDU_MEM_START@" />
	</jvmargset>

	<!-- launch usdu -->
	<target name="usdu" depends="classpath-jar,classpath-classes">
		<launch classname="edu.internet2.middleware.grouper.USDU">
			<jvmargset refid="base.jvm.args" />
			<classpath refid="usdu.classpath" />
		</launch>
	</target>
</project>
